!function(t){var e={};function r(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(i,o,function(e){return t[e]}.bind(null,o));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=301)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(4);Object.defineProperty(e,"Vector4f",{enumerable:!0,get:function(){return i.Vector4f}});var o=r(1);Object.defineProperty(e,"Vector3f",{enumerable:!0,get:function(){return o.Vector3f}});var n=r(31);Object.defineProperty(e,"Matrix3f",{enumerable:!0,get:function(){return n.Matrix3f}});var s=r(19);Object.defineProperty(e,"Matrix4f",{enumerable:!0,get:function(){return s.Matrix4f}});var a=r(26);Object.defineProperty(e,"Vector2f",{enumerable:!0,get:function(){return a.Vector2f}})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vector3f=void 0;class i{constructor(t=0,e=0,r=0){this.x=t,this.y=e,this.z=r}mult(t){return new i(this.x*t,this.y*t,this.z*t)}sub(t){return new i(this.x-t.x,this.y-t.y,this.z-t.z)}sub2(t,e){this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z}mul(t){return new i(this.x*t,this.y*t,this.z*t)}add(t){return new i(this.x+t.x,this.y+t.y,this.z+t.z)}add2(t,e){this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z}cross(t){return new i(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}cross2(t,e){this.x=t.y*e.z-t.z*e.y,this.y=t.z*e.x-t.x*e.z,this.z=t.x*e.y-t.y*e.x}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){const t=1/this.length();return this.mul(t)}normalize2(){const t=1/this.length();this.x*=t,this.y*=t,this.z*=t}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}}e.Vector3f=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Framebuffer=void 0;const i=r(23),o=r(7),n=r(8),s=r(25),a=r(0),l=r(10),c=r(32),h=r(33),u=r(12),f=r(20),d=r(29),p=r(15),m=r(40),x=r(14),M=r(13),w=r(16),b=r(9),g=r(3);let y=(()=>{class t{constructor(e,r){this.cullMode=n.CullFace.BACK,this.triangleRasterizer=new l.FlatShadingTriangleRasterizer(this),this.texturedTriangleRasterizer=new u.TexturedTriangleRasterizer(this),this.scaleClipBlitter=new i.ScaleClipBlitter(this),this.renderingPipeline=new f.FlatShadingRenderingPipeline(this),this.texturedRenderingPipeline=new d.TexturingRenderingPipeline(this),this.lineRasterizer=new c.LineRasterizerDda(this),this.lineRasterizerNo=new h.LineRasterizerNoZ(this),this.tmpGlitch=new Uint32Array(64e3),this.lensFlareVisible=!1,this.lensFlareStart=0,this.lensFlareEnd=0,this.torus=new s.Torus,this.linerClipper=new m.CohenSutherlandLineClipper(this),this.width=e,this.height=r,this.imageData=new ImageData(320,200),this.wBuffer=new Float32Array(64e3);const o=new ArrayBuffer(this.width*this.height*t.PIXEL_SIZE_IN_BYTES);this.unsignedIntArray=new Uint8ClampedArray(o),this.framebuffer=new Uint32Array(o)}setCullFace(t){this.cullMode=t}setTexture(t){this.bob=t}precompute(){}getImageData(){return this.imageData.data.set(this.unsignedIntArray),this.imageData}clear(){const t=o.Color.BLACK.toPackedFormat(),e=this.width*this.height;for(let r=0;r<e;r++)this.framebuffer[r]=t}clearColorBuffer(t){this.framebuffer.fill(t)}drawPixel(t,e,r){this.framebuffer[t+e*this.width]=r}drawPixel4(t,e,r,i){const o=t+e*this.width,n=1-i,s=(this.framebuffer[o]>>0&255)*n+(r>>0&255)*i|0,a=(this.framebuffer[o]>>8&255)*n+(r>>8&255)*i|0,l=(this.framebuffer[o]>>16&255)*n+(r>>16&255)*i|0;this.framebuffer[t+e*this.width]=s|a<<8|l<<16|255<<24}drawPixel3(t,e,r,i){const o=t+e*this.width,n=(r>>24&255)/255*i,s=1-n,a=(this.framebuffer[o]>>0&255)*s+(r>>0&255)*n|0,l=(this.framebuffer[o]>>8&255)*s+(r>>8&255)*n|0,c=(this.framebuffer[o]>>16&255)*s+(r>>16&255)*n|0;this.framebuffer[o]=a|l<<8|c<<16|255<<24}readPixel(t,e){return this.framebuffer[t+e*this.width]}drawRect(t,e,r,i){let o=t+e*this.width;for(let t=0;t<r;t++)this.framebuffer[o++]=i}drawRect2(t,e,r,i,o){let n=t+e*this.width;for(let t=0;t<i;t++){for(let t=0;t<r;t++)this.framebuffer[n++]=o;n+=320-r}}drawText(t,e,r,i){let o=t;const n=" ".charCodeAt(0);for(let t=0;t<r.length;t++){const s=r.charCodeAt(t)-n,a=8*Math.floor(s%32),l=8*Math.floor(s/32);this.drawTextureRectFastAlpha(o,e,a,l,8,8,i),o+=8}}addReflections(){for(let t=0;t<50;t++)for(let e=0;e<320;e++)this.framebuffer[320*(150+t)+e]=this.framebuffer[320*(150-3*t-1)+e+this.interpolate(0,50,t)*(10*Math.sin(.002*Date.now()+.2*t))|0]}drawTextureRect2(t,e,r,i,o,n,s,a){for(let l=0;l<o;l++)for(let o=0;o<n;o++){const n=r+l+(i+o)*s.width,c=t+l+320*(e+o),h=(s.texture[n]>>24&255)/255*a,u=1-h,f=(this.framebuffer[c]>>0&255)*u+(s.texture[n]>>0&255)*h|0,d=(this.framebuffer[c]>>8&255)*u+(s.texture[n]>>8&255)*h|0,p=(this.framebuffer[c]>>16&255)*u+(s.texture[n]>>16&255)*h|0;this.framebuffer[c]=f|d<<8|p<<16|255<<24}}drawTextureRectFastAlpha(t,e,r,i,o,n,s){let a=r+i*s.width,l=t+320*e;for(let t=0;t<n;t++){for(let t=0;t<o;t++){const t=s.texture[a];4278190080&t&&(this.framebuffer[l]=t),a++,l++}a+=s.width-o,l+=320-o}}drawTextureRectNoAlpha(t,e,r,i,o,n,s){let a=r+i*s.width,l=t+320*e;for(let t=0;t<n;t++){for(let t=0;t<o;t++)this.framebuffer[l]=s.texture[a],a++,l++;a+=s.width-o,l+=320-o}}drawTextureRect(t,e,r,i,o,n,s,a){let l=r+i*s.width,c=t+320*e;for(let t=0;t<n;t++){for(let t=0;t<o;t++){const t=(s.texture[l]>>24&255)/255*a,e=1-t,r=this.framebuffer[c],i=s.texture[l],o=(r>>0&255)*e+(i>>0&255)*t,n=(r>>8&255)*e+(i>>8&255)*t,h=(r>>16&255)*e+(i>>16&255)*t;this.framebuffer[c]=o|n<<8|h<<16|255<<24,l++,c++}l+=s.width-o,c+=320-o}}drawTextureRectAdd(t,e,r,i,o,n,s,a){let l=r+i*s.width,c=t+320*e;for(let t=0;t<n;t++){for(let t=0;t<o;t++){const t=(s.texture[l]>>24&255)/255*a,e=this.framebuffer[c],r=s.texture[l],i=Math.min(255,(e>>0&255)+(r>>0&255)*t),o=Math.min(255,(e>>8&255)+(r>>8&255)*t),n=Math.min(255,(e>>16&255)+(r>>16&255)*t);this.framebuffer[c]=i|o<<8|n<<16|255<<24,l++,c++}l+=s.width-o,c+=320-o}}pixelate(){for(let t=0;t<10;t++)for(let e=0;e<10;e++)this.drawBox2(10*t+20,10*e+50,10,10,this.readPixel(10*t+20,10*e+50));this.drawLineDDA(new a.Vector3f(20,50,-.3),new a.Vector3f(120,50,-.3),4294967295),this.drawLineDDA(new a.Vector3f(20,150,-.3),new a.Vector3f(120,150,-.3),4294967295),this.drawLineDDA(new a.Vector3f(20,50,-.3),new a.Vector3f(20,150,-.3),4294967295),this.drawLineDDA(new a.Vector3f(120,50,-.3),new a.Vector3f(120,150,-.3),4294967295)}interpolate(t,e,r){return r<=t?0:r>=e?1:(r-t)/(e-t)}fastFramebufferCopyOffset(t,e,r=0){let i=2001,o=64e3,n=320*(200-r);for(;--i;)t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n],t[--o]=e[--n]}fastFramebufferCopy(t,e){t.set(e)}drawPolarDistotion2(t,e){let r=0;const i=1.355*(.4+.3*(1+Math.sin(17e-5*t)));for(let t=0;t<200;t++)for(let o=0;o<320;o++){const n=o-160,s=t-100,a=Math.sqrt(n*n+s*s)*i,l=Math.atan2(n,s)/(2*Math.PI)*256,c=e.texture[(255&a)+256*(255&l)];this.framebuffer[r++]=c}}drawPolarDistotion3(t,e){let r=0;for(let i=0;i<200;i++)for(let o=0;o<320;o++){const n=o-160,s=i-100,a=.8*Math.sqrt(n*n+s*s)-.017*t,l=Math.atan2(n,s)/(2*Math.PI)*256+.017*t,c=e.texture[(255&a)+256*(255&l)];this.framebuffer[r++]=c}}noise(t,e,r=.07){for(let i=0;i<16;i++)for(let o=0;o<10;o++)this.drawTextureRect(20*i,20*o,Math.round(t/100+i+o)%12*20,0,20,20,e,r)}drawTexturedBillboard(t,e,r,i,o,n){const s=o.width/r,a=o.height/i;let l,c,h,u,f,d=0,p=0;if(e+i<0||e>199||t+r<0||t>319)return;e<0?(p=a*-e,l=i+e-Math.max(e+i-200,0),h=0):(h=e,l=i-Math.max(e+i-200,0)),t<0?(f=d=s*-t,c=r+t-Math.max(t+r-320,0),u=0):(f=0,u=t,c=r-Math.max(t+r-320,0));let m=u+320*h;for(let t=0;t<l;t++){for(let t=0;t<c;t++){if(this.wBuffer[m]>n){this.wBuffer[m]=n;const t=Math.min(0|d,o.width-1)+Math.min(0|p,o.height-1)*o.width,e=(this.framebuffer[m]>>0&255)+(o.texture[t]>>0&255),r=(this.framebuffer[m]>>8&255)+(o.texture[t]>>8&255),i=(this.framebuffer[m]>>16&255)+(o.texture[t]>>16&255);this.framebuffer[m]=e|r<<8|i<<16|255<<24}d+=a,m++}p+=a,d=f,m+=320-c}}drawParticle(t,e,r,i,o,n,s){const a=o.width/r,l=o.height/i;let c,h,u,f,d,p=0,m=0;if(e+i<0||e>199||t+r<0||t>319)return;e<0?(m=l*-e,c=i+e-Math.max(e+i-200,0),u=0):(u=e,c=i-Math.max(e+i-200,0)),t<0?(d=p=a*-t,h=r+t-Math.max(t+r-320,0),f=0):(d=0,f=t,h=r-Math.max(t+r-320,0));const x=1/255*s;let M=f+320*u;for(let t=0;t<c;t++){for(let t=0;t<h;t++){if(this.wBuffer[M]>n){const t=Math.min(0|p,o.width-1)+Math.min(0|m,o.height-1)*o.width,e=(o.texture[t]>>24&255)*x,r=1-e,i=this.framebuffer[M],n=o.texture[t],s=(i>>0&255)*r+(n>>0&255)*e,a=(i>>8&255)*r+(n>>8&255)*e,l=(i>>16&255)*r+(n>>16&255)*e;this.framebuffer[M]=s|a<<8|l<<16|255<<24}p+=a,M++}m+=l,p=d,M+=320-h}}drawParticle2(t,e,r,i,o,n,s,a=0,l){const c=o.width/r,h=l/i;let u,f,d,p,m,x=0,M=0;if(e+i<0||e>199||t+r<0||t>319)return;e<0?(M=h*-e,u=i+e-Math.max(e+i-200,0),d=0):(d=e,u=i-Math.max(e+i-200,0)),t<0?(m=x=c*-t,f=r+t-Math.max(t+r-320,0),p=0):(m=0,p=t,f=r-Math.max(t+r-320,0));const w=1/255*s;let b=p+320*d;for(let t=0;t<u;t++){for(let t=0;t<f;t++){if(this.wBuffer[b]>n){const t=Math.min(0|x,o.width-1)+Math.min(0|M,l-1)*o.width+l*o.width*a,e=(o.texture[t]>>24&255)*w,r=1-e,i=this.framebuffer[b],n=o.texture[t],s=(i>>0&255)*r+(n>>0&255)*e,c=(i>>8&255)*r+(n>>8&255)*e,h=(i>>16&255)*r+(n>>16&255)*e;this.framebuffer[b]=s|c<<8|h<<16|255<<24}x+=c,b++}M+=h,x=m,b+=320-f}}drawParticle2Sub(t,e,r,i,o,n,s,a=0,l){const c=o.width/r,h=l/i;let u,f,d,p,m,x=0,M=0;if(e+i<0||e>199||t+r<0||t>319)return;e<0?(M=h*-e,u=i+e-Math.max(e+i-199,0),d=0):(d=e,u=i-Math.max(e+i-199,0)),t<0?(m=x=c*-t,f=Math.ceil(r+t-Math.max(t+r-319,0)),p=0):(m=0,p=t,f=Math.ceil(r-Math.max(t+r-319,0))),m+=(Math.ceil(t)-t)*c,M+=(Math.ceil(e)-e)*h;const w=1/255*s;let b=Math.ceil(p)+320*Math.ceil(d);for(let t=0;t<u;t++){for(let t=0;t<f;t++){if(this.wBuffer[b]>n){const t=Math.min(0|Math.round(x),o.width-1)+Math.min(0|Math.round(M),l-1)*o.width+l*o.width*a,e=(o.texture[t]>>24&255)*w,r=1-e,i=this.framebuffer[b],n=o.texture[t],s=(i>>0&255)*r+(n>>0&255)*e,c=(i>>8&255)*r+(n>>8&255)*e,h=(i>>16&255)*r+(n>>16&255)*e;this.framebuffer[b]=s|c<<8|h<<16|255<<24}x+=c,b++}M+=h,x=m,b+=320-f}}drawParticleNoDepth(t,e,r,i,o,n){const s=o.width/r,a=o.height/i;let l,c,h,u,f,d=0,p=0;if(e+i<0||e>199||t+r<0||t>319)return;e<0?(p=a*-e,l=i+e-Math.max(e+i-200,0),h=0):(h=e,l=i-Math.max(e+i-200,0)),t<0?(f=d=s*-t,c=r+t-Math.max(t+r-320,0),u=0):(f=0,u=t,c=r-Math.max(t+r-320,0));const m=1/255*n;let x=u+320*h;for(let t=0;t<l;t++){for(let t=0;t<c;t++){const t=Math.min(0|d,o.width-1)+Math.min(0|p,o.height-1)*o.width,e=(o.texture[t]>>24&255)*m,r=1-e,i=this.framebuffer[x],n=o.texture[t],a=(i>>0&255)*r+(n>>0&255)*e,l=(i>>8&255)*r+(n>>8&255)*e,c=(i>>16&255)*r+(n>>16&255)*e;this.framebuffer[x]=a|l<<8|c<<16|255<<24,d+=s,x++}p+=a,d=f,x+=320-c}}drawSoftParticle(t,e,r,i,o,n,s){const a=o.width/r,l=o.height/i;let c,h,u,f,d,p=0,m=0;if(e+i<0||e>199||t+r<0||t>319)return;e<0?(m=l*-e,c=i+e-Math.max(e+i-200,0),u=0):(u=e,c=i-Math.max(e+i-200,0)),t<0?(d=p=a*-t,h=r+t-Math.max(t+r-320,0),f=0):(d=0,f=t,h=r-Math.max(t+r-320,0));const x=1/255*s;let M=f+320*u;for(let t=0;t<c;t++){for(let t=0;t<h;t++){if(this.wBuffer[M]>n){const t=Math.min(Math.max(1/n-1/this.wBuffer[M],0),1),e=Math.min(0|p,o.width-1)+Math.min(0|m,o.height-1)*o.width,r=(o.texture[e]>>24&255)*x*t,i=1-r,s=(this.framebuffer[M]>>0&255)*i+(o.texture[e]>>0&255)*r,a=(this.framebuffer[M]>>8&255)*i+(o.texture[e]>>8&255)*r,l=(this.framebuffer[M]>>16&255)*i+(o.texture[e]>>16&255)*r;this.framebuffer[M]=s|a<<8|l<<16|255<<24}p+=a,M++}m+=l,p=d,M+=320-h}}drawFog(t,e,r){const i=-e;for(let e=0;e<64e3;e++){const o=Math.max(Math.min(i*(1/this.wBuffer[e]+r),1),0),n=1-o,s=(this.framebuffer[e]>>0&255)*n+t.r*o,a=(this.framebuffer[e]>>8&255)*n+t.g*o,l=(this.framebuffer[e]>>16&255)*n+t.b*o;this.framebuffer[e]=s|a<<8|l<<16|255<<24}}drawRadialBlur(){this.fastFramebufferCopy(this.tmpGlitch,this.framebuffer);const t=new b.Texture;t.texture=this.tmpGlitch,t.width=320,t.height=200;let e=320,r=200;for(let i=0;i<16;i++)e+=320*.09,r+=18,this.scaleClipBlitter.drawScaledTextureClip(160-e/2,100-r/2,e,r,t,.19*(15-i)/15),this.fastFramebufferCopy(this.tmpGlitch,this.framebuffer)}drawScaledTextureClipBi(t,e,r,i,o,n){const s=o.width/r,a=o.height/i;let l,c,h,u,f,d=0,p=0;if(e+i<0||e>199||t+r<0||t>319)return;e<0?(p=a*-e,l=i+e-Math.max(e+i-200,0),h=0):(h=e,l=i-Math.max(e+i-200,0)),t<0?(f=d=s*-t,c=r+t-Math.max(t+r-320,0),u=0):(f=0,u=t,c=r-Math.max(t+r-320,0));const m=1/255*n;let x=u+320*h;for(let t=0;t<l;t++){for(let t=0;t<c;t++){const t=o.getBilinearFilteredPixel2(d,p),e=255*m,r=1-e,i=this.framebuffer[x],n=(i>>0&255)*r+(t>>0&255)*e,a=(i>>8&255)*r+(t>>8&255)*e,l=(i>>16&255)*r+(t>>16&255)*e;this.framebuffer[x]=n|a<<8|l<<16|255<<24,d+=s,x++}p+=a,d=f,x+=320-c}}drawScaledTextureClipBiAdd(t,e,r,i,o,n){const s=o.width/r,a=o.height/i;let l,c,h,u,f,d=0,p=0;if(e+i<0||e>199||t+r<0||t>319)return;e<0?(p=a*-e,l=i+e-Math.max(e+i-200,0),h=0):(h=e,l=i-Math.max(e+i-200,0)),t<0?(f=d=s*-t,c=r+t-Math.max(t+r-320,0),u=0):(f=0,u=t,c=r-Math.max(t+r-320,0));let m=u+320*h;for(let t=0;t<l;t++){for(let t=0;t<c;t++){const t=o.getBilinearFilteredPixel2(d,p),e=this.framebuffer[m],r=t,i=Math.min((e>>0&255)+(r>>0&255)*n,255),a=Math.min((e>>8&255)+(r>>8&255)*n,255),l=Math.min((e>>16&255)+(r>>16&255)*n,255);this.framebuffer[m]=i|a<<8|l<<16|255<<24,d+=s,m++}p+=a,d=f,m+=320-c}}drawScaledTextureClipAdd(t,e,r,i,o,n=1){const s=o.width/r,a=o.height/i;let l,c,h,u,f,d=0,p=0;if(e+i<0||e>199||t+r<0||t>319)return;e<0?(p=a*-e,l=i+e-Math.max(e+i-200,0),h=0):(h=e,l=i-Math.max(e+i-200,0)),t<0?(f=d=s*-t,c=r+t-Math.max(t+r-320,0),u=0):(f=0,u=t,c=r-Math.max(t+r-320,0));let m=u+320*h;for(let t=0;t<l;t++){for(let t=0;t<c;t++){const t=Math.min(0|d,o.width-1)+Math.min(0|p,o.height-1)*o.width,e=this.framebuffer[m],r=o.texture[t],i=Math.min((e>>0&255)+(r>>0&255)*n,255),a=Math.min((e>>8&255)+(r>>8&255)*n,255),l=Math.min((e>>16&255)+(r>>16&255)*n,255);this.framebuffer[m]=i|a<<8|l<<16|255<<24,d+=s,m++}p+=a,d=f,m+=320-c}}drawTexture(t,e,r,i){let o=Math.max(t,0)+Math.max(e,0)*this.width,n=Math.max(0,0-t)+Math.max(0,0-e)*r.width;const s=Math.min(r.width,320-t)-Math.max(0,0-t),a=Math.min(r.height,200-e)-Math.max(0,0-e),l=r.width-s,c=this.width-s,h=1/255*i;for(let t=0;t<a;t++){for(let t=0;t<s;t++){const t=(r.texture[n]>>24&255)*h,e=1-t,i=(this.framebuffer[o]>>0&255)*e+(r.texture[n]>>0&255)*t,s=(this.framebuffer[o]>>8&255)*e+(r.texture[n]>>8&255)*t,a=(this.framebuffer[o]>>16&255)*e+(r.texture[n]>>16&255)*t;this.framebuffer[o]=i|s<<8|a<<16|255<<24,o++,n++}n+=l,o+=c}}drawTextureFullscreen(t,e){let r=0;const i=1-e;for(let o=0;o<64e3;o++){const o=(this.framebuffer[r]>>0&255)*i+(t.texture[r]>>0&255)*e,n=(this.framebuffer[r]>>8&255)*i+(t.texture[r]>>8&255)*e,s=(this.framebuffer[r]>>16&255)*i+(t.texture[r]>>16&255)*e;this.framebuffer[r]=o|n<<8|s<<16|255<<24,r++}}drawTexture3(t,e,r,i,o){let n=Math.max(t,0)+Math.max(e,0)*this.width,s=Math.max(0,0-t)+Math.max(0,0-e)*r.width;const a=Math.min(r.width,320-t)-Math.max(0,0-t),l=Math.min(r.height,200-e)-Math.max(0,0-e),c=r.width-a,h=this.width-a,u=1/255*i,f=Math.floor(l*Math.max(Math.min(1,o),0));for(let t=0;t<f;t++){for(let t=0;t<a;t++){const t=(r.texture[s]>>24&255)*u,e=1-t,i=(this.framebuffer[n]>>0&255)*e+(r.texture[s]>>0&255)*t,o=(this.framebuffer[n]>>8&255)*e+(r.texture[s]>>8&255)*t,a=(this.framebuffer[n]>>16&255)*e+(r.texture[s]>>16&255)*t;this.framebuffer[n]=i|o<<8|a<<16|255<<24,n++,s++}s+=c,n+=h}}drawTextureNoClipAlpha(t,e,r){let i=t+e*this.width,o=0;const n=this.width-r.width;for(let t=0;t<r.height;t++){for(let t=0;t<r.width;t++){const t=r.texture[o];4278190080&t&&(this.framebuffer[i]=t),i++,o++}i+=n}}scene8(t){const e=[0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,7,1,6,2,5,3,4],r=[new a.Vector3f(1,1,-1),new a.Vector3f(-1,1,-1),new a.Vector3f(-1,1,1),new a.Vector3f(1,1,1),new a.Vector3f(1,-1,1),new a.Vector3f(-1,-1,1),new a.Vector3f(-1,-1,-1),new a.Vector3f(1,-1,-1)];let i=a.Matrix3f.constructScaleMatrix(.8,.8,.8).multiplyMatrix(a.Matrix3f.constructYRotationMatrix(.05*t));i=i.multiplyMatrix(a.Matrix3f.constructXRotationMatrix(.05*t));const o=new Array;r.forEach(e=>{const r=i.multiply(e),n=r.x,s=r.y,l=r.z-4+2*Math.sin(.09*t);o.push(new a.Vector3f(n,s,l))});for(let t=0;t<e.length;t+=2){const r=-16776961;this.nearPlaneClipping(o[e[t]],o[e[t+1]],r)}}project(t){return new a.Vector3f(Math.round(160+292*t.x/-t.z),Math.round(100-292*t.y/-t.z),t.z)}nearPlaneClipping(t,e,r){if(t.z<-1.7&&e.z<-1.7)this.linerClipper.cohenSutherlandLineClipper(this.project(t),this.project(e),r);else{if(t.z>-1.7&&e.z>-1.7)return;if(t.z<-1.7){const i=(-1.7-t.z)/(e.z-t.z),o=new a.Vector3f(i*(e.x-t.x)+t.x,i*(e.y-t.y)+t.y,-1.7);this.linerClipper.cohenSutherlandLineClipper(this.project(t),this.project(o),r)}else if(e.z<-1.7){const i=(-1.7-e.z)/(t.z-e.z),o=new a.Vector3f(i*(t.x-e.x)+e.x,i*(t.y-e.y)+e.y,-1.7);this.linerClipper.cohenSutherlandLineClipper(this.project(e),this.project(o),r)}}}clearDepthBuffer(){this.wBuffer.fill(-1/900)}drawBox(){const e=t.maxWindow.y-t.minWindow.y+1,r=t.maxWindow.x-t.minWindow.x+1;let i=320*t.minWindow.y+t.minWindow.x;for(let t=0;t<e;t++)this.framebuffer.fill(-13158601,i,i+r),i+=320}drawBox2(t,e,r,i,o){let n=320*e+t;for(let t=0;t<i;t++)this.framebuffer.fill(o,n,n+r),n+=320}wireFrameSphereClipping(e){this.wBuffer.fill(100);const r=[];for(let t=0;t<=16;t++)for(let e=0;e<16;e++)r.push(this.sphereFunction2(-t*Math.PI/16-Math.PI/2,2*-e*Math.PI/16));const i=[];for(let t=0;t<16;t++)for(let e=0;e<16;e++)i.push(16*t+(1+e)%16),i.push(16*t+(0+e)%16),i.push(16*t+16+(1+e)%16),i.push(16*t+16+(0+e)%16),i.push(16*t+16+(1+e)%16),i.push(16*t+(0+e)%16);const o=10.8+5*(Math.sin(.16*e)+1)/2;let n=a.Matrix4f.constructScaleMatrix(o,o,o).multiplyMatrix(a.Matrix4f.constructYRotationMatrix(.08*e));n=n.multiplyMatrix(a.Matrix4f.constructXRotationMatrix(.08*e)),n=a.Matrix4f.constructTranslationMatrix(0+20*Math.sin(.04*e),5*Math.sin(.06*e),-22).multiplyMatrix(n);const s=new Array;for(let t=0;t<r.length;t++){const e=n.multiplyHom(r[t]),i=e.x,o=e.y,l=e.z,c=160+i/(.0078*-l),h=100+o/(.0078*-l);s.push(new a.Vector3f(c,h,l))}this.drawLineDDA(new a.Vector3f(t.minWindow.x-1,t.minWindow.y-1,0),new a.Vector3f(t.minWindow.x-1,t.maxWindow.y+1,0),-1179448),this.drawLineDDA(new a.Vector3f(t.maxWindow.x+1,t.minWindow.y-1,0),new a.Vector3f(t.maxWindow.x+1,t.maxWindow.y+1,0),-1179448),this.drawLineDDA(new a.Vector3f(t.minWindow.x-1,t.minWindow.y-1,0),new a.Vector3f(t.maxWindow.x+1,t.minWindow.y-1,0),-1179448),this.drawLineDDA(new a.Vector3f(t.minWindow.x-1,t.maxWindow.y+1,0),new a.Vector3f(t.maxWindow.x+2,t.maxWindow.y+1,0),-1179448),this.drawBox();for(let t=0;t<i.length;t+=3){const e=s[i[t]],r=s[i[t+1]],o=s[i[t+2]],n=-1;this.isTriangleCCW(e,r,o)&&(this.linerClipper.cohenSutherlandLineClipper(e,r,n),this.linerClipper.cohenSutherlandLineClipper(e,o,n),this.linerClipper.cohenSutherlandLineClipper(o,r,n))}}isTriangleCCW(t,e,r){const i=t.x*e.y-e.x*t.y+e.x*r.y-r.x*e.y+r.x*t.y-t.x*r.y;return this.cullMode===n.CullFace.BACK?i<0:i>0}drawBoundingSphere(t,e,r){const i=[];for(let e=0;e<=8;e++)for(let r=0;r<8;r++){const o=this.sphereFunction2(-e*Math.PI/8-Math.PI/2,2*-r*Math.PI/8).mul(t.getRadius()+.01).add(t.getCenter());o.w=1,i.push(o)}const o=[];for(let t=0;t<8;t++)for(let e=0;e<8;e++)o.push(8*t+(1+e)%8),o.push(8*t+(0+e)%8),o.push(8*t+8+(1+e)%8),o.push(8*t+8+(0+e)%8),o.push(8*t+8+(1+e)%8),o.push(8*t+(0+e)%8);const n=e,s=new Array;for(let t=0;t<i.length;t++){const e=n.multiplyHom(i[t]);s.push(new a.Vector3f(e.x,e.y,e.z))}for(let t=0;t<o.length;t+=3){const e=s[o[t]],i=s[o[t+1]],n=s[o[t+2]];this.nearPlaneClipping(e,i,r),this.nearPlaneClipping(e,n,r),this.nearPlaneClipping(n,i,r)}}drawPlanedeformationTunnelAnim(t,e){let r=0;for(let i=0;i<200;i++)for(let o=0;o<320;o++){const n=o-160,s=i-100,a=51.2/Math.max(1,Math.sqrt(n*n+s*s)),l=a+.002*t,c=16*(Math.atan2(n,s)/Math.PI+1)+69e-5*t,h=e.texture[(31&l)+32*(31&c)],u=1-this.cosineInterpolate(1,6,a),f=(h>>0&255)*u|(h>>8&255)*u<<8|(h>>16&255)*u<<16;this.framebuffer[r++]=f}}drawPlanedeformationTunnelV2(t,e){let r=0;for(let i=0;i<200;i++)for(let o=0;o<320;o++){const n=1.2,s=o-160+80*Math.sin(1e-4*t)*n,a=i-100+80*Math.cos(1e-4*t)*n,l=o-160+80*Math.sin(1e-4*t+Math.PI)*n,c=i-100+80*Math.cos(1e-4*t+Math.PI)*n;let h=5120/Math.max(1,Math.sqrt(s*s+a*a));h+=8*Math.sin(5*Math.atan2(s,a));let u=5120/Math.max(1,Math.sqrt(l*l+c*c));u+=8*Math.sin(5*Math.atan2(l,c));const f=h-u+.019*t;let d=128.5*(Math.atan2(s,a)/Math.PI+1)+.0069*t;d-=128.5*(Math.atan2(l,c)/Math.PI+1)+.0069*t;const p=e.texture[(255&f)+255*(255&d)],m=Math.min(60/(2*h),1)*Math.min(60/(2*u),1),x=(255&p)*m,M=(p>>8&255)*m,w=(p>>16&255)*m;this.framebuffer[r++]=x|M<<8|w<<16|255<<24}}drawLedTunnel(t,e){for(let r=0;r<25;r++)for(let i=0;i<40;i++){const o=160/(1.4*Math.sqrt((i-20)*(i-20)+(r-12.5)*(r-12.5))),n=(15*(.5*(Math.sin(o+.005*t)+1)*(1-Math.min(.003*o,1)))|0)%16;this.drawTextureRectNoAlpha(8*i,8*r,0,8*n,8,8,e)}}drawParticleWaves(t,e,r=!1){r||this.clearColorBuffer(-13617080),this.clearDepthBuffer();const i=new Array;for(let e=0;e<50;e++)for(let r=0;r<50;r++){const o=2*(r-25),n=4*(Math.sin(.09*r*2+8e-4*t)+Math.cos(.08*e*2+9e-4*t)),s=2*(e-25);i.push(new a.Vector3f(o,n,s))}const o=a.Matrix4f.constructTranslationMatrix(0,-0,-49).multiplyMatrix(a.Matrix4f.constructXRotationMatrix(.1*Math.PI).multiplyMatrix(a.Matrix4f.constructYRotationMatrix(6e-5*t))),n=new Array(i.length);i.forEach(t=>{const e=this.project(o.multiply(t));n.push(e)}),n.sort((t,e)=>t.z-e.z),n.forEach(t=>{const r=-1.3*192/t.z;this.drawParticle(Math.round(t.x-r/2),Math.round(t.y-r/2),Math.round(r),Math.round(r),e,1/t.z,this.interpolate(-60,-25,t.z))})}drawScreenBounds(t){const e=o.Color.WHITE.toPackedFormat();t.drawLineDDANoZ(new a.Vector3f(80,50,0),new a.Vector3f(240,50,-100),e),t.drawLineDDANoZ(new a.Vector3f(80,50,0),new a.Vector3f(80,150,-100),e),t.drawLineDDANoZ(new a.Vector3f(240,50,0),new a.Vector3f(240,150,-100),e),t.drawLineDDANoZ(new a.Vector3f(80,150,0),new a.Vector3f(240,150,-100),e)}drawBlenderScene5(t,e,r){this.clearDepthBuffer();const i=a.Matrix4f.constructTranslationMatrix(0,0,9*(.5*Math.sin(6e-4*t)+.5)-54).multiplyMatrix(a.Matrix4f.constructXRotationMatrix(.8*(.5*Math.sin(14e-5*t)+.5)-.1).multiplyMatrix(a.Matrix4f.constructYRotationMatrix(2e-4*-t).multiplyMatrix(a.Matrix4f.constructTranslationMatrix(0,-13,0))));let o=i.multiplyMatrix(a.Matrix4f.constructScaleMatrix(9,9,9));for(let t=0;t<this.blenderObj4.length;t++){const e=this.blenderObj4[t];0!==t&&2!==t&&this.renderingPipeline.draw(e,o),0===t&&this.renderingPipeline.draw(e,o),2===t&&this.renderingPipeline.draw(e,o)}o=i.multiplyMatrix(a.Matrix4f.constructTranslationMatrix(0,14.2,-4).multiplyMatrix(a.Matrix4f.constructScaleMatrix(7,7,9).multiplyMatrix(a.Matrix4f.constructXRotationMatrix(2*Math.PI*this.cosineInterpolate(0,1300,Math.floor(.7*t)%4e3)))));const n=this.blenderObj5[0];this.renderingPipeline.draw(n,o);o=i.multiplyMatrix(a.Matrix4f.constructTranslationMatrix(0,19,0).multiplyMatrix(a.Matrix4f.constructScaleMatrix(8,8,8)));const s=this.project(i.multiply(new a.Vector3f(20,19,-90)));this.drawLensFlare(s,.15*t,e,r)}drawPlaneDeformation(t,e){const r=e.width,i=e.height;let o=0;for(let n=0;n<200;n++){const s=2*n/200-1;for(let n=0;n<320;n++){const a=(2*n/320-1)/Math.abs(s)*r*.05|0,l=1/Math.abs(s)*i*.05+.008*t|0,c=1-Math.max(Math.min(1/Math.abs(s)*.2,1),0);let h=e.texture[(255&a)+(255&l)*r];h=255<<24|(h>>16&255)*c<<16|(h>>8&255)*c<<8|(h>>0&255)*c<<0,this.framebuffer[o++]=h}}}shadingSphereClip(t){this.clearDepthBuffer();let e=a.Matrix4f.constructYRotationMatrix(.1*t).multiplyMatrix(a.Matrix4f.constructScaleMatrix(1.6,1.6,1.6));e=a.Matrix4f.constructZRotationMatrix(.02*-t).multiplyMatrix(a.Matrix4f.constructTranslationMatrix(0,0,-21).multiplyMatrix(e)),this.renderingPipeline.draw(this.torus.getMesh(),e)}torusFunction(t){return new a.Vector3f(10*Math.sin(t),0,10*Math.cos(t))}cosineInterpolate(t,e,r){let i;return r<=t?0:r>=e?1:(i=(r-t)/(e-t),(1-Math.cos(i*Math.PI))/2)}createPlane(){const t={points:[]};for(let e=0;e<60;e++)for(let r=0;r<100;r++)t.points.push(new a.Vector3f(0+r,0+e,0)),t.points.push(new a.Vector3f(0+r,1+e,0)),t.points.push(new a.Vector3f(1+r,0+e,0)),t.points.push(new a.Vector3f(1+r,0+e,0)),t.points.push(new a.Vector3f(0+r,1+e,0)),t.points.push(new a.Vector3f(1+r,1+e,0));const e=[],r=[],i=[],o=[],n=[];return t.points.forEach(t=>{const r=t,i=e.find(t=>t.sub(r).length()<.001);if(i){const t=e.indexOf(i);n.push(t)}else n.push(e.push(r)-1)}),e.forEach(()=>{i.push(new a.Vector3f(0,0,0)),o.push(new a.Vector3f(0,0,0)),r.push(new a.Vector3f(0,0,0))}),{points:e,points2:r,normals:i,normals2:o,index:n}}createCylinder(){const t={points:[]};for(let e=0;e<110;e++)for(let r=0;r<50;r++){const i=30*Math.sin(2*Math.PI/50*r),o=30*Math.sin(2*Math.PI/50*(r+1)),n=30*Math.cos(2*Math.PI/50*r),s=30*Math.cos(2*Math.PI/50*(r+1));t.points.push(new a.Vector3f(i,0+e,n)),t.points.push(new a.Vector3f(i,1+e,n)),t.points.push(new a.Vector3f(o,0+e,s)),t.points.push(new a.Vector3f(o,0+e,s)),t.points.push(new a.Vector3f(i,1+e,n)),t.points.push(new a.Vector3f(o,1+e,s))}const e=[],r=[],i=[],o=[],n=[],s=[];return t.points.forEach(t=>{const r=t,i=e.find(t=>t.sub(r).length()<.001);if(i){const t=e.indexOf(i);s.push(t)}else s.push(e.push(r)-1)}),e.forEach(()=>{i.push(new a.Vector3f(0,0,0)),o.push(new a.Vector3f(0,0,0)),r.push(new a.Vector3f(0,0,0)),n.push(new g.TextureCoordinate)}),{points:e,points2:r,normals:i,normals2:o,index:s,texture:n}}createCylinder2(t){const e={points:[]};for(let r=0;r<110;r++)for(let i=0;i<50;i++){const o=i/50*256&255,n=(i+1)/50*256&255,s=.9*r/110*256&255,l=.9*(r+1)/110*256&255,c=1+(255&t.texture[o+256*s])/255*.9,h=1+(255&t.texture[n+256*s])/255*.9,u=1+(255&t.texture[o+256*l])/255*.9,f=1+(255&t.texture[n+256*l])/255*.9,d=30*Math.sin(2*Math.PI/50*i),p=30*Math.cos(2*Math.PI/50*i),m=30*Math.sin(2*Math.PI/50*(i+1)),x=30*Math.cos(2*Math.PI/50*(i+1));e.points.push(new a.Vector3f(d*c,0+r,p*c)),e.points.push(new a.Vector3f(d*u,1+r,p*u)),e.points.push(new a.Vector3f(m*h,0+r,x*h)),e.points.push(new a.Vector3f(m*h,0+r,x*h)),e.points.push(new a.Vector3f(d*u,1+r,p*u)),e.points.push(new a.Vector3f(m*f,1+r,x*f))}const r=[],i=[],o=[],n=[],s=[];return e.points.forEach(t=>{const e=t,i=r.find(t=>t.sub(e).length()<.001);if(i){const t=r.indexOf(i);s.push(t)}else s.push(r.push(e)-1)}),r.forEach(()=>{o.push(new a.Vector3f(0,0,0)),n.push(new a.Vector3f(0,0,0)),i.push(new a.Vector3f(0,0,0))}),{points:r,points2:i,normals:o,normals2:n,index:s}}fakeSphere(t,e){e.textureCoordinate.u=.5+Math.asin(t.x)/Math.PI,e.textureCoordinate.v=.5-Math.asin(t.y)/Math.PI}fakeSphere2(t,e){e.u=.5+Math.asin(t.x)/Math.PI,e.v=.5-Math.asin(t.y)/Math.PI}drawLensFlare(t,e,r,i){const o=t;o.z<0&&o.x>0&&o.x<320&&o.y>0&&o.y<200&&this.wBuffer[o.x+320*o.y]>1/o.z?this.lensFlareVisible||(this.lensFlareVisible=!0,this.lensFlareStart=e):this.lensFlareVisible&&(this.lensFlareVisible=!1,this.lensFlareEnd=e);let n=this.interpolate(this.lensFlareStart,this.lensFlareStart+100,e);!0!==this.lensFlareVisible&&(n*=1-this.interpolate(this.lensFlareEnd,this.lensFlareEnd+100,e));const s=new a.Vector3f(160,100,0).sub(o);if(n>0)for(let t=0;t<r.length;t++){const e=o.add(s.mul(r[t].scale));this.drawTexture(Math.round(e.x)-r[t].tex.width/2,Math.round(e.y)-r[t].tex.height/2,r[t].tex,r[t].alpha*n)}this.drawTextureRectAdd(0,0,0,0,320,200,i,.03+.15*n)}drawLineDDA(t,e,r){this.lineRasterizer.drawLineDDA(t,e,r)}drawLineDDANoZ(t,e,r){this.lineRasterizerNo.drawLineDDANoZ(t,e,r)}sphereFunction2(t,e){return new a.Vector4f(Math.cos(t)*Math.cos(e),Math.cos(t)*Math.sin(e),Math.sin(t),1)}}return t.PIXEL_SIZE_IN_BYTES=4,t.minWindow=new a.Vector2f(0,0),t.maxWindow=new a.Vector2f(319,199),t.clipRegion=new Array(new M.RightClipEdge,new x.LeftClipEdge,new p.BottomClipEdge,new w.TopClipEdge),t})();e.Framebuffer=y},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextureCoordinate=void 0;e.TextureCoordinate=class{constructor(t,e){this.u=t,this.v=e}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vector4f=void 0;class i{constructor(t,e,r,i=1){this.x=t,this.y=e,this.z=r,this.w=i}sub(t){return new i(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)}add(t){return new i(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)}cross(t){return new i(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x,0)}normalize(){const t=1/this.length();return this.mul(t)}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}mul(t){return new i(this.x*t,this.y*t,this.z*t,this.w)}componentWiseMul(t){return new i(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}}e.Vector4f=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vertex=void 0;e.Vertex=class{}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractClipEdge=void 0;e.AbstractClipEdge=class{}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Color=void 0;let i=(()=>{class t{constructor(t=0,e=0,r=0,i=255){this.r=t,this.g=e,this.b=r,this.a=i}toPackedFormat(){return this.r|this.g<<8|this.b<<16|this.a<<24}sub(e){return new t(this.r-e.r,this.g-e.g,this.b-e.b,255)}add(e){return new t(this.r+e.r,this.g+e.g,this.b+e.b,255)}div(e){return new t(this.r/e,this.g/e,this.b/e,255)}mul(e){return new t(this.r*e,this.g*e,this.b*e,255)}}return t.BLACK=new t(0,0,0,255),t.WHITE=new t(255,255,255,255),t.RED=new t(255,0,0,255),t.GREEN=new t(0,255,0,255),t.LIME=new t(0,255,0,255),t.BLUE=new t(0,0,255,255),t.DARK_BLUE=new t(0,0,64,255),t.YELLOW=new t(255,255,0,255),t.CYAN=new t(0,255,255,255),t.MAGENTA=new t(255,0,255,255),t.SLATE_GRAY=new t(112,128,144,255),t.DARK_GRAY=new t(19,19,20,255),t})();e.Color=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CullFace=void 0,function(t){t[t.FRONT=0]="FRONT",t[t.BACK=1]="BACK"}(e.CullFace||(e.CullFace={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Texture=void 0;e.Texture=class{constructor(t,e,r){this.texture=t,this.width=e,this.height=r}getPixel(t,e,r){return t.texture[(255&e)+256*(255&r)]}getBilinearFilteredPixel(t,e){const r=((0|t)%256+256)%256,i=((t+1|0)%256+256)%256,o=((0|e)%256+256)%256,n=((e+1|0)%256+256)%256,s=255&this.getPixel(this,r,o),a=255&this.getPixel(this,i,o),l=255&this.getPixel(this,r,n),c=255&this.getPixel(this,i,n),h=s*(1-(t-Math.floor(t)))+a*(t-Math.floor(t)),u=l*(1-(t-Math.floor(t)))+c*(t-Math.floor(t));return h*(1-(e-Math.floor(e)))+u*(e-Math.floor(e))}getBilinearFilteredPixel2(t,e){const r=Math.min(0|t,this.width-1),i=Math.min(1+(0|t),this.width-1),o=Math.min(0|e,this.height-1),n=Math.min(1+(0|e),this.height-1),s=this.getPixel2(this,r,o),a=this.getPixel2(this,i,o),l=this.getPixel2(this,r,n),c=this.getPixel2(this,i,n);return this.interpolateComp(t,e,255&s,255&a,255&l,255&c)|this.interpolateComp(t,e,s>>8&255,a>>8&255,l>>8&255,c>>8&255)<<8|this.interpolateComp(t,e,s>>16&255,a>>16&255,l>>16&255,c>>16&255)<<16}getPixel2(t,e,r){return this.texture[e+r*this.width]}getPixel3(t,e,r){return this.texture[(e%this.width+this.width)%this.width+(r%this.height+this.height)%this.height*this.width]}interpolateComp(t,e,r,i,o,n){const s=r*(1-(t-Math.floor(t)))+i*(t-Math.floor(t)),a=o*(1-(t-Math.floor(t)))+n*(t-Math.floor(t));return s*(1-(e-Math.floor(e)))+a*(e-Math.floor(e))}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FlatShadingTriangleRasterizer=void 0;const i=r(11);class o extends i.AbstractTriangleRasterizer{constructor(t){super(),this.framebuffer=t,this.temp=null}drawTriangleDDA(t,e,r){if(t.projection.y>r.projection.y&&(this.temp=t,t=r,r=this.temp),t.projection.y>e.projection.y&&(this.temp=t,t=e,e=this.temp),e.projection.y>r.projection.y&&(this.temp=e,e=r,r=this.temp),t.projection.y!==r.projection.y)if(e.projection.y===r.projection.y)e.projection.x>r.projection.x&&(this.temp=e,e=r,r=this.temp),this.fillBottomFlatTriangle(t,e,r);else if(t.projection.y===e.projection.y)t.projection.x>e.projection.x&&(this.temp=t,t=e,e=this.temp),this.fillTopFlatTriangle(t,e,r);else{(r.projection.x-t.projection.x)*(e.projection.y-t.projection.y)/(r.projection.y-t.projection.y)+t.projection.x>e.projection.x?this.fillLongRightTriangle(t,e,r):this.fillLongLeftTriangle(t,e,r)}}fillBottomFlatTriangle(t,e,r){const i=t.color.toPackedFormat(),o=r.projection.y-t.projection.y,n=(e.projection.x-t.projection.x)/o,s=(r.projection.x-t.projection.x)/o,a=(1/e.projection.z-1/t.projection.z)/o,l=(1/r.projection.z-1/t.projection.z)/o;let c=1/t.projection.z,h=1/t.projection.z,u=t.projection.x,f=t.projection.x,d=t.projection.y;for(let t=0;t<o;t++){const t=Math.round(f)-Math.round(u);let e=320*Math.round(d)+Math.round(u);const r=(h-c)/t;let o=c;for(let n=0;n<t;n++)o<this.framebuffer.wBuffer[e]&&(this.framebuffer.wBuffer[e]=o,this.framebuffer.framebuffer[e]=i),e++,o+=r;u+=n,f+=s,d++,c+=a,h+=l}}fillTopFlatTriangle(t,e,r){const i=t.color.toPackedFormat(),o=r.projection.y-t.projection.y,n=(r.projection.x-t.projection.x)/o,s=(r.projection.x-e.projection.x)/o,a=(1/r.projection.z-1/t.projection.z)/o,l=(1/r.projection.z-1/e.projection.z)/o;let c=1/t.projection.z,h=1/e.projection.z,u=t.projection.x,f=e.projection.x,d=t.projection.y;for(let t=0;t<o;t++){const t=Math.round(f)-Math.round(u);let e=320*Math.round(d)+Math.round(u);for(let r=0;r<t;r++){const o=(h-c)/t*r+c;o<this.framebuffer.wBuffer[e]&&(this.framebuffer.wBuffer[e]=o,this.framebuffer.framebuffer[e]=i),e++}u+=n,f+=s,d++,c+=a,h+=l}}fillLongRightTriangle(t,e,r){const i=t.color.toPackedFormat();let o=e.projection.y-t.projection.y;const n=r.projection.y-t.projection.y;let s=(e.projection.x-t.projection.x)/o;const a=(r.projection.x-t.projection.x)/n;let l=(1/e.projection.z-1/t.projection.z)/o;const c=(1/r.projection.z-1/t.projection.z)/n;let h=1/t.projection.z,u=1/t.projection.z,f=t.projection.x,d=t.projection.x,p=t.projection.y;for(let t=0;t<o;t++){const t=Math.round(d)-Math.round(f);let e=320*Math.round(p)+Math.round(f);const r=(u-h)/t;let o=h;for(let n=0;n<t;n++)o<this.framebuffer.wBuffer[e]&&(this.framebuffer.wBuffer[e]=o,this.framebuffer.framebuffer[e]=i),e++,o+=r;f+=s,d+=a,p++,h+=l,u+=c}o=r.projection.y-e.projection.y,s=(r.projection.x-e.projection.x)/o,l=(1/r.projection.z-1/e.projection.z)/o,f=e.projection.x,p=e.projection.y;for(let t=0;t<o;t++){const t=Math.round(d)-Math.round(f);let e=320*Math.round(p)+Math.round(f);const r=(u-h)/t;let o=h;for(let n=0;n<t;n++)o<this.framebuffer.wBuffer[e]&&(this.framebuffer.wBuffer[e]=o,this.framebuffer.framebuffer[e]=i),e++,o+=r;f+=s,d+=a,p++,h+=l,u+=c}}fillLongLeftTriangle(t,e,r){const i=t.color.toPackedFormat();let o=e.projection.y-t.projection.y;const n=r.projection.y-t.projection.y;let s=(e.projection.x-t.projection.x)/o;const a=(r.projection.x-t.projection.x)/n;let l=(1/e.projection.z-1/t.projection.z)/o;const c=(1/r.projection.z-1/t.projection.z)/n;let h=1/t.projection.z,u=1/t.projection.z,f=t.projection.x,d=t.projection.x,p=t.projection.y;for(let t=0;t<o;t++){const t=Math.round(d)-Math.round(f);let e=320*Math.round(p)+Math.round(f);const r=(u-h)/t;let o=h;for(let n=0;n<t;n++)o<this.framebuffer.wBuffer[e]&&(this.framebuffer.wBuffer[e]=o,this.framebuffer.framebuffer[e]=i),e++,o+=r;f+=a,d+=s,p++,h+=c,u+=l}o=r.projection.y-e.projection.y,s=(r.projection.x-e.projection.x)/o,l=(1/r.projection.z-1/e.projection.z)/o,u=1/e.projection.z,d=e.projection.x,p=e.projection.y;for(let t=0;t<o;t++){const t=Math.round(d)-Math.round(f);let e=320*Math.round(p)+Math.round(f);const r=(u-h)/t;let o=h;for(let n=0;n<t;n++)o<this.framebuffer.wBuffer[e]&&(this.framebuffer.wBuffer[e]=o,this.framebuffer.framebuffer[e]=i),e++,o+=r;f+=a,d+=s,p++,h+=c,u+=l}}}e.FlatShadingTriangleRasterizer=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractTriangleRasterizer=void 0;e.AbstractTriangleRasterizer=class{}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TexturedTriangleRasterizer=void 0;const i=r(1);e.TexturedTriangleRasterizer=class{constructor(t){this.framebuffer=t,this.temp=null}drawTriangleDDA(t,e,r){if(t.position.y>r.position.y&&(this.temp=t,t=r,r=this.temp),t.position.y>e.position.y&&(this.temp=t,t=e,e=this.temp),e.position.y>r.position.y&&(this.temp=e,e=r,r=this.temp),t.position.y!==r.position.y){if((r.position.x-t.position.x)*(e.position.y-t.position.y)/(r.position.y-t.position.y)+t.position.x>e.position.x)this.fillLongRightTriangle2(t,e,r);else{const o=t.textureCoordinate,n=e.textureCoordinate,s=r.textureCoordinate;this.fillLongLeftTriangle2(t.position,e.position,r.position,new i.Vector3f(o.u,o.v,0),new i.Vector3f(n.u,n.v,0),new i.Vector3f(s.u,s.v,0))}}}fillLongRightTriangle2(t,e,r){let i=e.position.y-t.position.y;const o=r.position.y-t.position.y;let n=(e.position.x-t.position.x)/i;const s=(r.position.x-t.position.x)/o;let a=(e.textureCoordinate.u/e.position.z-t.textureCoordinate.u/t.position.z)/i;const l=(r.textureCoordinate.u/r.position.z-t.textureCoordinate.u/t.position.z)/o;let c=(e.textureCoordinate.v/e.position.z-t.textureCoordinate.v/t.position.z)/i;const h=(r.textureCoordinate.v/r.position.z-t.textureCoordinate.v/t.position.z)/o;let u=(1/e.position.z-1/t.position.z)/i;const f=(1/r.position.z-1/t.position.z)/o;let d=1/t.position.z,p=1/t.position.z,m=t.textureCoordinate.u/t.position.z,x=t.textureCoordinate.v/t.position.z,M=t.textureCoordinate.u/t.position.z,w=t.textureCoordinate.v/t.position.z,b=t.position.x,g=t.position.x,y=t.position.y;for(let t=0;t<i;t++){const t=Math.round(g)-Math.round(b);let e=320*Math.round(y)+Math.round(b);const r=(p-d)/t,i=(M-m)/t,o=(w-x)/t;let T=d,v=m,P=x;for(let n=0;n<t;n++){if(T<this.framebuffer.wBuffer[e]){this.framebuffer.wBuffer[e]=T;const t=1/T,r=0|Math.max(Math.min(v*t*this.framebuffer.bob.width,this.framebuffer.bob.width-1),0),i=0|Math.max(Math.min(P*t*this.framebuffer.bob.height,this.framebuffer.bob.height-1),0),o=this.framebuffer.bob.texture[r+i*this.framebuffer.bob.width];this.framebuffer.framebuffer[e]=o}e++,T+=r,v+=i,P+=o}b+=n,g+=s,y++,d+=u,p+=f,m+=a,M+=l,x+=c,w+=h}if(i=r.position.y-e.position.y,0!==i){n=(r.position.x-e.position.x)/i,u=(1/r.position.z-1/e.position.z)/i,a=(r.textureCoordinate.u/r.position.z-e.textureCoordinate.u/e.position.z)/i,c=(r.textureCoordinate.v/r.position.z-e.textureCoordinate.v/e.position.z)/i,d=1/e.position.z,m=e.textureCoordinate.u/e.position.z,x=e.textureCoordinate.v/e.position.z,b=e.position.x,y=e.position.y;for(let t=0;t<i;t++){const t=Math.round(g)-Math.round(b);let e=320*Math.round(y)+Math.round(b);const r=(p-d)/t,i=(M-m)/t,o=(w-x)/t;let T=d,v=m,P=x;for(let n=0;n<t;n++){if(T<this.framebuffer.wBuffer[e]){this.framebuffer.wBuffer[e]=T;const t=1/T,r=0|Math.max(Math.min(v*t*this.framebuffer.bob.width,this.framebuffer.bob.width-1),0),i=0|Math.max(Math.min(P*t*this.framebuffer.bob.height,this.framebuffer.bob.height-1),0),o=this.framebuffer.bob.texture[r+i*this.framebuffer.bob.width];this.framebuffer.framebuffer[e]=o}e++,T+=r,v+=i,P+=o}b+=n,g+=s,y++,d+=u,p+=f,m+=a,M+=l,x+=c,w+=h}}}fillLongLeftTriangle2(t,e,r,i,o,n){let s=e.y-t.y;const a=r.y-t.y;let l=(e.x-t.x)/s;const c=(r.x-t.x)/a,h=(n.x/r.z-i.x/t.z)/a;let u=(o.x/e.z-i.x/t.z)/s;const f=(n.y/r.z-i.y/t.z)/a;let d=(o.y/e.z-i.y/t.z)/s,p=(1/e.z-1/t.z)/s;const m=(1/r.z-1/t.z)/a;let x=t.x,M=t.x,w=1/t.z,b=1/t.z,g=i.x/t.z,y=i.y/t.z,T=i.x/t.z,v=i.y/t.z,P=t.x,S=t.x,C=t.y;for(let t=0;t<s;t++){const t=Math.round(S)-Math.round(P);let e=320*Math.round(C)+Math.round(P);const r=(b-w)/t,i=(T-g)/t,o=(v-y)/t;let n=w,s=g,a=y;for(let l=0;l<t;l++){if(n<this.framebuffer.wBuffer[e]){this.framebuffer.wBuffer[e]=n;const t=1/n,r=0|Math.max(Math.min(s*t*this.framebuffer.bob.width,this.framebuffer.bob.width-1),0),i=0|Math.max(Math.min(a*t*this.framebuffer.bob.height,this.framebuffer.bob.height-1),0),o=this.framebuffer.bob.texture[r+i*this.framebuffer.bob.width];this.framebuffer.framebuffer[e]=o}e++,n+=r,s+=i,a+=o}P+=c,S+=l,C++,x+=c,M+=l,w+=m,b+=p,g+=h,T+=u,y+=f,v+=d}s=r.y-e.y,l=(r.x-e.x)/s,p=(1/r.z-1/e.z)/s,u=(n.x/r.z-o.x/e.z)/s,d=(n.y/r.z-o.y/e.z)/s,M=e.x,b=1/e.z,T=o.x/e.z,v=o.y/e.z,S=e.x,C=e.y;for(let t=0;t<s;t++){const t=Math.round(S)-Math.round(P);let e=320*Math.round(C)+Math.round(P);const r=(b-w)/t,i=(T-g)/t,o=(v-y)/t;let n=w,s=g,a=y;for(let l=0;l<t;l++){if(n<this.framebuffer.wBuffer[e]){this.framebuffer.wBuffer[e]=n;const t=1/n,r=0|Math.max(Math.min(s*t*this.framebuffer.bob.width,this.framebuffer.bob.width-1),0),i=0|Math.max(Math.min(a*t*this.framebuffer.bob.height,this.framebuffer.bob.height-1),0),o=this.framebuffer.bob.texture[r+i*this.framebuffer.bob.width];this.framebuffer.framebuffer[e]=o}e++,n+=r,s+=i,a+=o}P+=c,S+=l,C++,x+=c,M+=l,w+=m,b+=p,g+=h,T+=u,y+=f,v+=d}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RightClipEdge=void 0;const i=r(2),o=r(3),n=r(5),s=r(6),a=r(4);class l extends s.AbstractClipEdge{isInside(t){return t.projection.x<320}isInside2(t){return t.position.x<320}computeIntersection(t,e){const r=new n.Vertex,o=(i.Framebuffer.maxWindow.x+1-t.projection.x)/(e.projection.x-t.projection.x);return r.color=e.color.sub(t.color).mul(o).add(t.color),r.projection=new a.Vector4f(i.Framebuffer.maxWindow.x+1,Math.round(t.projection.y+(e.projection.y-t.projection.y)*o),1/(1/t.projection.z+(1/e.projection.z-1/t.projection.z)*o)),r}computeIntersection2(t,e){const r=new n.Vertex;r.position=new a.Vector4f(i.Framebuffer.maxWindow.x+1,Math.round(t.position.y+(e.position.y-t.position.y)*(i.Framebuffer.maxWindow.x+1-t.position.x)/(e.position.x-t.position.x)),1/(1/t.position.z+(1/e.position.z-1/t.position.z)*(i.Framebuffer.maxWindow.x+1-t.position.x)/(e.position.x-t.position.x)));const s=new o.TextureCoordinate,l=r.position.z;return s.u=(t.textureCoordinate.u/t.position.z+(e.textureCoordinate.u/e.position.z-t.textureCoordinate.u/t.position.z)*(i.Framebuffer.maxWindow.x+1-t.position.x)/(e.position.x-t.position.x))*l,s.v=(t.textureCoordinate.v/t.position.z+(e.textureCoordinate.v/e.position.z-t.textureCoordinate.v/t.position.z)*(i.Framebuffer.maxWindow.x+1-t.position.x)/(e.position.x-t.position.x))*l,r.textureCoordinate=s,r}}e.RightClipEdge=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LeftClipEdge=void 0;const i=r(6),o=r(3),n=r(5),s=r(2),a=r(4);class l extends i.AbstractClipEdge{isInside(t){return t.projection.x>=0}isInside2(t){return t.position.x>=0}computeIntersection(t,e){const r=new n.Vertex,i=(s.Framebuffer.minWindow.x-t.projection.x)/(e.projection.x-t.projection.x);return r.color=e.color.sub(t.color).mul(i).add(t.color),r.projection=new a.Vector4f(s.Framebuffer.minWindow.x,Math.round(t.projection.y+(e.projection.y-t.projection.y)*i),1/(1/t.projection.z+(1/e.projection.z-1/t.projection.z)*i)),r}computeIntersection2(t,e){const r=new n.Vertex;r.position=new a.Vector4f(s.Framebuffer.minWindow.x,Math.round(t.position.y+(e.position.y-t.position.y)*(s.Framebuffer.minWindow.x-t.position.x)/(e.position.x-t.position.x)),1/(1/t.position.z+(1/e.position.z-1/t.position.z)*(s.Framebuffer.minWindow.x-t.position.x)/(e.position.x-t.position.x)));const i=new o.TextureCoordinate,l=r.position.z;return i.u=(t.textureCoordinate.u/t.position.z+(e.textureCoordinate.u/e.position.z-t.textureCoordinate.u/t.position.z)*(s.Framebuffer.minWindow.x-t.position.x)/(e.position.x-t.position.x))*l,i.v=(t.textureCoordinate.v/t.position.z+(e.textureCoordinate.v/e.position.z-t.textureCoordinate.v/t.position.z)*(s.Framebuffer.minWindow.x-t.position.x)/(e.position.x-t.position.x))*l,r.textureCoordinate=i,r}}e.LeftClipEdge=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BottomClipEdge=void 0;const i=r(2),o=r(0),n=r(3),s=r(5),a=r(6);class l extends a.AbstractClipEdge{isInside(t){return t.projection.y>=i.Framebuffer.minWindow.y}isInside2(t){return t.position.y>=i.Framebuffer.minWindow.y}computeIntersection(t,e){const r=new s.Vertex,n=(i.Framebuffer.minWindow.y-t.projection.y)/(e.projection.y-t.projection.y);return r.color=e.color.sub(t.color).mul(n).add(t.color),r.projection=new o.Vector4f(Math.round(t.projection.x+(e.projection.x-t.projection.x)*n),i.Framebuffer.minWindow.y,1/(1/t.projection.z+(1/e.projection.z-1/t.projection.z)*n)),r}computeIntersection2(t,e){const r=new s.Vertex;r.position=new o.Vector4f(Math.round(t.position.x+(e.position.x-t.position.x)*(i.Framebuffer.minWindow.y-t.position.y)/(e.position.y-t.position.y)),i.Framebuffer.minWindow.y,1/(1/t.position.z+(1/e.position.z-1/t.position.z)*(i.Framebuffer.minWindow.y-t.position.y)/(e.position.y-t.position.y)));const a=new n.TextureCoordinate,l=r.position.z;return a.u=(t.textureCoordinate.u/t.position.z+(e.textureCoordinate.u/e.position.z-t.textureCoordinate.u/t.position.z)*(i.Framebuffer.minWindow.y-t.position.y)/(e.position.y-t.position.y))*l,a.v=(t.textureCoordinate.v/t.position.z+(e.textureCoordinate.v/e.position.z-t.textureCoordinate.v/t.position.z)*(i.Framebuffer.minWindow.y-t.position.y)/(e.position.y-t.position.y))*l,r.textureCoordinate=a,r}}e.BottomClipEdge=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TopClipEdge=void 0;const i=r(2),o=r(0),n=r(3),s=r(5),a=r(6);class l extends a.AbstractClipEdge{isInside(t){return t.projection.y<i.Framebuffer.maxWindow.y+1}isInside2(t){return t.position.y<i.Framebuffer.maxWindow.y+1}computeIntersection(t,e){const r=new s.Vertex,n=(i.Framebuffer.maxWindow.y+1-t.projection.y)/(e.projection.y-t.projection.y);return r.color=e.color.sub(t.color).mul(n).add(t.color),r.projection=new o.Vector4f(Math.round(t.projection.x+(e.projection.x-t.projection.x)*n),i.Framebuffer.maxWindow.y+1,1/(1/t.projection.z+(1/e.projection.z-1/t.projection.z)*n)),r}computeIntersection2(t,e){const r=new s.Vertex;r.position=new o.Vector4f(Math.round(t.position.x+(e.position.x-t.position.x)*(i.Framebuffer.maxWindow.y+1-t.position.y)/(e.position.y-t.position.y)),i.Framebuffer.maxWindow.y+1,1/(1/t.position.z+(1/e.position.z-1/t.position.z)*(i.Framebuffer.maxWindow.y+1-t.position.y)/(e.position.y-t.position.y)));const a=new n.TextureCoordinate,l=r.position.z;return a.u=(t.textureCoordinate.u/t.position.z+(e.textureCoordinate.u/e.position.z-t.textureCoordinate.u/t.position.z)*(i.Framebuffer.maxWindow.y+1-t.position.y)/(e.position.y-t.position.y))*l,a.v=(t.textureCoordinate.v/t.position.z+(e.textureCoordinate.v/e.position.z-t.textureCoordinate.v/t.position.z)*(i.Framebuffer.maxWindow.y+1-t.position.y)/(e.position.y-t.position.y))*l,r.textureCoordinate=a,r}}e.TopClipEdge=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractRenderingPipeline=void 0;const i=r(8);e.AbstractRenderingPipeline=class{constructor(t){this.framebuffer=t,this.NEAR_PLANE_Z=-1.7,this.cullMode=i.CullFace.BACK}setCullFace(t){this.cullMode=t}setAlpha(t){this.alpha=Math.max(Math.min(t,1),0)}isInFrontOfNearPlane(t){return t.z<this.NEAR_PLANE_Z}isTriangleCCW(t,e,r){const o=t.x*e.y-e.x*t.y+e.x*r.y-r.x*e.y+r.x*t.y-t.x*r.y;return this.cullMode===i.CullFace.BACK?o<0:o>0}isTriangleCCW2(t,e,r,o){const n=t.x*e.y-e.x*t.y+e.x*r.y-r.x*e.y+r.x*o.y-o.x*r.y+o.x*t.y-t.x*o.y;return this.cullMode===i.CullFace.BACK?n<0:n>0}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractScene=void 0;e.AbstractScene=class{init(t){return Promise.all([])}onInit(){}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Matrix4f=void 0;const i=r(1),o=r(4);class n{static constructIdentityMatrix(){const t=new n;return t.m11=1,t.m12=0,t.m13=0,t.m14=0,t.m21=0,t.m22=1,t.m23=0,t.m24=0,t.m31=0,t.m32=0,t.m33=1,t.m34=0,t.m41=0,t.m42=0,t.m43=0,t.m44=1,t}setIdentityMatrix(){this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}transpose(){const t=new n;return t.m11=this.m11,t.m12=this.m21,t.m13=this.m31,t.m14=this.m41,t.m21=this.m12,t.m22=this.m22,t.m23=this.m32,t.m24=this.m42,t.m31=this.m13,t.m32=this.m23,t.m33=this.m33,t.m34=this.m43,t.m41=this.m14,t.m42=this.m24,t.m43=this.m34,t.m44=this.m44,t}computeNormalMatrix(){return this.inverse().transpose()}inverse(){const t=n.constructIdentityMatrix();t.m14=-this.m14,t.m24=-this.m24,t.m34=-this.m34;const e=1/Math.sqrt(this.m11*this.m11+this.m12*this.m12+this.m13*this.m13),r=1/Math.sqrt(this.m21*this.m21+this.m22*this.m22+this.m23*this.m23),i=1/Math.sqrt(this.m31*this.m31+this.m32*this.m32+this.m33*this.m33),o=n.constructIdentityMatrix();return o.m11=this.m11*e,o.m21=this.m12*e,o.m31=this.m13*e,o.m12=this.m21*r,o.m22=this.m22*r,o.m32=this.m23*r,o.m13=this.m31*i,o.m23=this.m32*i,o.m33=this.m33*i,o.multiplyMatrix(t)}getInverseRotation(){const t=n.constructIdentityMatrix();return t.m11=1*this.m11,t.m21=1*this.m12,t.m31=1*this.m13,t.m12=1*this.m21,t.m22=1*this.m22,t.m32=1*this.m23,t.m13=1*this.m31,t.m23=1*this.m32,t.m33=1*this.m33,t}getRotation(){const t=n.constructIdentityMatrix();return t.m11=this.m11,t.m21=this.m21,t.m31=this.m31,t.m12=this.m12,t.m22=this.m22,t.m32=this.m32,t.m13=this.m13,t.m23=this.m23,t.m33=this.m33,t}static constructShadowMatrix(t){const e=new i.Vector3f(0,-1.5,0),r=new i.Vector3f(0,1,0),o=new i.Vector3f(0,11,0),s=-e.dot(r),a=r.x*o.x+r.y*o.y+r.z*o.z,l=new n;return l.m11=a+s-o.x*r.x,l.m12=-o.x*r.y,l.m13=-o.x*r.z,l.m14=-o.x*s,l.m21=-o.y*r.x,l.m22=a+s-o.y*r.y,l.m23=-o.y*r.z,l.m24=-o.y*s,l.m31=-o.z*r.x,l.m32=-o.z*r.y,l.m33=a+s-o.z*r.z,l.m34=-o.z*s,l.m41=-r.x,l.m42=-r.y,l.m43=-r.z,l.m44=a,l}static constructTranslationMatrix(t,e,r){const i=new n;return i.m11=1,i.m12=0,i.m13=0,i.m14=t,i.m21=0,i.m22=1,i.m23=0,i.m24=e,i.m31=0,i.m32=0,i.m33=1,i.m34=r,i.m41=0,i.m42=0,i.m43=0,i.m44=1,i}setTranslationMatrix(t,e,r){this.m11=1,this.m12=0,this.m13=0,this.m14=t,this.m21=0,this.m22=1,this.m23=0,this.m24=e,this.m31=0,this.m32=0,this.m33=1,this.m34=r,this.m41=0,this.m42=0,this.m43=0,this.m44=1}static constructXRotationMatrix(t){const e=new n;return e.m11=1,e.m12=0,e.m13=0,e.m14=0,e.m21=0,e.m22=Math.cos(t),e.m23=-Math.sin(t),e.m24=0,e.m31=0,e.m32=Math.sin(t),e.m33=Math.cos(t),e.m34=0,e.m41=0,e.m42=0,e.m43=0,e.m44=1,e}setXRotationMatrix(t){this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=Math.cos(t),this.m23=-Math.sin(t),this.m24=0,this.m31=0,this.m32=Math.sin(t),this.m33=Math.cos(t),this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}setScaleMatrix(t,e,r){this.m11=t,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=e,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=r,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}setYRotationMatrix(t){this.m11=Math.cos(t),this.m12=0,this.m13=Math.sin(t),this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=-Math.sin(t),this.m32=0,this.m33=Math.cos(t),this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}static constructYRotationMatrix(t){const e=new n;return e.m11=Math.cos(t),e.m12=0,e.m13=Math.sin(t),e.m14=0,e.m21=0,e.m22=1,e.m23=0,e.m24=0,e.m31=-Math.sin(t),e.m32=0,e.m33=Math.cos(t),e.m34=0,e.m41=0,e.m42=0,e.m43=0,e.m44=1,e}static constructZRotationMatrix(t){const e=new n;return e.m11=Math.cos(t),e.m12=-Math.sin(t),e.m13=0,e.m14=0,e.m21=Math.sin(t),e.m22=Math.cos(t),e.m23=0,e.m24=0,e.m31=0,e.m32=0,e.m33=1,e.m34=0,e.m41=0,e.m42=0,e.m43=0,e.m44=1,e}static constructScaleMatrix(t,e=t,r=e){const i=new n;return i.m11=t,i.m12=0,i.m13=0,i.m14=0,i.m21=0,i.m22=e,i.m23=0,i.m24=0,i.m31=0,i.m32=0,i.m33=r,i.m34=0,i.m41=0,i.m42=0,i.m43=0,i.m44=1,i}multiplyMatrix(t){const e=new n;return e.m11=this.m11*t.m11+this.m12*t.m21+this.m13*t.m31+this.m14*t.m41,e.m21=this.m21*t.m11+this.m22*t.m21+this.m23*t.m31+this.m24*t.m41,e.m31=this.m31*t.m11+this.m32*t.m21+this.m33*t.m31+this.m34*t.m41,e.m41=this.m41*t.m11+this.m42*t.m21+this.m43*t.m31+this.m44*t.m41,e.m12=this.m11*t.m12+this.m12*t.m22+this.m13*t.m32+this.m14*t.m42,e.m22=this.m21*t.m12+this.m22*t.m22+this.m23*t.m32+this.m24*t.m42,e.m32=this.m31*t.m12+this.m32*t.m22+this.m33*t.m32+this.m34*t.m42,e.m42=this.m41*t.m12+this.m42*t.m22+this.m43*t.m32+this.m44*t.m42,e.m13=this.m11*t.m13+this.m12*t.m23+this.m13*t.m33+this.m14*t.m43,e.m23=this.m21*t.m13+this.m22*t.m23+this.m23*t.m33+this.m24*t.m43,e.m33=this.m31*t.m13+this.m32*t.m23+this.m33*t.m33+this.m34*t.m43,e.m43=this.m41*t.m13+this.m42*t.m23+this.m43*t.m33+this.m44*t.m43,e.m14=this.m11*t.m14+this.m12*t.m24+this.m13*t.m34+this.m14*t.m44,e.m24=this.m21*t.m14+this.m22*t.m24+this.m23*t.m34+this.m24*t.m44,e.m34=this.m31*t.m14+this.m32*t.m24+this.m33*t.m34+this.m34*t.m44,e.m44=this.m41*t.m14+this.m42*t.m24+this.m43*t.m34+this.m44*t.m44,e}multiply2(t,e){this.m11=t.m11*e.m11+t.m12*e.m21+t.m13*e.m31+t.m14*e.m41,this.m21=t.m21*e.m11+t.m22*e.m21+t.m23*e.m31+t.m24*e.m41,this.m31=t.m31*e.m11+t.m32*e.m21+t.m33*e.m31+t.m34*e.m41,this.m41=t.m41*e.m11+t.m42*e.m21+t.m43*e.m31+t.m44*e.m41,this.m12=t.m11*e.m12+t.m12*e.m22+t.m13*e.m32+t.m14*e.m42,this.m22=t.m21*e.m12+t.m22*e.m22+t.m23*e.m32+t.m24*e.m42,this.m32=t.m31*e.m12+t.m32*e.m22+t.m33*e.m32+t.m34*e.m42,this.m42=t.m41*e.m12+t.m42*e.m22+t.m43*e.m32+t.m44*e.m42,this.m13=t.m11*e.m13+t.m12*e.m23+t.m13*e.m33+t.m14*e.m43,this.m23=t.m21*e.m13+t.m22*e.m23+t.m23*e.m33+t.m24*e.m43,this.m33=t.m31*e.m13+t.m32*e.m23+t.m33*e.m33+t.m34*e.m43,this.m43=t.m41*e.m13+t.m42*e.m23+t.m43*e.m33+t.m44*e.m43,this.m14=t.m11*e.m14+t.m12*e.m24+t.m13*e.m34+t.m14*e.m44,this.m24=t.m21*e.m14+t.m22*e.m24+t.m23*e.m34+t.m24*e.m44,this.m34=t.m31*e.m14+t.m32*e.m24+t.m33*e.m34+t.m34*e.m44,this.m44=t.m41*e.m14+t.m42*e.m24+t.m43*e.m34+t.m44*e.m44}multiply(t){return new i.Vector3f(this.m11*t.x+this.m12*t.y+this.m13*t.z+this.m14,this.m21*t.x+this.m22*t.y+this.m23*t.z+this.m24,this.m31*t.x+this.m32*t.y+this.m33*t.z+this.m34)}multiplyHom(t){return new o.Vector4f(this.m11*t.x+this.m12*t.y+this.m13*t.z+this.m14*t.w,this.m21*t.x+this.m22*t.y+this.m23*t.z+this.m24*t.w,this.m31*t.x+this.m32*t.y+this.m33*t.z+this.m34*t.w,this.m41*t.x+this.m42*t.y+this.m43*t.z+this.m44*t.w)}multiplyHomArr(t,e){e.x=this.m11*t.x+this.m12*t.y+this.m13*t.z+this.m14*t.w,e.y=this.m21*t.x+this.m22*t.y+this.m23*t.z+this.m24*t.w,e.z=this.m31*t.x+this.m32*t.y+this.m33*t.z+this.m34*t.w}multiplyHomArr2(t,e){e.x=this.m11*t.x+this.m12*t.y+this.m13*t.z+this.m14*t.w,e.y=this.m21*t.x+this.m22*t.y+this.m23*t.z+this.m24*t.w,e.z=this.m31*t.x+this.m32*t.y+this.m33*t.z+this.m34*t.w,e.w=this.m41*t.x+this.m42*t.y+this.m43*t.z+this.m44*t.w,e.x/=e.w,e.y/=e.w,e.z/=e.w}multiplyArr(t,e){e.x=this.m11*t.x+this.m12*t.y+this.m13*t.z+this.m14,e.y=this.m21*t.x+this.m22*t.y+this.m23*t.z+this.m24,e.z=this.m31*t.x+this.m32*t.y+this.m33*t.z+this.m34}}e.Matrix4f=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FlatShadingRenderingPipeline=void 0;const i=r(7),o=r(0),n=r(10),s=r(34),a=r(35),l=r(24),c=r(27),h=r(5),u=r(17),f=r(37);class d extends u.AbstractRenderingPipeline{constructor(t){super(t),this.fog=null,this.lights=null,this.material=null,this.lighting=!0,this.color=i.Color.WHITE,this.triangleRasterizer=null,this.projectedVertices=new Array(new o.Vector4f(0,0,0,1),new o.Vector4f(0,0,0,1),new o.Vector4f(0,0,0,1)),this.vertexArray=new Array(new h.Vertex,new h.Vertex,new h.Vertex);const e=new l.PointLight;e.ambientIntensity=new o.Vector4f(1,1,1,1),e.diffuseIntensity=new o.Vector4f(1,1,1,1),e.specularIntensity=new o.Vector4f(1,1,1,1),e.position=new o.Vector4f(3,0,-2,1);const r=new l.PointLight;r.ambientIntensity=new o.Vector4f(0,0,1,1),r.diffuseIntensity=new o.Vector4f(0,.6,1,1),r.specularIntensity=new o.Vector4f(.8,.8,.8,1),r.position=new o.Vector4f(0,-380,-180,1),this.lights=[e,r];const s=new c.Material;s.ambientColor=new o.Vector4f(.12,.14,.1,0),s.diffuseColor=new o.Vector4f(.38,.4,.4,1),s.specularColor=new o.Vector4f(.8,.5,.5,0),s.shininess=2,this.material=s,this.triangleRasterizer=new n.FlatShadingTriangleRasterizer(this.framebuffer),this.triangleRasterizer=new f.GouraudShadingTriangleRasterizer(this.framebuffer)}setFog(t){this.fog=t}setLights(t){this.lights=t}enableLighting(t){this.lighting=t}setMaterial(t){this.material=t}setColor(t){this.color=t}draw(t,e){const r=e.computeNormalMatrix();for(let e=0;e<t.normals.length;e++)r.multiplyHomArr(t.normals[e],t.transformedNormals[e]);for(let r=0;r<t.points.length;r++)e.multiplyHomArr(t.points[r],t.transformedPoints[r]);for(let e=0;e<t.faces.length;e++){const r=t.transformedPoints[t.faces[e].v1],i=t.transformedPoints[t.faces[e].v2],o=t.transformedPoints[t.faces[e].v3],n=t.transformedNormals[t.faces[e].n1],s=t.transformedNormals[t.faces[e].n2],a=t.transformedNormals[t.faces[e].n3];if(this.isInFrontOfNearPlane(r)&&this.isInFrontOfNearPlane(i)&&this.isInFrontOfNearPlane(o))this.project2(r,this.projectedVertices[0]),this.project2(i,this.projectedVertices[1]),this.project2(o,this.projectedVertices[2]),this.vertexArray[0].position=r,this.vertexArray[0].projection=this.projectedVertices[0],this.vertexArray[0].normal=n,this.vertexArray[1].position=i,this.vertexArray[1].projection=this.projectedVertices[1],this.vertexArray[1].normal=s,this.vertexArray[2].position=o,this.vertexArray[2].projection=this.projectedVertices[2],this.vertexArray[2].normal=a,this.renderConvexPolygon(this.vertexArray,!0);else{if(!(this.isInFrontOfNearPlane(r)||this.isInFrontOfNearPlane(i)||this.isInFrontOfNearPlane(o)))continue;{this.vertexArray[0].position=r,this.vertexArray[1].position=i,this.vertexArray[2].position=o,this.lighting?(this.vertexArray[0].color=this.computeColor(n,r),this.vertexArray[1].color=this.computeColor(s,i),this.vertexArray[2].color=this.computeColor(a,o)):(this.vertexArray[0].color=this.color,this.vertexArray[1].color=this.color,this.vertexArray[2].color=this.color);const t=this.zClipTriangle(this.vertexArray);if(t.length<3)return;for(let e=0;e<t.length;e++)t[e].projection=this.project(t[e].position);this.renderConvexPolygon(t)}}}}project(t){return new o.Vector4f(Math.round(160+292*t.x/-t.z),Math.round(100-292*t.y/-t.z),t.z)}project2(t,e){e.x=Math.round(160+292*t.x/-t.z),e.y=Math.round(100-292*t.y/-t.z),e.z=t.z}computeNearPlaneIntersection(t,e){const r=(this.NEAR_PLANE_Z-t.position.z)/(e.position.z-t.position.z),i=new h.Vertex;return i.position=new o.Vector4f(r*(e.position.x-t.position.x)+t.position.x,r*(e.position.y-t.position.y)+t.position.y,this.NEAR_PLANE_Z),i.color=e.color.sub(t.color).mul(r).add(t.color),i}zClipTriangle(t){const e=t,r=new Array;let i=e[e.length-1];for(let t=0;t<e.length;t++){const o=e[t];this.isInFrontOfNearPlane(o.position)?(this.isInFrontOfNearPlane(i.position)||r.push(this.computeNearPlaneIntersection(i,o)),r.push(o)):this.isInFrontOfNearPlane(i.position)&&r.push(this.computeNearPlaneIntersection(i,o)),i=o}return r}renderConvexPolygon(t,e=!1){if(3===t.length&&!this.isTriangleCCW(t[0].projection,t[1].projection,t[2].projection))return;if(e&&(this.lighting?(this.vertexArray[0].color=this.computeColor(this.vertexArray[0].normal,this.vertexArray[0].position),this.vertexArray[1].color=this.computeColor(this.vertexArray[1].normal,this.vertexArray[1].position),this.vertexArray[2].color=this.computeColor(this.vertexArray[2].normal,this.vertexArray[2].position)):(this.vertexArray[0].color=this.color,this.vertexArray[1].color=this.color,this.vertexArray[2].color=this.color)),4===t.length&&!this.isTriangleCCW2(t[0].projection,t[1].projection,t[2].projection,t[3].projection))return;const r=s.SutherlandHodgman2DClipper.clipConvexPolygon(t);r.length<3||this.triangulateConvexPolygon(r)}triangulateConvexPolygon(t){for(let e=0;e<t.length-2;e++)this.triangleRasterizer.drawTriangleDDA(t[0],t[1+e],t[2+e])}computeColor(t,e){let r=(new a.PhongLighting).computeColor(this.material,this.lights,t,e);return null!==this.fog&&(r=this.fog.computeVertexColor(r,e)),new i.Color(Math.min(255,255*r.x),Math.min(255,255*r.y),Math.min(255,255*r.z),255)}}e.FlatShadingRenderingPipeline=d},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextureUtils=void 0;const i=r(28),o=r(9);e.TextureUtils=class{static generateProceduralNoise(){return new Promise(t=>{const e=new o.Texture;e.texture=new Uint32Array(65536);const r=new i.default;r.setSeed(100);for(let t=0;t<65536;t++){const i=r.getFloat();e.texture[t]=200*i|255*i<<8|205*i<<16|255<<24}e.width=256,e.height=256,t(e)})}static generateProceduralParticleTexture(){return new Promise(t=>{const e=new o.Texture;e.texture=new Uint32Array(65536),(new i.default).setSeed(100);for(let t=0;t<256;t++)for(let r=0;r<256;r++){const i=127-r,o=127-t,n=Math.sqrt(i*i+o*o)/127;let s=1-n;s*=s*s,n>1&&(s=0),s=Math.min(1,2.9*s),e.texture[r+256*t]=15466475|255*s<<24}e.width=256,e.height=256,t(e)})}static generateProceduralParticleTexture2(){return new Promise(t=>{const e=new o.Texture;e.texture=new Uint32Array(65536),(new i.default).setSeed(100);for(let t=0;t<256;t++)for(let r=0;r<256;r++){const i=127-r,o=127-t,n=Math.sqrt(i*i+o*o)/127;let s=1-n;s*=s,n>1&&(s=0),s=Math.min(1,40*s),e.texture[r+256*t]=16764415|255*s<<24}e.width=256,e.height=256,t(e)})}static load(t,e){return new Promise(r=>{const i=new Image;i.onload=()=>{const t=new o.Texture;t.texture=this.getImageData(i,e),t.width=i.width,t.height=i.height,r(t)},i.onerror=()=>r(),i.src=t.default})}static getImageData(t,e=!1){const r=document.createElement("canvas");r.width=t.width,r.height=t.height;const i=r.getContext("2d");i.drawImage(t,0,0);const o=i.getImageData(0,0,t.width,t.height).data,n=new Uint32Array(o.length/4);let s=0;for(let t=0;t<o.length;t+=4)n[s]=e?o[t+3]<<24|o[t+2]<<16|o[t+1]<<8|o[t+0]:255<<24|o[t+2]<<16|o[t+1]<<8|o[t+0],s++;return n}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractGeometricObject=void 0;const i=r(0);e.AbstractGeometricObject=class{buildMesh(t,e,r=!1){this.inverse=r;const o=new Array;for(let r=0;r<e.length;r+=3){const i=t[e[r+1]].sub(t[e[r]]).cross(t[e[r+2]].sub(t[e[r]]));o.push(this.inverse?i.normalize().mul(-1):i.normalize())}const n=new Array;for(let t=0;t<e.length;t+=3)n.push({n1:t/3,n2:t/3,n3:t/3,v1:e[0+t],v2:e[1+t],v3:e[2+t]});this.mesh={points:t,normals:o,faces:n,transformedPoints:t.map(()=>new i.Vector4f(0,0,0,0)),transformedNormals:o.map(()=>new i.Vector4f(0,0,0,0))}}getMesh(){return this.mesh}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ScaleClipBlitter=void 0;e.ScaleClipBlitter=class{constructor(t){this.framebuffer=t}drawScaledTextureClip(t,e,r,i,o,n){const s=o.width/r,a=o.height/i;let l,c,h,u,f,d=0,p=0;if(e+i<0||e>199||t+r<0||t>319)return;e<0?(p=a*-e,l=i+e-Math.max(e+i-200,0),h=0):(h=e,l=i-Math.max(e+i-200,0)),t<0?(f=d=s*-t,c=r+t-Math.max(t+r-320,0),u=0):(f=0,u=t,c=r-Math.max(t+r-320,0));const m=1/255*n;let x=u+320*h;for(let t=0;t<l;t++){for(let t=0;t<c;t++){const t=Math.min(0|d,o.width-1)+Math.min(0|p,o.height-1)*o.width,e=(o.texture[t]>>24&255)*m,r=1-e,i=this.framebuffer.framebuffer[x],n=o.texture[t],a=(i>>0&255)*r+(n>>0&255)*e,l=(i>>8&255)*r+(n>>8&255)*e,c=(i>>16&255)*r+(n>>16&255)*e;this.framebuffer.framebuffer[x]=a|l<<8|c<<16|255<<24,d+=s,x++}p+=a,d=f,x+=320-c}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PointLight=void 0;const i=r(36);class o extends i.Light{}e.PointLight=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Torus=void 0;const i=r(4),o=r(22),n=r(1);class s extends o.AbstractGeometricObject{constructor(t=!1){super();const e=[];this.inverse=t;for(let t=0;t<15;t++){const r=this.torusFunction(2*t*Math.PI/15),o=this.torusFunction(2*t*Math.PI/15+.1),s=new n.Vector3f(0,4,0),a=o.sub(r).cross(s);for(let t=0;t<12;t++){const o=s.mul(Math.sin(2*t*Math.PI/12)).add(a.mul(Math.cos(2*t*Math.PI/12))).add(r);e.push(new i.Vector4f(o.x,o.y,o.z,1))}}const r=[];for(let t=0;t<15;t++)for(let i=0;i<12;i++)r.push((12*t+(1+i)%12)%e.length),r.push((12*t+(0+i)%12)%e.length),r.push((12*t+12+(1+i)%12)%e.length),r.push((12*t+12+(0+i)%12)%e.length),r.push((12*t+12+(1+i)%12)%e.length),r.push((12*t+(0+i)%12)%e.length);this.buildMesh(e,r)}torusFunction(t){return new n.Vector3f(10*Math.sin(t),0,10*Math.cos(t))}}e.Torus=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vector2f=void 0;class i{constructor(t,e){this.x=t,this.y=e}perp(){return new i(-this.y,this.x)}sub(t){return new i(this.x-t.x,this.y-t.y)}mul(t){return new i(this.x*t,this.y*t)}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const t=1/this.length();return this.mul(t)}dot(t){return this.x*t.x+this.y*t.y}}e.Vector2f=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Material=void 0;e.Material=class{}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(){this.seed=6}getFloat(){return this.seed=(9301*this.seed+49297)%233280,this.seed/233280}setSeed(t){this.seed=t}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TexturingRenderingPipeline=void 0;const i=r(2),o=r(4),n=r(39),s=r(12),a=r(3),l=r(5),c=r(17);class h extends c.AbstractRenderingPipeline{constructor(t){super(t),this.triangleRasterizer=null,this.vertexArray=new Array(new l.Vertex,new l.Vertex,new l.Vertex),this.projectedVertices=new Array(new o.Vector4f(0,0,0,1),new o.Vector4f(0,0,0,1),new o.Vector4f(0,0,0,1)),this.setAlpha(1),this.triangleRasterizer=new s.TexturedTriangleRasterizer(t)}enableAlphaBlending(){this.triangleRasterizer=new n.TexturedAlphaBlendingTriangleRasterizer(this.framebuffer,this)}disableAlphaBlending(){this.triangleRasterizer=new s.TexturedTriangleRasterizer(this.framebuffer)}setModelViewMatrix(t){this.modelViewMatrix=t}drawMeshArray(t){for(let e=0;e<t.length;e++){const r=t[e];this.draw(r)}}draw(t){for(let e=0;e<t.points.length;e++)this.modelViewMatrix.multiplyHomArr(t.points[e],t.points2[e]);for(let e=0;e<t.faces.length;e++){const r=t.points2[t.faces[e].vertices[0]],i=t.points2[t.faces[e].vertices[1]],o=t.points2[t.faces[e].vertices[2]];if(this.isInFrontOfNearPlane(r)&&this.isInFrontOfNearPlane(i)&&this.isInFrontOfNearPlane(o))this.project2(r,this.projectedVertices[0]),this.project2(i,this.projectedVertices[1]),this.project2(o,this.projectedVertices[2]),this.isTriangleCCW(this.projectedVertices[0],this.projectedVertices[1],this.projectedVertices[2])&&(this.vertexArray[0].position=this.projectedVertices[0],this.vertexArray[0].textureCoordinate=t.uv[t.faces[e].uv[0]],this.vertexArray[1].position=this.projectedVertices[1],this.vertexArray[1].textureCoordinate=t.uv[t.faces[e].uv[1]],this.vertexArray[2].position=this.projectedVertices[2],this.vertexArray[2].textureCoordinate=t.uv[t.faces[e].uv[2]],this.clipConvexPolygon2(this.vertexArray));else{if(!(this.isInFrontOfNearPlane(r)||this.isInFrontOfNearPlane(i)||this.isInFrontOfNearPlane(o)))continue;this.vertexArray[0].position=r,this.vertexArray[0].textureCoordinate=t.uv[t.faces[e].uv[0]],this.vertexArray[1].position=i,this.vertexArray[1].textureCoordinate=t.uv[t.faces[e].uv[1]],this.vertexArray[2].position=o,this.vertexArray[2].textureCoordinate=t.uv[t.faces[e].uv[2]],this.zClipTriangle2(this.vertexArray)}}}project(t){return new o.Vector4f(Math.round(160+292*t.x/-t.z),Math.round(100-292*t.y/-t.z),t.z)}project2(t,e){e.x=Math.round(160+292*t.x/-t.z),e.y=Math.round(100-292*t.y/-t.z),e.z=t.z}computeNearPlaneIntersection2(t,e){const r=(this.NEAR_PLANE_Z-t.position.z)/(e.position.z-t.position.z),i=new l.Vertex;return i.position=new o.Vector4f(r*(e.position.x-t.position.x)+t.position.x,r*(e.position.y-t.position.y)+t.position.y,this.NEAR_PLANE_Z),i.textureCoordinate=new a.TextureCoordinate(r*(e.textureCoordinate.u-t.textureCoordinate.u)+t.textureCoordinate.u,r*(e.textureCoordinate.v-t.textureCoordinate.v)+t.textureCoordinate.v),i}zClipTriangle2(t){const e=t,r=new Array;let i=e[e.length-1];for(let t=0;t<e.length;t++){const o=e[t];this.isInFrontOfNearPlane(o.position)?(this.isInFrontOfNearPlane(i.position)||r.push(this.computeNearPlaneIntersection2(i,o)),r.push(o)):this.isInFrontOfNearPlane(i.position)&&r.push(this.computeNearPlaneIntersection2(i,o)),i=o}if(r.length<3)return;const o=r.map(t=>(t.position=this.project(t.position),t));(3!==r.length||this.isTriangleCCW(o[0].position,o[1].position,o[2].position))&&(4!==r.length||this.isTriangleCCW2(o[0].position,o[1].position,o[2].position,o[3].position))&&this.clipConvexPolygon2(o)}clipConvexPolygon2(t){let e=t;for(let t=0;t<i.Framebuffer.clipRegion.length;t++){const r=i.Framebuffer.clipRegion[t],o=e;e=new Array;let n=o[o.length-1];for(let t=0;t<o.length;t++){const i=o[t];r.isInside2(i)?(r.isInside2(n)||e.push(r.computeIntersection2(n,i)),e.push(i)):r.isInside2(n)&&e.push(r.computeIntersection2(n,i)),n=i}}if(!(e.length<3))for(let t=0;t<e.length-2;t++)this.triangleRasterizer.drawTriangleDDA(e[0],e[1+t],e[2+t])}}e.TexturingRenderingPipeline=h},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Canvas=void 0;const i=r(2),o=r(41);e.Canvas=class{constructor(t,e,r){this.scene=r,this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=e,this.canvas.style.cssText="image-rendering: optimizeSpeed;image-rendering: -moz-crisp-edges;image-rendering: -o-crisp-edges;image-rendering: -webkit-crisp-edges;image-rendering: crisp-edges;image-rendering: -webkit-optimize-contrast;image-rendering: pixelated; -ms-interpolation-mode: nearest-neighbor;",this.canvas.style.width=2*t+"px",this.canvas.style.height=2*e+"px",this.context=this.canvas.getContext("2d"),this.context.oImageSmoothingEnabled=!1,this.context.imageSmoothingEnabled=!1,this.context.webkitImageSmoothingEnabled=!1,this.framebuffer=new i.Framebuffer(320,200),this.boundRenderLoop=this.renderLoop.bind(this)}init(){this.canvas.addEventListener("click",t=>{t.preventDefault(),o.FullscreenUtils.toggleFullscreen(this.canvas)}),this.scene.init(this.framebuffer).then(()=>{this.scene.onInit(),this.renderLoop(0)})}renderLoop(t){this.scene.render(this.framebuffer,t),this.flipBackbuffer(),requestAnimationFrame(this.boundRenderLoop)}flipBackbuffer(){this.context.putImageData(this.framebuffer.getImageData(),0,0)}appendTo(t){t.appendChild(this.canvas)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Matrix3f=void 0;const i=r(1);class o{static constructXRotationMatrix(t){const e=new o,r=Math.cos(t),i=Math.sin(t);return e.m11=1,e.m12=0,e.m13=0,e.m21=0,e.m22=r,e.m23=-i,e.m31=0,e.m32=i,e.m33=r,e}static constructYRotationMatrix(t){const e=new o;return e.m11=Math.cos(t),e.m12=0,e.m13=Math.sin(t),e.m21=0,e.m22=1,e.m23=0,e.m31=-Math.sin(t),e.m32=0,e.m33=Math.cos(t),e}static constructZRotationMatrix(t){const e=new o;return e.m11=Math.cos(t),e.m12=-Math.sin(t),e.m13=0,e.m21=Math.sin(t),e.m22=Math.cos(t),e.m23=0,e.m31=0,e.m32=0,e.m33=1,e}static constructScaleMatrix(t,e,r){const i=new o;return i.m11=t,i.m12=0,i.m13=0,i.m21=0,i.m22=e,i.m23=0,i.m31=0,i.m32=0,i.m33=r,i}multiplyMatrix(t){const e=new o;return e.m11=this.m11*t.m11+this.m12*t.m21+this.m13*t.m31,e.m21=this.m21*t.m11+this.m22*t.m21+this.m23*t.m31,e.m31=this.m31*t.m11+this.m32*t.m21+this.m33*t.m31,e.m12=this.m11*t.m12+this.m12*t.m22+this.m13*t.m32,e.m22=this.m21*t.m12+this.m22*t.m22+this.m23*t.m32,e.m32=this.m31*t.m12+this.m32*t.m22+this.m33*t.m32,e.m13=this.m11*t.m13+this.m12*t.m23+this.m13*t.m33,e.m23=this.m21*t.m13+this.m22*t.m23+this.m23*t.m33,e.m33=this.m31*t.m13+this.m32*t.m23+this.m33*t.m33,e}multiply(t){return new i.Vector3f(this.m11*t.x+this.m12*t.y+this.m13*t.z,this.m21*t.x+this.m22*t.y+this.m23*t.z,this.m31*t.x+this.m32*t.y+this.m33*t.z)}}e.Matrix3f=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LineRasterizerDda=void 0;e.LineRasterizerDda=class{constructor(t){this.framebuffer=t}drawLineDDA(t,e,r){const i=e.x-t.x,o=e.y-t.y;let n,s,a;Math.abs(i)>Math.abs(o)?(n=Math.sign(i),s=o/Math.abs(i),a=Math.abs(i)):(n=i/Math.abs(o),s=Math.sign(o),a=Math.abs(o));let l=t.x,c=t.y,h=1/t.z;const u=(1/e.z-1/t.z)/a;for(let t=0;t<=a;t++)h<this.framebuffer.wBuffer[Math.round(l)+320*Math.round(c)]&&(this.framebuffer.wBuffer[Math.round(l)+320*Math.round(c)]=h,this.framebuffer.drawPixel(Math.round(l),Math.round(c),r)),l+=n,c+=s,h+=u}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LineRasterizerNoZ=void 0;e.LineRasterizerNoZ=class{constructor(t){this.framebuffer=t}drawLineDDANoZ(t,e,r){const i=e.x-t.x,o=e.y-t.y;let n,s,a;Math.abs(i)>Math.abs(o)?(n=Math.sign(i),s=o/Math.abs(i),a=Math.abs(i)):(n=i/Math.abs(o),s=Math.sign(o),a=Math.abs(o));let l=t.x,c=t.y;for(let t=0;t<=a;t++)this.framebuffer.drawPixel(Math.round(l),Math.round(c),r),l+=n,c+=s}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SutherlandHodgman2DClipper=void 0;const i=r(13),o=r(14),n=r(15),s=r(16);let a=(()=>{class t{static clipConvexPolygon(e){let r=e;for(let e=0;e<t.clipRegion.length;e++){const i=t.clipRegion[e],o=r;r=new Array;let n=o[o.length-1];for(let t=0;t<o.length;t++){const e=o[t];i.isInside(e)?(i.isInside(n)||r.push(i.computeIntersection(n,e)),r.push(e)):i.isInside(n)&&r.push(i.computeIntersection(n,e)),n=e}}return r}}return t.clipRegion=new Array(new i.RightClipEdge,new o.LeftClipEdge,new n.BottomClipEdge,new s.TopClipEdge),t})();e.SutherlandHodgman2DClipper=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PhongLighting=void 0;const i=r(0);e.PhongLighting=class{computeColor(t,e,r,o){let n=new i.Vector4f(0,0,0);for(let i=0;i<e.length;i++){const s=e[i],a=this.computeAmbientIntensity(t,s),l=this.computeDiffuseIntensity(t,s,r,o),c=this.computeSpecularIntensity(t,s,r,o);n=n.add(a).add(l).add(c)}return n}computeAmbientIntensity(t,e){return t.ambientColor.componentWiseMul(e.ambientIntensity)}computeDiffuseIntensity(t,e,r,i){const o=e.position.sub(i).normalize(),n=Math.min(Math.max(r.dot(o),0),1);return t.diffuseColor.componentWiseMul(e.diffuseIntensity).mul(n)}computeSpecularIntensity(t,e,r,i){const o=e.position.sub(i).normalize(),n=r.mul(2*r.dot(o)).sub(o),s=i.mul(-1).normalize(),a=Math.pow(Math.max(n.dot(s),0),t.shininess);return t.specularColor.componentWiseMul(e.specularIntensity).mul(a)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Light=void 0;e.Light=class{}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GouraudShadingTriangleRasterizer=void 0;const i=r(11),o=r(38);class n extends i.AbstractTriangleRasterizer{constructor(t){super(),this.framebuffer=t,this.temp=null,this.colorInterpolator1=new o.ColorInterpolator,this.colorInterpolator2=new o.ColorInterpolator,this.colorInterpolator3=new o.ColorInterpolator,this.rowColorInterpolator=new o.ColorInterpolator}drawTriangleDDA(t,e,r){if(t.projection.y>r.projection.y&&(this.temp=t,t=r,r=this.temp),t.projection.y>e.projection.y&&(this.temp=t,t=e,e=this.temp),e.projection.y>r.projection.y&&(this.temp=e,e=r,r=this.temp),t.projection.y!==r.projection.y)if(e.projection.y===r.projection.y)e.projection.x>r.projection.x&&(this.temp=e,e=r,r=this.temp),this.fillBottomFlatTriangle(t,e,r);else if(t.projection.y===e.projection.y)t.projection.x>e.projection.x&&(this.temp=t,t=e,e=this.temp),this.fillTopFlatTriangle(t,e,r);else{(r.projection.x-t.projection.x)*(e.projection.y-t.projection.y)/(r.projection.y-t.projection.y)+t.projection.x>e.projection.x?this.fillLongRightTriangle(t,e,r):this.fillLongLeftTriangle(t,e,r)}}fillBottomFlatTriangle(t,e,r){const i=r.projection.y-t.projection.y,o=(e.projection.x-t.projection.x)/i,n=(r.projection.x-t.projection.x)/i;this.colorInterpolator1.setup(t.color,e.color,i),this.colorInterpolator2.setup(t.color,r.color,i);const s=(1/e.projection.z-1/t.projection.z)/i,a=(1/r.projection.z-1/t.projection.z)/i;let l=1/t.projection.z,c=1/t.projection.z,h=t.projection.x,u=t.projection.x,f=t.projection.y;for(let t=0;t<i;t++){const t=Math.round(u)-Math.round(h);this.rowColorInterpolator.setup(this.colorInterpolator1.startColor,this.colorInterpolator2.startColor,t);let e=320*Math.round(f)+Math.round(h);const r=(c-l)/t;let i=l;for(let o=0;o<t;o++)i<this.framebuffer.wBuffer[e]&&(this.framebuffer.wBuffer[e]=i,this.framebuffer.framebuffer[e]=this.rowColorInterpolator.startColor.toPackedFormat()),e++,i+=r,this.rowColorInterpolator.startColor.r+=this.rowColorInterpolator.colorSlope.r,this.rowColorInterpolator.startColor.g+=this.rowColorInterpolator.colorSlope.g,this.rowColorInterpolator.startColor.b+=this.rowColorInterpolator.colorSlope.b;h+=o,u+=n,f++,this.colorInterpolator1.startColor.r+=this.colorInterpolator1.colorSlope.r,this.colorInterpolator1.startColor.g+=this.colorInterpolator1.colorSlope.g,this.colorInterpolator1.startColor.b+=this.colorInterpolator1.colorSlope.b,this.colorInterpolator2.startColor.r+=this.colorInterpolator2.colorSlope.r,this.colorInterpolator2.startColor.g+=this.colorInterpolator2.colorSlope.g,this.colorInterpolator2.startColor.b+=this.colorInterpolator2.colorSlope.b,l+=s,c+=a}}fillTopFlatTriangle(t,e,r){const i=r.projection.y-t.projection.y,o=(r.projection.x-t.projection.x)/i,n=(r.projection.x-e.projection.x)/i;this.colorInterpolator1.setup(t.color,r.color,i),this.colorInterpolator2.setup(e.color,r.color,i);const s=(1/r.projection.z-1/t.projection.z)/i,a=(1/r.projection.z-1/e.projection.z)/i;let l=1/t.projection.z,c=1/e.projection.z,h=t.projection.x,u=e.projection.x,f=t.projection.y;for(let t=0;t<i;t++){const t=Math.round(u)-Math.round(h);this.rowColorInterpolator.setup(this.colorInterpolator1.startColor,this.colorInterpolator2.startColor,t);let e=320*Math.round(f)+Math.round(h);for(let r=0;r<t;r++){const i=(c-l)/t*r+l;i<this.framebuffer.wBuffer[e]&&(this.framebuffer.wBuffer[e]=i,this.framebuffer.framebuffer[e]=this.rowColorInterpolator.startColor.toPackedFormat()),e++,this.rowColorInterpolator.startColor.r+=this.rowColorInterpolator.colorSlope.r,this.rowColorInterpolator.startColor.g+=this.rowColorInterpolator.colorSlope.g,this.rowColorInterpolator.startColor.b+=this.rowColorInterpolator.colorSlope.b}h+=o,u+=n,f++,this.colorInterpolator1.startColor.r+=this.colorInterpolator1.colorSlope.r,this.colorInterpolator1.startColor.g+=this.colorInterpolator1.colorSlope.g,this.colorInterpolator1.startColor.b+=this.colorInterpolator1.colorSlope.b,this.colorInterpolator2.startColor.r+=this.colorInterpolator2.colorSlope.r,this.colorInterpolator2.startColor.g+=this.colorInterpolator2.colorSlope.g,this.colorInterpolator2.startColor.b+=this.colorInterpolator2.colorSlope.b,l+=s,c+=a}}fillLongRightTriangle(t,e,r){let i=e.projection.y-t.projection.y;const o=r.projection.y-t.projection.y;this.colorInterpolator1.setup(t.color,e.color,i),this.colorInterpolator2.setup(t.color,r.color,o);let n=(e.projection.x-t.projection.x)/i;const s=(r.projection.x-t.projection.x)/o;let a=(1/e.projection.z-1/t.projection.z)/i;const l=(1/r.projection.z-1/t.projection.z)/o;let c=1/t.projection.z,h=1/t.projection.z,u=t.projection.x,f=t.projection.x,d=t.projection.y;for(let t=0;t<i;t++){const t=Math.round(f)-Math.round(u);this.rowColorInterpolator.setup(this.colorInterpolator1.startColor,this.colorInterpolator2.startColor,t);let e=320*Math.round(d)+Math.round(u);const r=(h-c)/t;let i=c;for(let o=0;o<t;o++)i<this.framebuffer.wBuffer[e]&&(this.framebuffer.wBuffer[e]=i,this.framebuffer.framebuffer[e]=this.rowColorInterpolator.startColor.toPackedFormat()),e++,i+=r,this.rowColorInterpolator.startColor.r+=this.rowColorInterpolator.colorSlope.r,this.rowColorInterpolator.startColor.g+=this.rowColorInterpolator.colorSlope.g,this.rowColorInterpolator.startColor.b+=this.rowColorInterpolator.colorSlope.b;u+=n,f+=s,d++,this.colorInterpolator1.startColor.r+=this.colorInterpolator1.colorSlope.r,this.colorInterpolator1.startColor.g+=this.colorInterpolator1.colorSlope.g,this.colorInterpolator1.startColor.b+=this.colorInterpolator1.colorSlope.b,this.colorInterpolator2.startColor.r+=this.colorInterpolator2.colorSlope.r,this.colorInterpolator2.startColor.g+=this.colorInterpolator2.colorSlope.g,this.colorInterpolator2.startColor.b+=this.colorInterpolator2.colorSlope.b,c+=a,h+=l}i=r.projection.y-e.projection.y,this.colorInterpolator3.setup(e.color,r.color,i),n=(r.projection.x-e.projection.x)/i,a=(1/r.projection.z-1/e.projection.z)/i,u=e.projection.x,d=e.projection.y;for(let t=0;t<i;t++){const t=Math.round(f)-Math.round(u);this.rowColorInterpolator.setup(this.colorInterpolator3.startColor,this.colorInterpolator2.startColor,t);let e=320*Math.round(d)+Math.round(u);const r=(h-c)/t;let i=c;for(let o=0;o<t;o++)i<this.framebuffer.wBuffer[e]&&(this.framebuffer.wBuffer[e]=i,this.framebuffer.framebuffer[e]=this.rowColorInterpolator.startColor.toPackedFormat()),e++,i+=r,this.rowColorInterpolator.startColor.r+=this.rowColorInterpolator.colorSlope.r,this.rowColorInterpolator.startColor.g+=this.rowColorInterpolator.colorSlope.g,this.rowColorInterpolator.startColor.b+=this.rowColorInterpolator.colorSlope.b;u+=n,f+=s,d++,this.colorInterpolator2.startColor.r+=this.colorInterpolator2.colorSlope.r,this.colorInterpolator2.startColor.g+=this.colorInterpolator2.colorSlope.g,this.colorInterpolator2.startColor.b+=this.colorInterpolator2.colorSlope.b,this.colorInterpolator3.startColor.r+=this.colorInterpolator3.colorSlope.r,this.colorInterpolator3.startColor.g+=this.colorInterpolator3.colorSlope.g,this.colorInterpolator3.startColor.b+=this.colorInterpolator3.colorSlope.b,c+=a,h+=l}}fillLongLeftTriangle(t,e,r){let i=e.projection.y-t.projection.y;const o=r.projection.y-t.projection.y;this.colorInterpolator2.setup(t.color,e.color,i),this.colorInterpolator1.setup(t.color,r.color,o);let n=(e.projection.x-t.projection.x)/i;const s=(r.projection.x-t.projection.x)/o;let a=(1/e.projection.z-1/t.projection.z)/i;const l=(1/r.projection.z-1/t.projection.z)/o;let c=1/t.projection.z,h=1/t.projection.z,u=t.projection.x,f=t.projection.x,d=t.projection.y;for(let t=0;t<i;t++){const t=Math.round(f)-Math.round(u);this.rowColorInterpolator.setup(this.colorInterpolator1.startColor,this.colorInterpolator2.startColor,t);let e=320*Math.round(d)+Math.round(u);const r=(h-c)/t;let i=c;for(let o=0;o<t;o++)i<this.framebuffer.wBuffer[e]&&(this.framebuffer.wBuffer[e]=i,this.framebuffer.framebuffer[e]=this.rowColorInterpolator.startColor.toPackedFormat()),e++,i+=r,this.rowColorInterpolator.startColor.r+=this.rowColorInterpolator.colorSlope.r,this.rowColorInterpolator.startColor.g+=this.rowColorInterpolator.colorSlope.g,this.rowColorInterpolator.startColor.b+=this.rowColorInterpolator.colorSlope.b;u+=s,f+=n,d++,this.colorInterpolator1.startColor.r+=this.colorInterpolator1.colorSlope.r,this.colorInterpolator1.startColor.g+=this.colorInterpolator1.colorSlope.g,this.colorInterpolator1.startColor.b+=this.colorInterpolator1.colorSlope.b,this.colorInterpolator2.startColor.r+=this.colorInterpolator2.colorSlope.r,this.colorInterpolator2.startColor.g+=this.colorInterpolator2.colorSlope.g,this.colorInterpolator2.startColor.b+=this.colorInterpolator2.colorSlope.b,c+=l,h+=a}i=r.projection.y-e.projection.y,this.colorInterpolator3.setup(e.color,r.color,i),n=(r.projection.x-e.projection.x)/i,a=(1/r.projection.z-1/e.projection.z)/i,h=1/e.projection.z,f=e.projection.x,d=e.projection.y;for(let t=0;t<i;t++){const t=Math.round(f)-Math.round(u);this.rowColorInterpolator.setup(this.colorInterpolator1.startColor,this.colorInterpolator3.startColor,t);let e=320*Math.round(d)+Math.round(u);const r=(h-c)/t;let i=c;for(let o=0;o<t;o++)i<this.framebuffer.wBuffer[e]&&(this.framebuffer.wBuffer[e]=i,this.framebuffer.framebuffer[e]=this.rowColorInterpolator.startColor.toPackedFormat()),e++,i+=r,this.rowColorInterpolator.startColor.r+=this.rowColorInterpolator.colorSlope.r,this.rowColorInterpolator.startColor.g+=this.rowColorInterpolator.colorSlope.g,this.rowColorInterpolator.startColor.b+=this.rowColorInterpolator.colorSlope.b;u+=s,f+=n,d++,this.colorInterpolator1.startColor.r+=this.colorInterpolator1.colorSlope.r,this.colorInterpolator1.startColor.g+=this.colorInterpolator1.colorSlope.g,this.colorInterpolator1.startColor.b+=this.colorInterpolator1.colorSlope.b,this.colorInterpolator3.startColor.r+=this.colorInterpolator3.colorSlope.r,this.colorInterpolator3.startColor.g+=this.colorInterpolator3.colorSlope.g,this.colorInterpolator3.startColor.b+=this.colorInterpolator3.colorSlope.b,c+=l,h+=a}}}e.GouraudShadingTriangleRasterizer=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ColorInterpolator=void 0;const i=r(7);e.ColorInterpolator=class{constructor(){this.startColor=new i.Color,this.colorSlope=new i.Color}setup(t,e,r){this.colorSlope.r=(e.r-t.r)/r,this.colorSlope.g=(e.g-t.g)/r,this.colorSlope.b=(e.b-t.b)/r,this.startColor.r=t.r,this.startColor.g=t.g,this.startColor.b=t.b}advance(){this.startColor.r+=this.colorSlope.r,this.startColor.g+=this.colorSlope.g,this.startColor.b+=this.colorSlope.b}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TexturedAlphaBlendingTriangleRasterizer=void 0;const i=r(1);e.TexturedAlphaBlendingTriangleRasterizer=class{constructor(t,e){this.framebuffer=t,this.pipeline=e,this.temp=null}drawTriangleDDA(t,e,r){if(t.position.y>r.position.y&&(this.temp=t,t=r,r=this.temp),t.position.y>e.position.y&&(this.temp=t,t=e,e=this.temp),e.position.y>r.position.y&&(this.temp=e,e=r,r=this.temp),t.position.y!==r.position.y){if((r.position.x-t.position.x)*(e.position.y-t.position.y)/(r.position.y-t.position.y)+t.position.x>e.position.x)this.fillLongRightTriangle2(t,e,r);else{const o=t.textureCoordinate,n=e.textureCoordinate,s=r.textureCoordinate;this.fillLongLeftTriangle2(t.position,e.position,r.position,new i.Vector3f(o.u,o.v,0),new i.Vector3f(n.u,n.v,0),new i.Vector3f(s.u,s.v,0))}}}fillLongRightTriangle2(t,e,r){let i=e.position.y-t.position.y;const o=r.position.y-t.position.y;let n=(e.position.x-t.position.x)/i;const s=(r.position.x-t.position.x)/o;let a=(e.textureCoordinate.u/e.position.z-t.textureCoordinate.u/t.position.z)/i;const l=(r.textureCoordinate.u/r.position.z-t.textureCoordinate.u/t.position.z)/o;let c=(e.textureCoordinate.v/e.position.z-t.textureCoordinate.v/t.position.z)/i;const h=(r.textureCoordinate.v/r.position.z-t.textureCoordinate.v/t.position.z)/o;let u=(1/e.position.z-1/t.position.z)/i;const f=(1/r.position.z-1/t.position.z)/o;let d=1/t.position.z,p=1/t.position.z,m=t.textureCoordinate.u/t.position.z,x=t.textureCoordinate.v/t.position.z,M=t.textureCoordinate.u/t.position.z,w=t.textureCoordinate.v/t.position.z,b=t.position.x,g=t.position.x,y=t.position.y;for(let t=0;t<i;t++){const t=Math.round(g)-Math.round(b);let e=320*Math.round(y)+Math.round(b);const r=(p-d)/t,i=(M-m)/t,o=(w-x)/t;let T=d,v=m,P=x;for(let n=0;n<t;n++){const t=this.framebuffer.framebuffer[e];if(T<this.framebuffer.wBuffer[e]){this.framebuffer.wBuffer[e]=T;const r=1/T,i=0|Math.max(Math.min(v*r*this.framebuffer.bob.width,this.framebuffer.bob.width-1),0),o=0|Math.max(Math.min(P*r*this.framebuffer.bob.height,this.framebuffer.bob.height-1),0),n=this.framebuffer.bob.texture[i+o*this.framebuffer.bob.width],s=this.pipeline.alpha*(n>>24&255)/255,a=1-s,l=(t>>0&255)*a+(n>>0&255)*s,c=(t>>8&255)*a+(n>>8&255)*s,h=(t>>16&255)*a+(n>>16&255)*s;this.framebuffer.framebuffer[e]=l|c<<8|h<<16|255<<24}e++,T+=r,v+=i,P+=o}b+=n,g+=s,y++,d+=u,p+=f,m+=a,M+=l,x+=c,w+=h}if(i=r.position.y-e.position.y,0!==i){n=(r.position.x-e.position.x)/i,u=(1/r.position.z-1/e.position.z)/i,a=(r.textureCoordinate.u/r.position.z-e.textureCoordinate.u/e.position.z)/i,c=(r.textureCoordinate.v/r.position.z-e.textureCoordinate.v/e.position.z)/i,d=1/e.position.z,m=e.textureCoordinate.u/e.position.z,x=e.textureCoordinate.v/e.position.z,b=e.position.x,y=e.position.y;for(let t=0;t<i;t++){const t=Math.round(g)-Math.round(b);let e=320*Math.round(y)+Math.round(b);const r=(p-d)/t,i=(M-m)/t,o=(w-x)/t;let T=d,v=m,P=x;for(let n=0;n<t;n++){if(T<this.framebuffer.wBuffer[e]){this.framebuffer.wBuffer[e]=T;const t=1/T,r=0|Math.max(Math.min(v*t*this.framebuffer.bob.width,this.framebuffer.bob.width-1),0),i=0|Math.max(Math.min(P*t*this.framebuffer.bob.height,this.framebuffer.bob.height-1),0),o=this.framebuffer.bob.texture[r+i*this.framebuffer.bob.width],n=this.pipeline.alpha*(o>>24&255)/255,s=1-n,a=(this.framebuffer.framebuffer[e]>>0&255)*s+(o>>0&255)*n,l=(this.framebuffer.framebuffer[e]>>8&255)*s+(o>>8&255)*n,c=(this.framebuffer.framebuffer[e]>>16&255)*s+(o>>16&255)*n;this.framebuffer.framebuffer[e]=a|l<<8|c<<16|255<<24}e++,T+=r,v+=i,P+=o}b+=n,g+=s,y++,d+=u,p+=f,m+=a,M+=l,x+=c,w+=h}}}fillLongLeftTriangle2(t,e,r,i,o,n){let s=e.y-t.y;const a=r.y-t.y;let l=(e.x-t.x)/s;const c=(r.x-t.x)/a,h=(n.x/r.z-i.x/t.z)/a;let u=(o.x/e.z-i.x/t.z)/s;const f=(n.y/r.z-i.y/t.z)/a;let d=(o.y/e.z-i.y/t.z)/s,p=(1/e.z-1/t.z)/s;const m=(1/r.z-1/t.z)/a;let x=t.x,M=t.x,w=1/t.z,b=1/t.z,g=i.x/t.z,y=i.y/t.z,T=i.x/t.z,v=i.y/t.z,P=t.x,S=t.x,C=t.y;for(let t=0;t<s;t++){const t=Math.round(S)-Math.round(P);let e=320*Math.round(C)+Math.round(P);const r=(b-w)/t,i=(T-g)/t,o=(v-y)/t;let n=w,s=g,a=y;for(let l=0;l<t;l++){if(n<this.framebuffer.wBuffer[e]){this.framebuffer.wBuffer[e]=n;const t=1/n,r=0|Math.max(Math.min(s*t*this.framebuffer.bob.width,this.framebuffer.bob.width-1),0),i=0|Math.max(Math.min(a*t*this.framebuffer.bob.height,this.framebuffer.bob.height-1),0),o=this.framebuffer.bob.texture[r+i*this.framebuffer.bob.width],l=this.pipeline.alpha*(o>>24&255)/255,c=1-l,h=(this.framebuffer.framebuffer[e]>>0&255)*c+(o>>0&255)*l,u=(this.framebuffer.framebuffer[e]>>8&255)*c+(o>>8&255)*l,f=(this.framebuffer.framebuffer[e]>>16&255)*c+(o>>16&255)*l;this.framebuffer.framebuffer[e]=h|u<<8|f<<16|255<<24}e++,n+=r,s+=i,a+=o}P+=c,S+=l,C++,x+=c,M+=l,w+=m,b+=p,g+=h,T+=u,y+=f,v+=d}s=r.y-e.y,l=(r.x-e.x)/s,p=(1/r.z-1/e.z)/s,u=(n.x/r.z-o.x/e.z)/s,d=(n.y/r.z-o.y/e.z)/s,M=e.x,b=1/e.z,T=o.x/e.z,v=o.y/e.z,S=e.x,C=e.y;for(let t=0;t<s;t++){const t=Math.round(S)-Math.round(P);let e=320*Math.round(C)+Math.round(P);const r=(b-w)/t,i=(T-g)/t,o=(v-y)/t;let n=w,s=g,a=y;for(let l=0;l<t;l++){if(n<this.framebuffer.wBuffer[e]){this.framebuffer.wBuffer[e]=n;const t=1/n,r=0|Math.max(Math.min(s*t*this.framebuffer.bob.width,this.framebuffer.bob.width-1),0),i=0|Math.max(Math.min(a*t*this.framebuffer.bob.height,this.framebuffer.bob.height-1),0),o=this.framebuffer.bob.texture[r+i*this.framebuffer.bob.width],l=this.pipeline.alpha*(o>>24&255)/255,c=1-l,h=(this.framebuffer.framebuffer[e]>>0&255)*c+(o>>0&255)*l,u=(this.framebuffer.framebuffer[e]>>8&255)*c+(o>>8&255)*l,f=(this.framebuffer.framebuffer[e]>>16&255)*c+(o>>16&255)*l;this.framebuffer.framebuffer[e]=h|u<<8|f<<16|255<<24}e++,n+=r,s+=i,a+=o}P+=c,S+=l,C++,x+=c,M+=l,w+=m,b+=p,g+=h,T+=u,y+=f,v+=d}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CohenSutherlandLineClipper=void 0;const i=r(2),o=r(1);let n=(()=>{class t{constructor(t){this.framebuffer=t}cohenSutherlandLineClipper(e,r,n){let s=new o.Vector3f(e.x,e.y,e.z),a=new o.Vector3f(r.x,r.y,r.z),l=this.computeRegionCode(s),c=this.computeRegionCode(a),h=!1,u=!1;for(;!u;)if(this.isTrivialAccept(l,c))h=!0,u=!0;else if(this.isTrivialReject(l,c))u=!0;else{if(l===t.REGION_CODE_CENTER){const t=l;l=c,c=t;const e=s;s=a,a=e}(l&t.REGION_CODE_TOP)!==t.REGION_CODE_CENTER?(s.x=s.x+(a.x-s.x)*(i.Framebuffer.maxWindow.y-s.y)/(a.y-s.y),s.y=i.Framebuffer.maxWindow.y):(l&t.REGION_CODE_BOTTOM)!==t.REGION_CODE_CENTER?(s.x=s.x+(a.x-s.x)*(i.Framebuffer.minWindow.y-s.y)/(a.y-s.y),s.y=i.Framebuffer.minWindow.y):(l&t.REGION_CODE_RIGHT)!==t.REGION_CODE_CENTER?(s.y=s.y+(a.y-s.y)*(i.Framebuffer.maxWindow.x-s.x)/(a.x-s.x),s.x=i.Framebuffer.maxWindow.x):(l&t.REGION_CODE_LEFT)!==t.REGION_CODE_CENTER&&(s.y=s.y+(a.y-s.y)*(i.Framebuffer.minWindow.x-s.x)/(a.x-s.x),s.x=i.Framebuffer.minWindow.x),l=this.computeRegionCode(s)}h&&this.framebuffer.drawLineDDA(s,a,n)}isTrivialAccept(e,r){return(e|r)===t.REGION_CODE_CENTER}isTrivialReject(e,r){return(e&r)!==t.REGION_CODE_CENTER}computeRegionCode(e){let r=t.REGION_CODE_CENTER;return e.x<i.Framebuffer.minWindow.x?r|=t.REGION_CODE_LEFT:e.x>i.Framebuffer.maxWindow.x&&(r|=t.REGION_CODE_RIGHT),e.y<i.Framebuffer.minWindow.y?r|=t.REGION_CODE_BOTTOM:e.y>i.Framebuffer.maxWindow.y&&(r|=t.REGION_CODE_TOP),r}}return t.REGION_CODE_CENTER=0,t.REGION_CODE_LEFT=1,t.REGION_CODE_RIGHT=2,t.REGION_CODE_BOTTOM=4,t.REGION_CODE_TOP=8,t})();e.CohenSutherlandLineClipper=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FullscreenUtils=void 0;let i=(()=>{class t{static toggleFullscreen(e){this.fullscreen?(t.exitFullscreen(),this.fullscreen=!1):(t.enterFullscreen(e),this.fullscreen=!0)}static enterFullscreen(t){t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen?t.msRequestFullscreen():t.webkitRequestFullScreen&&t.webkitRequestFullScreen()}static exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}}return t.fullscreen=!1,t})();e.FullscreenUtils=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(9);Object.defineProperty(e,"Texture",{enumerable:!0,get:function(){return i.Texture}});var o=r(21);Object.defineProperty(e,"TextureUtils",{enumerable:!0,get:function(){return o.TextureUtils}})},function(t,e,r){"use strict";r.r(e),e.default=r.p+"7ac69aefeb77efddca4311160ba48eb9.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BlenderLoader=void 0;const i=r(46);e.BlenderLoader=class{static load(t){return fetch(t.default).then(t=>t.json()).then(t=>i.BlenderJsonParser.parse(t))}static loadWithTexture(t){return fetch(t.default).then(t=>t.json()).then(t=>i.BlenderJsonParser.getBlenderScene(t,!1))}constructor(){}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ComputationalGeometryUtils=void 0;const i=r(0),o=r(47);e.ComputationalGeometryUtils=class{computeBoundingSphere(t){if(0===t.length)throw new Error("More than one vertex required.");if(1===t.length)return new o.Sphere(t[0],0);let e=new i.Vector4f(0,0,0,0),r=0;return t.forEach(t=>{e=e.add(new i.Vector4f(t.x,t.y,t.z,0))}),e=e.mul(1/t.length),t.forEach(t=>{r=Math.max(r,e.sub(t).length())}),new o.Sphere(e,r)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BlenderJsonParser=void 0;const i=r(0),o=r(3),n=r(45);e.BlenderJsonParser=class{static parse(t,e=!1){const r=[];return t.forEach(t=>{const o=new Array,n=new Array;t.vertices.forEach(t=>{o.push(new i.Vector4f(t.x,t.y,t.z).mul(2))}),t.normals.forEach(t=>{n.push(e?new i.Vector4f(t.x,t.y,t.z).normalize().mul(-1):new i.Vector4f(t.x,t.y,t.z).normalize())});const s=[];t.faces.forEach(t=>{s.push({n1:t.normals[0],n2:t.normals[1],n3:t.normals[2],v1:t.vertices[0],v2:t.vertices[1],v3:t.vertices[2]})});const a={faces:s,normals:n,points:o,transformedNormals:n.map(()=>new i.Vector4f(0,0,0,0)),transformedPoints:o.map(()=>new i.Vector4f(0,0,0,0))};r.push(a)}),r}static getBlenderScene(t,e=!0,r=!1){const s=[];return t.forEach(t=>{const r=new Array,a=new Array;let l;t.uv&&(l=[],t.uv.forEach(t=>{const e=new o.TextureCoordinate;e.u=t.u,e.v=1-t.v,l.push(e)})),t.vertices.forEach(t=>{e?r.push(new i.Vector4f(t.x,t.y,t.z).mul(2).add(new i.Vector4f(0,-2.7,0,0))):r.push(new i.Vector4f(t.x,t.y,t.z).mul(2))}),t.normals.forEach(t=>{a.push(new i.Vector4f(t.x,t.y,t.z))});const c=(new n.ComputationalGeometryUtils).computeBoundingSphere(r);c.getCenter().w=1;const h={points:r,normals:a,uv:l,faces:t.faces,points2:r.map(()=>new i.Vector4f(0,0,0,0)),normals2:a.map(()=>new i.Vector4f(0,0,0,0)),boundingSphere:c,name:t.name};s.push(h)}),s}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sphere=void 0;e.Sphere=class{constructor(t,e){this.center=t,this.radius=e}isInsidePositiveHalfSpace(t){return t.getNormal().dot(this.center)-t.getDistance()>-this.radius}getTran(t){return t.multiplyHom(this.center)}getRadius(){return this.radius}getCenter(){return this.center}}},function(t,e,r){"use strict";r.r(e),e.default=r.p+"1940711ae250abc4871bf563f44ab585.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"aa2528d7a8a813247c2d2b90b028e437.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StreamReader=void 0;e.StreamReader=class{constructor(t,e=0){this.dataView=new DataView(t,e),this.position=0}readInt(){const t=this.dataView.getInt32(this.position,!0);return this.position+=4,t}readFloat(){const t=this.dataView.getFloat32(this.position,!0);return this.position+=4,t}readUnsignedInt8(){const t=this.dataView.getUint8(this.position);return this.position+=1,t}readSignedShort(){const t=this.dataView.getInt16(this.position,!0);return this.position+=2,t}readUnsigbnedShort(){const t=this.dataView.getUint16(this.position,!0);return this.position+=2,t}}},function(t,e,r){"use strict";r.r(e),e.default=r.p+"5211260c15f95de001ff416d5a098ceb.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FontRenderer=void 0;const i=r(42);e.FontRenderer=class{constructor(t,e,r,i,o){this.framebuffer=t,this.width=e,this.height=r,this.file=o,this.charToIndex=new Map;for(let t=0;t<i.length;t++)this.addCharInex(i.charCodeAt(t),t)}init(){return Promise.all([i.TextureUtils.load(this.file,!0).then(t=>this.fontTexture=t)])}draw(){this.framebuffer.drawTextureRectFastAlpha(0,0,0,0,50,50,this.fontTexture)}drawText2(t,e,r){let i=t;const o=this.fontTexture.width/this.width;for(let t=0;t<r.length;t++){const n=r.charCodeAt(t),s=this.charToIndex.has(n)?this.charToIndex.get(n):0,a=Math.floor(s%o)*this.width,l=Math.floor(s/o)*this.height;this.framebuffer.drawTextureRectFastAlpha(i,e,a,l,this.width,this.height,this.fontTexture),i+=this.width}}drawText(t,e,r,i,o=!0){let n=t;const s=this.fontTexture.width/this.width,a=Math.floor(.07*i)%this.width,l=Math.floor(.07*i/this.width)%r.length;n-=a;for(let t=0;t<Math.floor(320/this.width+1);t++){const a=r.charCodeAt((t+l)%r.length),c=this.charToIndex.has(a)?this.charToIndex.get(a):0,h=Math.floor(c%s)*this.width,u=Math.floor(c/s)*this.height;this.drawTextureRectFastAlpha(n,e,h,u,this.width,this.height,this.fontTexture,i,o),n+=this.width}}drawTextureRectFastAlpha(t,e,r,i,o,n,s,a,l=!0){const c=Math.max(0,0-t),h=Math.min(t+o,320)-t;for(let o=c;o<h;o++){const c=l?Math.round(30*Math.sin(.004*a+.013*(t+o))):0;let h=r+o+i*s.width,u=t+o+320*(e+c);for(let t=0;t<n;t++){const t=s.texture[h];4278190080&t&&(this.framebuffer.framebuffer[u]=t),h+=s.width,u+=320}}}addCharInex(t,e){this.charToIndex.set(t,e)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ModelViewMatrix=void 0;const i=r(0);e.ModelViewMatrix=class{constructor(){this.currtentMatrix=new i.Matrix4f,this.tempMatrix=new i.Matrix4f,this.temp=new i.Matrix4f,this.transformation=new i.Matrix4f}getMatrix(){return this.currtentMatrix}setIdentity(){this.currtentMatrix.setIdentityMatrix()}multMatrix(t){this.currtentMatrix=this.currtentMatrix.multiplyMatrix(t)}trans(t,e,r){this.transformation.setTranslationMatrix(t,e,r),this.applyMat()}scal(t,e,r){this.transformation.setScaleMatrix(t,e,r),this.applyMat()}xRotate(t){this.transformation.setXRotationMatrix(t),this.applyMat()}yRotate(t){this.transformation.setYRotationMatrix(t),this.applyMat()}applyMat(){this.tempMatrix.multiply2(this.currtentMatrix,this.transformation),this.temp=this.currtentMatrix,this.currtentMatrix=this.tempMatrix,this.tempMatrix=this.temp}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Cube=void 0;const i=r(4),o=r(22);class n extends o.AbstractGeometricObject{constructor(){super();const t=.5,e=[new i.Vector4f(-t,-t,-t),new i.Vector4f(t,-t,-t),new i.Vector4f(t,t,-t),new i.Vector4f(-t,t,-t),new i.Vector4f(-t,-t,t),new i.Vector4f(t,-t,t),new i.Vector4f(t,t,t),new i.Vector4f(-t,t,t)];this.buildMesh(e,[0,2,1,0,3,2,5,7,4,5,6,7,1,6,5,1,2,6,4,3,0,4,7,3,4,1,5,4,0,1,3,6,2,3,7,6])}}e.Cube=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MD2Animation=void 0;let i=(()=>{class t{constructor(t,e,r){this.first=t,this.last=e,this.fps=r}}return t.STAND=new t(0,39,9),t.RUN=new t(40,45,10),t.ATTACK=new t(46,53,10),t.PAIN_A=new t(54,57,7),t.PAIN_B=new t(58,61,7),t.PAIN_C=new t(62,65,7),t.JUMP=new t(66,71,7),t.FLIP=new t(72,83,7),t.SALUTE=new t(84,94,7),t.FALLBACK=new t(95,111,10),t.WAVE=new t(112,122,7),t.POINTING=new t(123,134,6),t.CROUCH_STAND=new t(135,153,10),t.CROUCH_WALK=new t(154,159,7),t.CROUCH_ATTACK=new t(160,168,10),t.CROUCH_PAIN=new t(196,172,7),t.CROUCH_DEATH=new t(173,177,5),t.DEATH_FALLBACK=new t(178,183,7),t.DEATH_FALLFORWARD=new t(184,189,7),t.DEATH_FALLBACKSLOW=new t(190,197,7),t.BOOM=new t(198,198,5),t})();e.MD2Animation=i},function(t,e,r){"use strict";r.r(e),e.default=r.p+"3906531fedff1b81f85f5f9415a1e956.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TexturedMesh=void 0;e.TexturedMesh=class{}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MD2Loader=void 0;const i=r(66),o=r(68),n=r(69),s=r(70),a=r(71),l=r(72),c=r(50);class h{static load(t){return fetch(t.default).then(t=>t.arrayBuffer()).then(t=>{try{return h.parse(t)}catch(t){console.error(t.message)}})}static parse(t){const e=h.getHeader(t);return new n.MD2Model(h.getTextureCoords(t,e),h.getTriangles(t,e),h.getFrames(t,e),e)}static getHeader(t){return new o.MD2Header(t)}static getSkins(t,e){const r=new Array;for(let i=0;i<e.numberOfSkins;i++){const o=new s.MD2Skin(t,e.skinsOffset+64*i);r.push(o)}return r}static getTextureCoords(t,e){const r=new Array,i=new c.StreamReader(t,e.texCoordsOffset);for(let t=0;t<e.numberOfTexCoords;t++)r.push(new a.MD2TexCoord(i,e));return r}static getTriangles(t,e){const r=new Array,i=new c.StreamReader(t,e.triangleOffset);for(let t=0;t<e.numberOfTriangles;t++)r.push(new l.MD2Triangle(i));return r}static getFrames(t,e){const r=new Array;for(let o=0;o<e.numberOfFrames;o++){const n=new i.MD2Frame(t,e.framesOffset+e.frameSize*o,e);r.push(n)}return r}constructor(){}}e.MD2Loader=h},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InvalidFileFormatException=void 0;e.InvalidFileFormatException=class{constructor(t){this.message=t}}},function(t,e,r){"use strict";r.r(e),e.default=r.p+"3274091b249fafeb95e835d056a0fb34.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"d3a35822a59e861527f48d3949879d6c.jsx"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BasicCamera=void 0;const i=r(0);e.BasicCamera=class{constructor(t,e,r,i){this.position=t,this.yaw=e,this.pitch=r,this.roll=i}getViewMatrix(){const t=i.Matrix4f.constructZRotationMatrix(-this.roll),e=i.Matrix4f.constructXRotationMatrix(-this.pitch),r=i.Matrix4f.constructYRotationMatrix(-this.yaw),o=i.Matrix4f.constructTranslationMatrix(-this.position.x,-this.position.y,-this.position.z);return t.multiplyMatrix(e).multiplyMatrix(r).multiplyMatrix(o)}getPosition(){return this.position}}},function(t,e,r){"use strict";r.r(e),e.default=r.p+"83fbf02619944d02f165a5fa0c7b9203.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"1c679046e546d12399509394f8258610.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WavefrontLoader=void 0;const i=r(46),o=r(81);e.WavefrontLoader=class{static load(t){return fetch(t.default).then(t=>t.text()).then(t=>o.convertToMeshArray(t)).then(t=>i.BlenderJsonParser.parse(t))}static loadWithTexture(t){return fetch(t.default).then(t=>t.text()).then(t=>o.convertToMeshArray(t)).then(t=>i.BlenderJsonParser.getBlenderScene(t))}constructor(){}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MD2Frame=void 0;const i=r(0),o=r(67),n=r(50);e.MD2Frame=class{constructor(t,e=0,r){const s=new n.StreamReader(t,e),a=new i.Vector3f(s.readFloat(),s.readFloat(),s.readFloat());this.scale=a;const l=new i.Vector3f(s.readFloat(),s.readFloat(),s.readFloat());this.translate=l;const c=new n.StreamReader(t,e+40),h=new Array;for(let t=0;t<r.numberOfVertices;t++){const t=c.readUnsignedInt8(),e=c.readUnsignedInt8(),r=c.readUnsignedInt8(),n=c.readUnsignedInt8();h.push(new o.MD2Vertex(new i.Vector3f(t*a.x+l.x,e*a.y+l.y,r*a.z+l.z),n))}this.vertices=h}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MD2Vertex=void 0;e.MD2Vertex=class{constructor(t,e){this.vector=t,this.normalIndex=e}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MD2Header=void 0;const i=r(59),o=r(50);let n=(()=>{class t{constructor(t){if(!this.isValidMD2File(t))throw new i.InvalidFileFormatException("Not a valid MD2 file.");const e=new o.StreamReader(t);this.identifier=e.readInt(),this.version=e.readInt(),this.skinWidth=e.readInt(),this.skinHeight=e.readInt(),this.frameSize=e.readInt(),this.numberOfSkins=e.readInt(),this.numberOfVertices=e.readInt(),this.numberOfTexCoords=e.readInt(),this.numberOfTriangles=e.readInt(),this.numberOfGlCommands=e.readInt(),this.numberOfFrames=e.readInt(),this.skinsOffset=e.readInt(),this.texCoordsOffset=e.readInt(),this.triangleOffset=e.readInt(),this.framesOffset=e.readInt(),this.glCommandsOffset=e.readInt(),this.endOffset=e.readInt()}toString(){return JSON.stringify(this,null,2)}isValidMD2File(e){const r=new DataView(e,0),i=r.getInt32(0,!0),o=r.getInt32(4,!0);return i===t.IDP2&&o===t.VERSION}}return t.IDP2=844121161,t.VERSION=8,t})();e.MD2Header=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MD2Model=void 0;const i=r(0),o=r(57),n=r(3),s=r(55);e.MD2Model=class{constructor(t,e,r,a){this.textureCoordinates=t,this.triangles=e,this.frames=r,this.header=a,this.animation=s.MD2Animation.STAND,this.currentFrame=0,this.loop=!1;const l=new o.TexturedMesh,c=new Array;this.textureCoordinates.forEach(t=>{c.push(new n.TextureCoordinate(t.s,t.t))});const h=new Array;for(let t=0;t<a.numberOfVertices;t++)h.push(new i.Vector4f(0,0,0,1));this.points=h,l.points=h,l.points2=h.map(()=>new i.Vector4f(0,0,0,0)),l.uv=c;const u=new Array;this.triangles.forEach(t=>{u.push({uv:t.texCoords,vertices:t.vertices})}),l.faces=u,this.mesh=l}getMesh(){const t=.006*Date.now(),e=Math.floor(t)%this.frames.length,r=(e+1)%this.frames.length,i=this.frames[e],o=this.frames[r],n=t-Math.floor(t),s=1-n;for(let t=0;t<i.vertices.length;t++){const e=i.vertices[t],r=o.vertices[t];this.points[t].x=e.vector.x*s+r.vector.x*n,this.points[t].y=e.vector.y*s+r.vector.y*n,this.points[t].z=e.vector.z*s+r.vector.z*n}return this.mesh}setAnim(t,e,r=!1){this.animation=t,this.currentFrame=0,this.loop=r}getMesh2(t){this.currentFrame+=.009*t,this.currentFrame>this.animation.last-this.animation.first&&(this.loop||(this.currentFrame=this.animation.last-this.animation.first));const e=this.animation.last-this.animation.first+1,r=Math.floor(this.currentFrame)%e,i=(r+1)%e,o=this.frames[r+this.animation.first],n=this.frames[i+this.animation.first],s=this.currentFrame-Math.floor(this.currentFrame),a=1-s;for(let t=0;t<o.vertices.length;t++){const e=o.vertices[t],r=n.vertices[t];this.points[t].x=e.vector.x*a+r.vector.x*s,this.points[t].y=e.vector.y*a+r.vector.y*s,this.points[t].z=e.vector.z*a+r.vector.z*s}return this.mesh}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MD2Skin=void 0;const i=r(50);e.MD2Skin=class{constructor(t,e=0){const r=new i.StreamReader(t,e);let o;for(let t=0;t<64;t++){const t=r.readUnsignedInt8();if(0===t)break;o+=String.fromCharCode(t)}this.name=o}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MD2TexCoord=void 0;e.MD2TexCoord=class{constructor(t,e){this.s=t.readSignedShort()/(e.skinWidth-1),this.t=t.readSignedShort()/(e.skinHeight-1)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MD2Triangle=void 0;e.MD2Triangle=class{constructor(t){this.vertices=[t.readUnsigbnedShort(),t.readUnsigbnedShort(),t.readUnsigbnedShort()],this.texCoords=[t.readUnsigbnedShort(),t.readUnsigbnedShort(),t.readUnsigbnedShort()]}}},function(t,e,r){"use strict";r.r(e),e.default=r.p+"29fc676286325d45f7deef5e593b6da6.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"fe1ca8bac15e02a2d14cf9d558c69def.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"780c7edd8a9410b8261fdb12d9d6191d.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"c83bb5502d841707edd4423f41ebcca0.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"8f18731da1a9e273cf0432f3b1c862f1.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"5cf778e15448cf90b764416629d74108.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Plane=void 0;e.Plane=class{constructor(t,e){this.normal=t,this.distance=e}getNormal(){return this.normal}getDistance(){return this.distance}isInside(t){return t.dot(this.normal)>=this.distance}computeIntersection(t,e){const r=t.dot(this.normal),i=e.dot(this.normal),o=(this.distance-r)/(i-r);return e.sub(t).mul(o).add(t)}}},function(t,e,r){"use strict";r.r(e),e.default=r.p+"dd142c00e8f6db275d9ecc2bda063c04.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.convertToMeshArray=void 0;const i=r(82),o=r(83),n=r(84),s=r(85);e.convertToMeshArray=function(t){const e=new Array;let r=null,a=0,l=0,c=0,h=0,u=0,f=0;return t.toString().split("\n").forEach(t=>{if(t.startsWith("o ")){const o=t.split(" ");r=new i.Mesh,r.name=o[1],r.normals=[],r.vertices=[],r.faces=[],r.uv=[],e.push(r),h=a,u=l,f=c}if(null===r&&(t.startsWith("v ")||t.startsWith("vn ")||t.startsWith("vt ")))throw console.error("Error: OBJ file does not contain Objects."),Error();if(t.startsWith("v ")){const e=t.split(" "),i=new o.Vector(Number.parseFloat(e[1]),Number.parseFloat(e[2]),Number.parseFloat(e[3]));r.vertices.push(i),l++}if(t.startsWith("vn ")){const e=t.split(" "),i=new o.Vector(Number.parseFloat(e[1]),Number.parseFloat(e[2]),Number.parseFloat(e[3]));r.normals.push(i),a++}if(t.startsWith("vt ")){const e=t.split(" "),i=new n.TexCoord(Number.parseFloat(e[1]),Number.parseFloat(e[2]));r.uv.push(i),c++}if(t.startsWith("f ")){const e=t.split(" "),i=new s.Face;i.vertices=[],i.normals=[],i.uv=[],i.vertices.push(Number(e[1].split("/")[0])-1-u),i.vertices.push(Number(e[2].split("/")[0])-1-u),i.vertices.push(Number(e[3].split("/")[0])-1-u),i.uv.push(Number(e[1].split("/")[1])-1-f),i.uv.push(Number(e[2].split("/")[1])-1-f),i.uv.push(Number(e[3].split("/")[1])-1-f),i.normals.push(Number(e[1].split("/")[2])-1-h),i.normals.push(Number(e[2].split("/")[2])-1-h),i.normals.push(Number(e[3].split("/")[2])-1-h),r.faces.push(i)}}),e}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Mesh=void 0;e.Mesh=class{}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vector=void 0;e.Vector=class{constructor(t,e,r){this.x=t,this.y=e,this.z=r}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TexCoord=void 0;e.TexCoord=class{constructor(t,e){this.u=t,this.v=e}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Face=void 0;e.Face=class{}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Keyboard=void 0;let i=(()=>{class t{constructor(){this.pressed=new Array(256),this.pressed.fill(!1),window.addEventListener("keyup",t=>this.onKeyUp(t),!1),window.addEventListener("keydown",t=>this.onKeyDown(t),!1)}isDown(t){return this.pressed[t]}onKeyDown(t){this.pressed[t.keyCode]=!0}onKeyUp(t){this.pressed[t.keyCode]=!1}}return t.LEFT=37,t.UP=38,t.RIGHT=39,t.DOWN=40,t.KEY_A=65,t.KEY_D=68,t.KEY_L=76,t})();e.Keyboard=i},function(t,e,r){"use strict";r.r(e),e.default=r.p+"f47283da3b866a2856a596bdf1eec1dc.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"f0a2b83a6650a874e43584817f97e82b.md2"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SkyBox=void 0;const i=r(0),o=r(42),n=r(3);e.SkyBox=class{init(){return Promise.all([o.TextureUtils.load(r(73),!1).then(t=>this.back=t),o.TextureUtils.load(r(74),!1).then(t=>this.down=t),o.TextureUtils.load(r(75),!1).then(t=>this.front=t),o.TextureUtils.load(r(76),!1).then(t=>this.left=t),o.TextureUtils.load(r(77),!1).then(t=>this.right=t),o.TextureUtils.load(r(78),!1).then(t=>this.up=t)])}draw(t,e){this.drawSkyBox(t,e.getRotation())}drawSkyBox(t,e){const r=[this.back,this.left,this.front,this.right];let o,s,a;const l=[new i.Vector4f(1,1,-1,1),new i.Vector4f(-1,1,-1,1),new i.Vector4f(-1,-1,-1,1),new i.Vector4f(1,1,-1,1),new i.Vector4f(-1,-1,-1,1),new i.Vector4f(1,-1,-1,1)];for(let c=0;c<4;c++)o=e.multiplyMatrix(i.Matrix4f.constructXRotationMatrix(Math.PI).multiplyMatrix(i.Matrix4f.constructYRotationMatrix(2*+Math.PI/4*c))),s=o.multiplyMatrix(i.Matrix4f.constructScaleMatrix(20,20,20)),a={normals:[],normals2:[],points:l,points2:l.map(t=>new i.Vector4f(0,0,0)),uv:[new n.TextureCoordinate(1,1),new n.TextureCoordinate(0,1),new n.TextureCoordinate(0,0),new n.TextureCoordinate(1,1),new n.TextureCoordinate(0,0),new n.TextureCoordinate(1,0)],faces:[{vertices:[0,1,2],uv:[0,1,2]},{vertices:[3,4,5],uv:[3,4,5]}]},t.setTexture(r[c]),t.texturedRenderingPipeline.setModelViewMatrix(s),t.texturedRenderingPipeline.draw(a);o=e.multiplyMatrix(i.Matrix4f.constructXRotationMatrix(Math.PI)).multiplyMatrix(i.Matrix4f.constructYRotationMatrix(0).multiplyMatrix(i.Matrix4f.constructYRotationMatrix(2*Math.PI/4*1).multiplyMatrix(i.Matrix4f.constructXRotationMatrix(2*-Math.PI/4)))),s=o.multiplyMatrix(i.Matrix4f.constructScaleMatrix(20,20,20)),a={normals:[],normals2:[],points:l,points2:l.map(t=>new i.Vector4f(0,0,0)),uv:[new n.TextureCoordinate(0,0),new n.TextureCoordinate(1,0),new n.TextureCoordinate(1,1),new n.TextureCoordinate(0,0),new n.TextureCoordinate(1,1),new n.TextureCoordinate(0,1)],faces:[{vertices:[0,1,2],uv:[0,1,2]},{vertices:[3,4,5],uv:[3,4,5]}]},t.setTexture(this.up),t.texturedRenderingPipeline.setModelViewMatrix(s),t.texturedRenderingPipeline.draw(a),o=e.multiplyMatrix(i.Matrix4f.constructXRotationMatrix(Math.PI)).multiplyMatrix(i.Matrix4f.constructYRotationMatrix(0).multiplyMatrix(i.Matrix4f.constructYRotationMatrix(2*Math.PI/2).multiplyMatrix(i.Matrix4f.constructXRotationMatrix(2*Math.PI/4)))),s=o.multiplyMatrix(i.Matrix4f.constructScaleMatrix(20,20,20)),a={normals:[],normals2:[],points:l,points2:l.map(t=>new i.Vector4f(0,0,0)),uv:[new n.TextureCoordinate(1,1),new n.TextureCoordinate(0,1),new n.TextureCoordinate(0,0),new n.TextureCoordinate(1,1),new n.TextureCoordinate(0,0),new n.TextureCoordinate(1,0)],faces:[{vertices:[0,1,2],uv:[0,1,2]},{vertices:[3,4,5],uv:[3,4,5]}]},t.setTexture(this.down),t.texturedRenderingPipeline.setModelViewMatrix(s),t.texturedRenderingPipeline.draw(a)}}},function(t,e,r){"use strict";r.r(e),e.default=r.p+"fb406c1ce3301d7caf3e86340decfd94.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"0c5693868dfd1dffcc2d62dff38726f0.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(62);Object.defineProperty(e,"BasicCamera",{enumerable:!0,get:function(){return i.BasicCamera}});var o=r(103);Object.defineProperty(e,"ControllableCamera",{enumerable:!0,get:function(){return o.ControllableCamera}})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FrustumCuller=void 0;const i=r(0),o=r(79);e.FrustumCuller=class{constructor(){this.planes=new Array;for(let t=0;t<4;t++)this.planes.push(new o.Plane(new i.Vector4f(0,0,0,0),0));this.pos=new i.Vector4f(0,0,0,0),this.normals=[];const t=[new i.Vector4f(-80,-50,292),new i.Vector4f(80,-50,292),new i.Vector4f(80,50,292),new i.Vector4f(-80,50,292)];for(let e=0;e<t.length;e++){const r=t[e].cross(t[(e+1)%t.length]).normalize().mul(-1);this.normals.push(r)}}updateFrustum(t,e){const r=t.getInverseRotation();r.multiplyHomArr(this.normals[0],this.planes[0].normal),r.multiplyHomArr(this.normals[1],this.planes[1].normal),r.multiplyHomArr(this.normals[2],this.planes[2].normal),r.multiplyHomArr(this.normals[3],this.planes[3].normal),this.pos.x=-e.x,this.pos.y=-e.y,this.pos.z=-e.z,this.planes[0].distance=-this.planes[0].normal.dot(this.pos),this.planes[1].distance=-this.planes[1].normal.dot(this.pos),this.planes[2].distance=-this.planes[2].normal.dot(this.pos),this.planes[3].distance=-this.planes[3].normal.dot(this.pos)}getPlanes(){return this.planes}isPotentiallyVisible(t){for(let e=0;e<this.planes.length;e++)if(!t.isInsidePositiveHalfSpace(this.planes[e]))return!1;return!0}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TorusKnot=void 0;const i=r(4),o=r(22);class n extends o.AbstractGeometricObject{constructor(t=!1){super();const e=[];for(let t=0;t<80;t++){const r=this.torusFunction3(2*t*Math.PI/80),i=this.torusFunction3(2*t*Math.PI/80+.1),o=i.sub(r);let n=r.add(i).normalize();const s=o.cross(n).normalize().mul(26.4);n=s.cross(o).normalize().mul(26.4);for(let t=0;t<8;t++){const i=n.mul(Math.sin(2*t*Math.PI/8)).add(s.mul(Math.cos(2*t*Math.PI/8))).add(r);e.push(i.mul(1))}}const r=[];for(let t=0;t<80;t++)for(let i=0;i<8;i++)r.push((8*t+(1+i)%8)%e.length),r.push((8*t+(0+i)%8)%e.length),r.push((8*t+8+(1+i)%8)%e.length),r.push((8*t+8+(0+i)%8)%e.length),r.push((8*t+8+(1+i)%8)%e.length),r.push((8*t+(0+i)%8)%e.length);this.buildMesh(e,r,t)}torusFunction3(t){const e=.5*(2+Math.sin(3*t));return new i.Vector4f(e*Math.cos(2*t),e*Math.cos(3*t),e*Math.sin(2*t)).mul(70)}}e.TorusKnot=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LinearFog=void 0;const i=r(0),o=r(117);class n extends o.Fog{constructor(t,e,r){super(),this.zStart=t,this.zEnd=e,this.fogColor=r}computeVertexColor(t,e){if(e.z>=this.zStart)return t;if(e.z<=this.zEnd)return this.fogColor;{const r=(this.zEnd-e.z)/(this.zEnd-this.zStart);return new i.Vector4f(t.x*r+this.fogColor.x*(1-r),t.y*r+this.fogColor.y*(1-r),t.z*r+this.fogColor.z*(1-r))}}}e.LinearFog=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlayerStandingState=void 0;const i=r(55),o=r(127),n=r(97);class s extends n.PlayerState{entry(){this.context.md2.setAnim(i.MD2Animation.STAND,0,!0)}upButton(){this.context.setState(new o.PlayerRunningState(this.context))}}e.PlayerStandingState=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlayerState=void 0;e.PlayerState=class{constructor(t){this.context=t}entry(){}exit(){}process(){}upButton(){}upButtonNot(){}}},function(t,e,r){"use strict";r.r(e),e.default=r.p+"627a342d6eba738cf103d753bf442a3d.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"61fba6f52a703fc3fce172546bd169fa.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"d8003eead60c0dfb90215d469d51d2f3.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"b067dd009dbd8781f1973feed20bb7eb.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"dbfe6f136c603b175357f30c0300be38.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ControllableCamera=void 0;const i=r(62);class o extends i.BasicCamera{constructor(t,e,r,i){super(t,e,r,i)}moveForward(t,e){const r=t*e;this.position.x+=r*-Math.sin(this.yaw),this.position.z+=r*-Math.cos(this.yaw)}moveBackward(t,e){const r=t*e;this.position.x-=r*-Math.sin(this.yaw),this.position.z-=r*-Math.cos(this.yaw)}turnLeft(t,e){const r=t*e;this.yaw+=r}turnRight(t,e){const r=t*e;this.yaw-=r}turnUp(t,e){const r=t*e;this.pitch+=r}turnDown(t,e){const r=t*e;this.pitch-=r}}e.ControllableCamera=o},function(t,e,r){"use strict";r.r(e),e.default=r.p+"be59e5e60b44dcb4bb1ccf2535c21d20.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"35e5d4cac5e7ac4f18616422a728392d.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"5a8653ae080594924b2eb7a2dc743876.jpg"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"190c8de6aade7baacc90bbf521cdd4ba.jsx"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"76ae06b027ad8d3a84d87f9801f62db9.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"8a09527b06eeee9b52984520552f3610.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"59b860b8c26e2787d9a2d2c486ccb637.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Mode7Entity=void 0;e.Mode7Entity=class{constructor(t,e=0,r=0,i=1,o=0){this.position=t,this.height=e,this.priority=r,this.scale=i,this.offset=o}getPriority(){return this.priority}}},function(t,e,r){"use strict";r.r(e),e.default=r.p+"4f11e0c165fc56a4f81fd1340adc9407.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"cb7b144b66415bfbb6f223071a7d23bd.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Polygon=void 0;const i=r(0),o=r(79);e.Polygon=class{constructor(t=null){this.vertices=t}getPlanes(t){const e=new Array,r=new i.Vector4f(t.x,t.y,t.z);for(let t=0;t<this.vertices.length;t++){const i=this.vertices[t].sub(r).cross(this.vertices[(t+1)%this.vertices.length].sub(r)).normalize().mul(-1),n=i.dot(r);e.push(new o.Plane(i,n))}return e}isVisible(){return this.vertices.length>=3}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SutherlandHodgmanClipper=void 0;const i=r(114);e.SutherlandHodgmanClipper=class{static clip(t,e){let r=t.vertices;for(let t=0;t<e.length;t++){const i=e[t],o=r;r=new Array;let n=o[o.length-1];for(let t=0;t<o.length;t++){const e=o[t];i.isInside(e)?(i.isInside(n)||r.push(i.computeIntersection(n,e)),r.push(e)):i.isInside(n)&&r.push(i.computeIntersection(n,e)),n=e}}return new i.Polygon(r)}}},function(t,e,r){"use strict";r.r(e),e.default=r.p+"e8c4e1c3c2b22502a30bcdb0fc317733.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Fog=void 0;e.Fog=class{}},function(t,e,r){"use strict";r.r(e),e.default=r.p+"f2b01e8ebcd0467bc5ee98bd9745c36b.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"ca65f62320a1c5496be703455da5e09a.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"d3132c4de2ae05ba66ad9637600796c5.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"f89a4363cf31e38309b957356c5e8fca.obj"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ThirdPersonCameraScene=void 0;const i=r(123),o=r(7),n=r(8),s=r(124),a=r(0),l=r(57),c=r(29),h=r(18),u=r(21),f=r(3),d=r(86),p=r(58),m=r(53),x=r(125),M=r(126);let w=(()=>{class t extends h.AbstractScene{constructor(){super(...arguments),this.lastTime=Date.now(),this.keyboard=new d.Keyboard,this.gamepad=new s.AisaGamepad,this.modelViewMatrix=new m.ModelViewMatrix,this.fpsStartTime=Date.now(),this.fpsCount=0,this.fps=0,this.player=new x.Player,this.camera=new i.ThirdPersonCamera,this.oldEye=new a.Vector3f(0,0,0),this.attack=!1,this.jump=!1,this.run=!1}init(t){return this.texturedRenderingPipeline=new c.TexturingRenderingPipeline(t),this.texturedRenderingPipeline.setCullFace(n.CullFace.FRONT),this.startTime=Date.now(),Promise.all([u.TextureUtils.load(r(87),!1).then(t=>this.ogroTexture=t),u.TextureUtils.load(r(128),!1).then(t=>this.weaponTexture=t),p.MD2Loader.load(r(88)).then(t=>this.md2=t),p.MD2Loader.load(r(129)).then(t=>this.weapon=t),u.TextureUtils.load(r(49),!0).then(t=>this.texture4=t),,u.TextureUtils.load(r(130),!0).then(t=>this.fontred=t),,u.TextureUtils.load(r(131),!0).then(t=>this.ground=t),u.TextureUtils.load(r(132),!0).then(t=>this.glow=t)])}onInit(){this.playerStateMachine=new M.PlayerStateMachine(this.md2,this.player),window.addEventListener("gamepadconnected",t=>{console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",t.gamepad.index,t.gamepad.id,t.gamepad.buttons.length,t.gamepad.axes.length)});const t=new l.TexturedMesh;t.points=[new a.Vector4f(-20,0,20),new a.Vector4f(20,0,20),new a.Vector4f(20,0,-20),new a.Vector4f(-20,0,-20)],t.uv=[new f.TextureCoordinate(0,0),new f.TextureCoordinate(1,0),new f.TextureCoordinate(1,1),new f.TextureCoordinate(0,1)],t.points2=t.points.map(()=>new a.Vector4f(0,0,0,0)),t.faces=[{uv:[0,1,2],vertices:[0,1,2]},{uv:[2,3,0],vertices:[2,3,0]}],this.floor=t}processInput(t){this.keyboard.isDown(d.Keyboard.UP)&&this.playerStateMachine.upButton(),this.keyboard.isDown(d.Keyboard.UP)||this.playerStateMachine.upButtonNot();(this.keyboard.isDown(d.Keyboard.UP)||this.gamepad.isLeft(1,-1))&&this.player.moveForward(4.1,t),this.gamepad.isLeft(1,-1)&&!this.run&&(this.run=!0),!this.gamepad.isLeft(1,-1)&&this.run&&(this.run=!1),(this.keyboard.isDown(d.Keyboard.DOWN)||this.gamepad.isLeft(1,1))&&this.player.moveBackward(4.1,t),(this.keyboard.isDown(d.Keyboard.LEFT)||this.gamepad.isLeft(0,-1))&&this.player.turnLeft(110,t),(this.keyboard.isDown(d.Keyboard.RIGHT)||this.gamepad.isLeft(0,1))&&this.player.turnRight(110,t),this.gamepad.isButtonPressed(3)&&!this.attack&&(this.attack=!0),!this.gamepad.isButtonPressed(3)&&this.attack&&(this.attack=!1),this.gamepad.isButtonPressed(2)&&!this.jump&&(this.jump=!0),!this.gamepad.isButtonPressed(2)&&this.jump&&(this.jump=!1)}render(e){const r=Date.now(),i=(r-this.lastTime)/1e3;this.lastTime=r,r>this.fpsStartTime+1e3&&(this.fpsStartTime=r,this.fps=this.fpsCount,this.fpsCount=0),this.fpsCount++;Date.now(),this.startTime;this.processInput(i),e.clearColorBuffer(t.CLEAR_COLOR),e.clearDepthBuffer(),e.setTexture(this.ground),this.texturedRenderingPipeline.setCullFace(n.CullFace.BACK),this.computeFloorMovement(i),this.texturedRenderingPipeline.setModelViewMatrix(this.modelViewMatrix.getMatrix()),this.texturedRenderingPipeline.draw(this.floor),this.modelViewMatrix.trans(0,.1,0),this.computeGlowMovement(i,r),e.setTexture(this.glow),this.texturedRenderingPipeline.enableAlphaBlending(),this.texturedRenderingPipeline.setModelViewMatrix(this.modelViewMatrix.getMatrix()),this.texturedRenderingPipeline.draw(this.floor),this.texturedRenderingPipeline.disableAlphaBlending(),this.texturedRenderingPipeline.setCullFace(n.CullFace.FRONT),this.renderPlayer(e,i),e.drawText(8,8,"FPS: "+this.fps.toString(),this.texture4),e.drawText(8,16,"TRIANGELS: "+(this.md2.header.numberOfTriangles+this.weapon.header.numberOfTriangles),this.texture4),r%1e3>500&&e.drawText(8,184,this.gamepad.isAvailable()?"GAMEPAD DETECTED":"NO GAMEPAD DETECTED",this.fontred)}renderPlayer(t,e){this.computePlayerMovement(e),this.texturedRenderingPipeline.setModelViewMatrix(this.modelViewMatrix.getMatrix()),t.setTexture(this.ogroTexture),this.texturedRenderingPipeline.draw(this.md2.getMesh2(1e3*e)),t.setTexture(this.weaponTexture),this.texturedRenderingPipeline.draw(this.weapon.getMesh2(1e3*e))}computeFloorMovement(t){this.modelViewMatrix.setIdentity(),this.modelViewMatrix.multMatrix(this.getCamMatrix(t)),this.modelViewMatrix.trans(0,0,0),this.modelViewMatrix.yRotate(2*Math.PI/360*90)}getCamMatrix(t){const e=.6*t,r=this.oldEye.add(new a.Vector3f(this.player.position.x-5*this.player.getDirection().x,2.2,this.player.position.y-5*this.player.getDirection().y).sub(this.oldEye).mul(e));return this.oldEye=r,this.camera.computeMatrix(r,new a.Vector3f(this.player.position.x,1.8,this.player.position.y),new a.Vector3f(0,1,0))}computePlayerMovement(t){this.modelViewMatrix.setIdentity(),this.modelViewMatrix.multMatrix(this.getCamMatrix(t)),this.modelViewMatrix.trans(this.player.position.x,24*.05,this.player.position.y),this.modelViewMatrix.yRotate(2*Math.PI/360*(90+this.player.angle)),this.modelViewMatrix.xRotate(2*Math.PI/360*-90),this.modelViewMatrix.scal(.05,.05,.05)}computeGlowMovement(t,e){this.modelViewMatrix.setIdentity(),this.modelViewMatrix.multMatrix(this.getCamMatrix(t)),this.modelViewMatrix.trans(this.player.position.x,.03,this.player.position.y);this.modelViewMatrix.scal(.051,.051,.051),this.texturedRenderingPipeline.setAlpha(.7)}}return t.CLEAR_COLOR=o.Color.SLATE_GRAY.toPackedFormat(),t})();e.ThirdPersonCameraScene=w},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ThirdPersonCamera=void 0;const i=r(0);e.ThirdPersonCamera=class{computeMatrix(t,e,r){const o=i.Matrix4f.constructTranslationMatrix(-t.x,-t.y,-t.z),n=t.sub(e).normalize(),s=r.cross(n).normalize(),a=n.cross(s),l=new i.Matrix4f;return l.m11=s.x,l.m12=s.y,l.m13=s.z,l.m14=0,l.m21=a.x,l.m22=a.y,l.m23=a.z,l.m24=0,l.m31=n.x,l.m32=n.y,l.m33=n.z,l.m34=0,l.m41=0,l.m42=0,l.m43=0,l.m44=1,l.multiplyMatrix(o)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AisaGamepad=void 0;e.AisaGamepad=class{constructor(){this.gamepad=null,window.addEventListener("gamepadconnected",t=>{console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",t.gamepad.index,t.gamepad.id,t.gamepad.buttons.length,t.gamepad.axes.length),this.gamepad=t.gamepad})}isAvailable(){return null!==this.gamepad}isButtonPressed(t){return!!this.gamepad&&this.gamepad.buttons[t].pressed}isLeft(t,e){return!!this.gamepad&&this.gamepad.axes[t]===e}vl(){return this.gamepad.id}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Player=void 0;const i=r(0);e.Player=class{constructor(){this.position=new i.Vector2f(0,0),this.angle=0}moveForward(t,e){const r=t*e;this.position.x+=r*-Math.sin(2*Math.PI/360*this.angle),this.position.y+=r*-Math.cos(2*Math.PI/360*this.angle)}moveBackward(t,e){const r=t*e;this.position.x-=r*-Math.sin(2*Math.PI/360*this.angle),this.position.y-=r*-Math.cos(2*Math.PI/360*this.angle)}getDirection(){return new i.Vector2f(-Math.sin(2*Math.PI/360*this.angle),-Math.cos(2*Math.PI/360*this.angle))}turnLeft(t,e){const r=t*e;this.angle+=r}turnRight(t,e){const r=t*e;this.angle-=r}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlayerStateMachine=void 0;const i=r(96);e.PlayerStateMachine=class{constructor(t,e){this.pl=e,this.activeState=null,this.md2=t,this.setState(new i.PlayerStandingState(this))}upButton(){this.activeState.upButton()}upButtonNot(){this.activeState.upButtonNot()}setState(t){null!==this.activeState&&this.activeState.exit(),this.activeState=t,this.activeState.entry(),console.log(t)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlayerRunningState=void 0;const i=r(55),o=r(96),n=r(97);class s extends n.PlayerState{entry(){this.context.md2.setAnim(i.MD2Animation.RUN,0,!0)}upButtonNot(){this.context.setState(new o.PlayerStandingState(this.context))}}e.PlayerRunningState=s},function(t,e,r){"use strict";r.r(e),e.default=r.p+"167c00bfa49bddd5ecd044f4a2c2bac7.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"608c064515c98e1fd2d9f3f95fcb5f9c.md2"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"d12a4a13883e26a714cdb57bcff314f4.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"2b2983e86d6555fefb86e2beabb55feb.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"deadf21897808097d293d4f228b97c00.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractCube=void 0;const i=r(8),o=r(19),n=r(20),s=r(18),a=r(9),l=r(21),c=r(44);class h extends s.AbstractScene{constructor(){super(...arguments),this.accumulationBuffer=new Uint32Array(64e3)}init(t){return this.renderingPipeline=new n.FlatShadingRenderingPipeline(t),this.renderingPipeline.setCullFace(i.CullFace.BACK),Promise.all([c.BlenderLoader.load(r(134)).then(t=>this.scene=t),l.TextureUtils.load(r(43),!1).then(t=>this.blurred=t),l.TextureUtils.generateProceduralNoise().then(t=>this.noise=t)])}render(t,e){t.fastFramebufferCopy(t.framebuffer,this.blurred.texture),this.drawBlenderScene2(t,e);const r=new a.Texture(this.accumulationBuffer,320,200);t.drawTexture(0,0,r,.75),t.fastFramebufferCopy(this.accumulationBuffer,t.framebuffer),t.noise(e,this.noise)}drawBlenderScene2(t,e){t.clearDepthBuffer();const r=o.Matrix4f.constructTranslationMatrix(0,0,-12).multiplyMatrix(o.Matrix4f.constructYRotationMatrix(2e-4*e).multiplyMatrix(o.Matrix4f.constructXRotationMatrix(2e-4*e)));let i=r.multiplyMatrix(o.Matrix4f.constructScaleMatrix(5,16,5)),n=this.scene[0];this.renderingPipeline.draw(n,i),i=r.multiplyMatrix(o.Matrix4f.constructZRotationMatrix(.5*Math.PI*t.cosineInterpolate(0,600,Math.floor(.7*e)%4e3)).multiplyMatrix(o.Matrix4f.constructXRotationMatrix(.5*Math.PI*t.cosineInterpolate(2e3,2600,Math.floor(.7*e)%4e3)))),n=this.scene[1],this.renderingPipeline.draw(n,i)}}e.AbstractCube=h},function(t,e,r){"use strict";r.r(e),e.default=r.p+"cdc0b80877df29ca96d4a05162fc8a1a.jsx"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BakedLighting=void 0;const i=r(8),o=r(19),n=r(18),s=r(89),a=r(9),l=r(21),c=r(44);class h extends n.AbstractScene{constructor(){super(...arguments),this.accumulationBuffer=new Uint32Array(64e3)}init(t){return t.setCullFace(i.CullFace.BACK),this.skyBox=new s.SkyBox,Promise.all([this.skyBox.init(),c.BlenderLoader.loadWithTexture(r(136)).then(t=>this.blenderObj8=t),l.TextureUtils.load(r(98),!1).then(t=>this.baked=t),l.TextureUtils.generateProceduralNoise().then(t=>this.noise=t)])}render(t){const e=Date.now();this.drawBlenderScene7(t,e-11e5);const r=new a.Texture(this.accumulationBuffer,320,200);t.drawTexture(0,0,r,.75),t.fastFramebufferCopy(this.accumulationBuffer,t.framebuffer),t.noise(e,this.noise)}drawBlenderScene7(t,e){e*=.2,t.clearDepthBuffer();const r=o.Matrix4f.constructTranslationMatrix(0,0,17*(.5*Math.sin(7e-5*e)+.5)-134).multiplyMatrix(o.Matrix4f.constructXRotationMatrix(6e-4*e).multiplyMatrix(o.Matrix4f.constructYRotationMatrix(5e-4*-e).multiplyMatrix(o.Matrix4f.constructTranslationMatrix(0,-25,0)))).multiplyMatrix(o.Matrix4f.constructScaleMatrix(13,13,13));this.skyBox.draw(t,r),t.clearDepthBuffer(),t.setTexture(this.baked),t.texturedRenderingPipeline.setModelViewMatrix(r),t.texturedRenderingPipeline.drawMeshArray(this.blenderObj8)}}e.BakedLighting=h},function(t,e,r){"use strict";r.r(e),e.default=r.p+"c0190c8ec953bd7420ee373319a3f0c1.jsx"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BlockFade=void 0;const i=r(28),o=r(18),n=r(42);class s extends o.AbstractScene{constructor(){super(...arguments),this.startTime=Date.now()}init(t){return Promise.all([n.TextureUtils.load(r(48),!1).then(t=>this.ledTexture=t)])}render(t){const e=Date.now()-this.startTime;this.blockFace(t,this.ledTexture,e,0)}blockFace(t,e,r,o){const n=new Array(160),s=new i.default;s.setSeed(366);for(let t=0;t<10;t++)for(let e=0;e<16;e++)n[e+16*t]=500+Math.round(6e5*s.getFloat())%1e4;t.clear();for(let i=0;i<10;i++)for(let s=0;s<16;s++)t.drawTextureRect(20*s,20*i,20*s,20*i,20,20,e,t.interpolate(o+n[s+16*i],o+n[s+16*i]+700,r))}}e.BlockFade=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Bobs=void 0;const i=r(18),o=r(21);class n extends i.AbstractScene{init(t){return Promise.all([o.TextureUtils.load(r(48),!1).then(t=>this.texture5=t),o.TextureUtils.load(r(99),!0).then(t=>this.texture7=t)])}render(t){t.fastFramebufferCopy(t.framebuffer,this.texture5.texture),this.drawBobs(t,this.texture7,Date.now())}drawBobs(t,e,r){const i=.2*r;for(let r=0;r<30;r++){const o=152*Math.cos(3*i*.002+.11*r)|0,n=92*Math.sin(4*i*.002+.11*r)|0;t.drawTextureNoClipAlpha(152+o,92+n,e)}}}e.Bobs=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BumpMap=void 0;const i=r(18),o=r(9),n=r(21);class s extends i.AbstractScene{constructor(){super(...arguments),this.normals=Array(64e3)}init(t){this.phong=new o.Texture(new Uint32Array(65536),256,256);for(let t=0;t<255;t++)for(let e=0;e<255;e++){const r=(t-128)/128,i=(e-128)/128;let o=1-Math.sqrt(r*r+i*i);o<0&&(o=0);const n=255&Math.round(255*o);this.phong.texture[t+256*e]=n|n<<8|n<<16|255<<24}return Promise.all([n.TextureUtils.load(r(140),!1).then(t=>this.map=t),n.TextureUtils.load(r(141),!1).then(t=>this.bump=t)])}onInit(){let t=0;for(let e=0;e<200;e++)for(let r=0;r<320;r++){const i=(255&this.bump.getPixel3(this.bump,r-1,e))-(255&this.bump.getPixel3(this.bump,r+1,e)),o=(255&this.bump.getPixel3(this.bump,r,e-1))-(255&this.bump.getPixel3(this.bump,r,e+1));this.normals[t++]=[i,o]}}render(t){const e=Date.now();t.fastFramebufferCopy(t.framebuffer,this.bump.texture);let r=0;const i=160*-Math.sin(2*e*8e-4)-160,o=100*-Math.sin(3*e*8e-4)-100;for(let e=0;e<200;e++)for(let n=0;n<320;n++){const s=n+i,a=e+o,l=this.normals[r],c=-l[0]-s+128|0,h=-l[1]-a+128|0,u=this.phong.getPixel2(this.phong,Math.max(0,Math.min(c,255)),Math.max(0,Math.min(h,255))),f=Math.min(80+(255&u),255)/255,d=this.map.texture[r],p=d>>0&255,m=d>>8&255,x=d>>16&255;t.framebuffer[r++]=Math.round(p*f)|Math.round(m*f)<<8|Math.round(x*f)<<16|255<<24}}}e.BumpMap=s},function(t,e,r){"use strict";r.r(e),e.default=r.p+"f07125dd4d9001872d18278db85623a4.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"cea0bca78f8deb1e570693b1c99ee713.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BunnyScene=void 0;const i=r(8),o=r(0),n=r(19),s=r(20),a=r(18),l=r(24),c=r(27),h=r(21),u=r(44);class f extends a.AbstractScene{init(t){return this.renderingPipeline=new s.FlatShadingRenderingPipeline(t),this.renderingPipeline.setCullFace(i.CullFace.BACK),this.renderingPipeline.setLights(this.constructSceneLights()),this.renderingPipeline.setMaterial(this.constructSceneMaterial()),Promise.all([u.BlenderLoader.load(r(143)).then(t=>this.scene=t),h.TextureUtils.load(r(43),!1).then(t=>this.blurred=t),h.TextureUtils.generateProceduralNoise().then(t=>this.noise=t)])}render(t){const e=Date.now();t.fastFramebufferCopy(t.framebuffer,this.blurred.texture),this.drawBlenderScene2(t,e),t.noise(e,this.noise)}drawBlenderScene2(t,e){t.clearDepthBuffer();const r=n.Matrix4f.constructTranslationMatrix(0,0,-4).multiplyMatrix(n.Matrix4f.constructYRotationMatrix(9e-4*e).multiplyMatrix(n.Matrix4f.constructXRotationMatrix(9e-4*e)).multiplyMatrix(n.Matrix4f.constructTranslationMatrix(0,-2,0))).multiplyMatrix(n.Matrix4f.constructScaleMatrix(10,10,10)),i=this.scene[0];this.renderingPipeline.draw(i,r)}constructSceneLights(){const t=new l.PointLight;t.ambientIntensity=new o.Vector4f(1,1,1,1),t.diffuseIntensity=new o.Vector4f(.9,.5,.6,1),t.specularIntensity=new o.Vector4f(.4,.4,.4,1),t.position=new o.Vector4f(1,0,-2,1);const e=new l.PointLight;return e.ambientIntensity=new o.Vector4f(0,0,1,1),e.diffuseIntensity=new o.Vector4f(0,.6,1,1),e.specularIntensity=new o.Vector4f(.4,.4,.4,1),e.position=new o.Vector4f(4,-4,-1,1),[t,e]}constructSceneMaterial(){const t=new c.Material;return t.ambientColor=new o.Vector4f(.12,.14,.1,0),t.diffuseColor=new o.Vector4f(.38,.4,.4,1),t.specularColor=new o.Vector4f(.8,.5,.5,0),t.shininess=2,t}}e.BunnyScene=f},function(t,e,r){"use strict";r.r(e),e.default=r.p+"bb60b96e879ef3aa2c75b59400f7a35c.jsx"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CinematicScroller=void 0;const i=r(18),o=r(21);class n extends i.AbstractScene{init(t){return Promise.all([o.TextureUtils.load(r(100),!1).then(t=>this.ledTexture=t),o.TextureUtils.load(r(49),!0).then(t=>this.texture4=t)])}render(t){const e=Date.now();t.fastFramebufferCopy(t.framebuffer,this.ledTexture.texture),this.cinematicScroller(t,this.texture4,e-14e4)}floodFill(t,e,r){const i=Math.floor(.02*r)%200;let o=64e3;for(let r=0;r<i;r++)for(let r=0;r<320;r++)t.framebuffer[o]=e.texture[o],o--;let n=o;for(let r=0;r<200-i;r++){for(let r=0;r<320;r++)t.framebuffer[o]=e.texture[n],o--,n--;n+=320}}cinematicScroller(t,e,r){const i=["","","","","","","","","","","","","","","","","","","","","","","","","","YOU HAVE BEEN WATCHING","","D A R K   M A T T E R","","A JAVASCRIPT DEMO MADE FOR","NORDLICHT 2018","","CREDITS","","CODE BY","TRIGGER","","GRAFICS BY","PREMIUM","","MUSIC BY","VIRGILL"];r*=.6;const o=Math.round(8*t.interpolate(0,250,255&r));for(let n=1;n<25;n++){const s=i[Math.floor(n+r/256)%i.length],a=160-8*s.length/2|0,l=8*n-o;t.drawText(a,l,s,e)}}}e.CinematicScroller=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CubeTunnelScene=void 0;const i=r(7),o=r(8),n=r(54),s=r(19),a=r(28),l=r(20),c=r(18),h=r(0),u=r(27),f=r(24);let d=(()=>{class t extends c.AbstractScene{constructor(){super(...arguments),this.cubeMesh=new n.Cube,this.accumulationBuffer=new Uint32Array(64e3)}init(t){t.setCullFace(o.CullFace.BACK),this.renderingPipeline=new l.FlatShadingRenderingPipeline(t);const e=new f.PointLight;e.ambientIntensity=new h.Vector4f(1,1,1,1),e.diffuseIntensity=new h.Vector4f(1,1,1,1),e.specularIntensity=new h.Vector4f(1,1,1,1),e.position=new h.Vector4f(0,0,-10,1),this.renderingPipeline.setLights([e]);const r=new u.Material;return r.ambientColor=new h.Vector4f(.12,.14,.1,0),r.diffuseColor=new h.Vector4f(.38,.4,.4,1),r.specularColor=new h.Vector4f(.8,.5,.5,0),r.shininess=2,this.renderingPipeline.setMaterial(r),Promise.all([])}render(e){Date.now();e.clearColorBuffer(t.BACKGROUND_COLOR),e.clearDepthBuffer();const r=new a.default;r.setSeed(22);for(let t=0;t<40;t++){const e=.3*r.getFloat()+.2;for(let i=0;i<25;i++){const o=2.3*r.getFloat()+.7+.2*Math.sin(.0044*Date.now()+3*r.getFloat()),n=39*.7,a=s.Matrix4f.constructXRotationMatrix(.2*Math.sin(44e-5*Date.now())).multiplyMatrix(s.Matrix4f.constructYRotationMatrix(.2*Math.sin(4e-4*Date.now())).multiplyMatrix(s.Matrix4f.constructTranslationMatrix(0,0,-20-(.7*t+.002*Date.now())%n+n).multiplyMatrix(s.Matrix4f.constructZRotationMatrix(2*Math.PI/25*i+Date.now()*e*.002+.2*t).multiplyMatrix(s.Matrix4f.constructTranslationMatrix(3,0,0).multiplyMatrix(s.Matrix4f.constructScaleMatrix(o,.5,.5))))));this.renderingPipeline.draw(this.cubeMesh.getMesh(),a)}}}}return t.BACKGROUND_COLOR=i.Color.DARK_GRAY.toPackedFormat(),t})();e.CubeTunnelScene=d},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CubeScene=void 0;const i=r(7),o=r(8),n=r(54),s=r(0),a=r(20),l=r(18);let c=(()=>{class t extends l.AbstractScene{constructor(){super(...arguments),this.cubeMesh=new n.Cube}init(t){return t.setCullFace(o.CullFace.BACK),this.renderingPipeline=new a.FlatShadingRenderingPipeline(t),Promise.all([])}render(e){const r=.02*Date.now();e.clearColorBuffer(t.BACKGROUND_COLOR),e.clearDepthBuffer(),this.renderingPipeline.draw(this.cubeMesh.getMesh(),this.getModelViewMatrix(r))}getModelViewMatrix(t){return s.Matrix4f.constructTranslationMatrix(0,0,-9).multiplyMatrix(s.Matrix4f.constructScaleMatrix(3.2,3.2,3.2).multiplyMatrix(s.Matrix4f.constructYRotationMatrix(.05*t)).multiplyMatrix(s.Matrix4f.constructXRotationMatrix(.08*t)))}}return t.BACKGROUND_COLOR=i.Color.BLACK.toPackedFormat(),t})();e.CubeScene=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DifferentMd2ModelScene=void 0;const i=r(7),o=r(8),n=r(18),s=r(21),a=r(58),l=r(53);let c=(()=>{class t extends n.AbstractScene{constructor(){super(...arguments),this.modelViewMatrix=new l.ModelViewMatrix,this.fpsStartTime=Date.now(),this.fpsCount=0,this.fps=0}init(t){return t.texturedRenderingPipeline.setCullFace(o.CullFace.FRONT),this.startTime=Date.now(),Promise.all([s.TextureUtils.load(r(87),!1).then(t=>this.ogroTexture=t),a.MD2Loader.load(r(88)).then(t=>this.md2=t),s.TextureUtils.load(r(49),!0).then(t=>this.texture4=t)])}render(e){const r=Date.now();r>this.fpsStartTime+1e3&&(this.fpsStartTime=r,this.fps=this.fpsCount,this.fpsCount=0),this.fpsCount++;const i=Date.now()-this.startTime;e.clearColorBuffer(t.CLEAR_COLOR),e.clearDepthBuffer(),this.computeCameraMovement(.6*i),e.setTexture(this.ogroTexture),e.texturedRenderingPipeline.setModelViewMatrix(this.modelViewMatrix.getMatrix()),e.texturedRenderingPipeline.draw(this.md2.getMesh()),e.drawText(8,8,"FPS: "+this.fps.toString(),this.texture4),e.drawText(8,16,"TRIANGELS: "+this.md2.header.numberOfTriangles,this.texture4)}computeCameraMovement(t){this.modelViewMatrix.setIdentity(),this.modelViewMatrix.trans(0,0,87*(.5*Math.sin(7e-4*t)+.5)-120),this.modelViewMatrix.yRotate(.006*-t),this.modelViewMatrix.xRotate(2*Math.PI/360*-90)}}return t.CLEAR_COLOR=i.Color.SLATE_GRAY.toPackedFormat(),t})();e.DifferentMd2ModelScene=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DistortedSphereScene=void 0;const i=r(2),o=r(0),n=r(18),s=r(21),a=r(5),l=r(3),c=r(7);class h extends n.AbstractScene{init(t){return Promise.all([s.TextureUtils.load(r(101),!1).then(t=>this.heightmapSphere=t),s.TextureUtils.load(r(102),!1).then(t=>this.env=t)])}onInit(){this.obj=this.createSphereDistplaced(this.heightmapSphere)}render(t){const e=Date.now();t.setTexture(this.env);const r=.002*e;let i=o.Matrix4f.constructScaleMatrix(3.7,3.7,3.7).multiplyMatrix(o.Matrix4f.constructYRotationMatrix(.35*r).multiplyMatrix(o.Matrix4f.constructXRotationMatrix(.3*r)));i=o.Matrix4f.constructTranslationMatrix(-0,-0,-10-6*(.5*Math.sin(.3*r)+.5)).multiplyMatrix(i),t.clearDepthBuffer(),t.clearColorBuffer(c.Color.BLACK.toPackedFormat()),this.shadingSphereEnvDisp2(t,2e-4*e,i)}createSphere(){const t=[new o.Vector4f(0,-1,0),new o.Vector4f(1,0,0),new o.Vector4f(0,0,1),new o.Vector4f(-1,0,0),new o.Vector4f(0,0,-1),new o.Vector4f(0,1,0)],e=this.divideSphere(t,[0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1],4),r=[],i=[],n=[],s=[],a=[];return e.index.forEach(t=>{const i=e.points[t],o=r.find(t=>t.sub(i).length()<.001);if(o){const t=r.indexOf(o);a.push(t)}else a.push(r.push(i)-1)}),r.forEach(t=>{n.push(new o.Vector4f(0,0,0)),s.push(new o.Vector4f(0,0,0)),i.push(new o.Vector4f(0,0,0))}),{points:r,points2:i,normals:n,normals2:s,index:a}}divideSphere(t,e,r){const i=[],o=[],n=[];let s=0;for(let r=0;r<e.length;r+=3){const a=t[e[r]],l=t[e[r+1]],c=t[e[r+2]],h=l.sub(a).mul(.5).add(a).normalize(),u=c.sub(l).mul(.5).add(l).normalize(),f=a.sub(c).mul(.5).add(c).normalize();i.push(a),i.push(h),i.push(f),o.push(a),o.push(h),o.push(f),n.push(s++),n.push(s++),n.push(s++),i.push(h),i.push(l),i.push(u),o.push(h),o.push(l),o.push(u),n.push(s++),n.push(s++),n.push(s++),i.push(h),i.push(u),i.push(f),o.push(h),o.push(u),o.push(f),n.push(s++),n.push(s++),n.push(s++),i.push(f),i.push(u),i.push(c),o.push(f),o.push(u),o.push(c),n.push(s++),n.push(s++),n.push(s++)}return r>0?this.divideSphere(i,n,--r):{points:i,normals:o,index:n}}createSphereDistplaced(t){const e=this.createSphere(),r=new Array;return e.points.forEach(e=>{const i=e.x,o=e.y,n=e.z,s=Math.floor(255*(.5+Math.atan2(n,i)/(2*Math.PI))),a=Math.floor(255*(.5-Math.asin(o)/Math.PI)),l=1+(255&t.texture[s+256*a])/255*1.4;r.push(e.mul(l))}),e.points=r,e}shadingSphereEnvDisp2(t,e,r){const n=this.obj;Math.sin(1.8*e);for(let t=0;t<n.points.length;t++){const r=n.points[t].z,i=n.points[t].x,o=Math.sqrt(i*i+r*r);let s=4.5*Math.sin(.539*n.points[t].y+.05*(10-o)+.9*e);s*=.5*Math.sin(.25*e)+.5,n.points2[t].y=n.points[t].y,n.points2[t].x=n.points[t].x*Math.cos(s)-n.points[t].z*Math.sin(s),n.points2[t].z=n.points[t].x*Math.sin(s)+n.points[t].z*Math.cos(s),n.normals[t].x=0,n.normals[t].y=0,n.normals[t].z=0}const s=n.points2,c=n.index,h=n.normals;new o.Vector4f(0,0,0),new o.Vector4f(0,0,0),new o.Vector4f(0,0,0);for(let t=0;t<c.length;t+=3){const e=s[c[t]],r=s[c[t+1]],i=s[c[t+2]],o=r.sub(e).cross(i.sub(e));h[c[t]]=h[c[t]].add(o),h[c[t+1]]=h[c[t+1]].add(o),h[c[t+2]]=h[c[t+2]].add(o)}for(let t=0;t<h.length;t++)h[t]=h[t].normalize();const u=n.points2,f=n.normals2,d=r.computeNormalMatrix();for(let t=0;t<h.length;t++)d.multiplyHomArr(h[t],f[t]);for(let t=0;t<s.length;t++){const e=r.multiplyHom(s[t]);u[t].x=Math.round(160+e.x/(.0078*-e.z)),u[t].y=Math.round(100-e.y/(.0078*-e.z)),u[t].z=e.z}const p=new a.Vertex;p.textureCoordinate=new l.TextureCoordinate;const m=new a.Vertex;m.textureCoordinate=new l.TextureCoordinate;const x=new a.Vertex;x.textureCoordinate=new l.TextureCoordinate;const M=new Array(p,m,x);for(let e=0;e<c.length;e+=3){const r=u[c[e]],o=f[c[e]],n=u[c[e+1]],s=f[c[e+1]],a=u[c[e+2]],l=f[c[e+2]];if(t.isTriangleCCW(r,n,a)){M[0].position=r,t.fakeSphere(o,p),M[1].position=n,t.fakeSphere(s,m),M[2].position=a,t.fakeSphere(l,x),r.x<i.Framebuffer.minWindow.x||n.x<i.Framebuffer.minWindow.x||a.x<i.Framebuffer.minWindow.x||r.x>i.Framebuffer.maxWindow.x||n.x>i.Framebuffer.maxWindow.x||a.x>i.Framebuffer.maxWindow.x||r.y<i.Framebuffer.minWindow.y||n.y<i.Framebuffer.minWindow.y||a.y<i.Framebuffer.minWindow.y||r.y>i.Framebuffer.maxWindow.y||n.y>i.Framebuffer.maxWindow.y||a.y>i.Framebuffer.maxWindow.y?t.texturedRenderingPipeline.clipConvexPolygon2(M):t.texturedTriangleRasterizer.drawTriangleDDA(M[0],M[1],M[2])}}}}e.DistortedSphereScene=h},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DofBallsScene=void 0;const i=r(19),o=r(1),n=r(18),s=r(9),a=r(21);class l extends n.AbstractScene{constructor(){super(...arguments),this.accumulationBuffer=new Uint32Array(64e3)}init(t){return this.start=Date.now(),Promise.all([a.TextureUtils.load(r(43),!1).then(t=>this.blurred=t),a.TextureUtils.load(r(150),!0).then(t=>this.particleTexture2=t),a.TextureUtils.generateProceduralNoise().then(t=>this.noise=t)])}render(t){const e=Date.now()-this.start;t.fastFramebufferCopy(t.framebuffer,this.blurred.texture),this.drawParticleTorus(t,e,this.particleTexture2,!0);const r=new s.Texture(this.accumulationBuffer,320,200);t.drawTexture(0,0,r,.6),t.fastFramebufferCopy(this.accumulationBuffer,t.framebuffer),t.noise(e,this.noise)}computeDepthBlur(t,e,r,i){let o;return o=i>e?(i-e)/(t-e):(i-e)/(r-e),Math.min(o,1)}drawParticleTorus(t,e,r,n=!1){n||t.clearColorBuffer(-13617080),t.clearDepthBuffer();const s=new Array;for(let t=0;t<50;t++){const r=5.2*Math.cos(t*Math.PI*2/50*3.7+.0016*e),i=.4*(t-25),n=5.2*Math.sin(t*Math.PI*2/50*3.7+.0016*e);s.push(new o.Vector3f(r,i,n))}const a=i.Matrix4f.constructTranslationMatrix(0,0,-12).multiplyMatrix(i.Matrix4f.constructYRotationMatrix(4e-4*e).multiplyMatrix(i.Matrix4f.constructXRotationMatrix(4e-4*e))),l=new Array(s.length);s.forEach(e=>{l.push(t.project(a.multiply(e)))}),l.sort((t,e)=>t.z-e.z),l.forEach(e=>{const i=-846.8/e.z,o=Math.round(13*this.computeDepthBlur(0,-15,-70,e.z));t.drawParticle2Sub(e.x-i/2,e.y-i/2,i,i,r,1/e.z,1,o,128)})}}e.DofBallsScene=l},function(t,e,r){"use strict";r.r(e),e.default=r.p+"8cac1eea6b337bec7dab2e78b989f1d7.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FloodFillScene=void 0;const i=r(18),o=r(21);class n extends i.AbstractScene{init(t){return Promise.all([o.TextureUtils.load(r(48),!1).then(t=>this.ledTexture=t)])}render(t){const e=Date.now();this.floodFill(t,this.ledTexture,e)}floodFill(t,e,r){const i=Math.floor(.02*r)%200;let o=64e3;for(let r=0;r<i;r++)for(let r=0;r<320;r++)t.framebuffer[o]=e.texture[o],o--;let n=o;for(let r=0;r<200-i;r++){for(let r=0;r<320;r++)t.framebuffer[o]=e.texture[n],o--,n--;n+=320}}}e.FloodFillScene=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FloorScene=void 0;const i=r(18),o=r(21),n=r(52);class s extends i.AbstractScene{constructor(){super(...arguments),this.startTime=Date.now()}init(t){return this.fontRenderer2=new n.FontRenderer(t,32,32," !\"    '    ,-. 0123456789:; = ? ABCDEFGHIJKLMNOPQRSTUVWXYZ ",r(60)),Promise.all([o.TextureUtils.load(r(90),!1).then(t=>this.heightmap=t),o.TextureUtils.load(r(91),!0).then(t=>this.hoodlumLogo=t),this.fontRenderer2.init()])}render(t){this.drawPlanedeformationTunnel(t,Date.now(),this.heightmap),this.fontRenderer2.drawText(0,152,"              WELCOME TO A NEW RELEASE FROM YOUR FRIENDS IN CRIME! HOW DO YOU LIKE THIS INTRO?",.8*(Date.now()-this.startTime),!1),t.drawTexture(0,100-this.hoodlumLogo.height/2|0,this.hoodlumLogo,1)}drawPlanedeformationTunnel(t,e,r){let i=0;for(let o=0;o<200;o++){const n=o-100,s=((1/Math.abs(n/100*.02)+.069*e)%256+256)%256,a=1-Math.min(1,1/Math.abs(n/10));for(let e=0;e<320;e++){const o=((e-160)/160/Math.abs(n/100*.02)%256+256)%256,l=r.texture[(0|o)+256*(0|s)],c=(l>>0&255)*a|0,h=(l>>8&255)*a|0,u=(l>>16&255)*a|0;t.framebuffer[i++]=c|h<<8|u<<16|255<<24}}}}e.FloorScene=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FrustumCullingScene=void 0;const i=r(154),o=r(155),n=r(156),s=r(93),a=r(8),l=r(0),c=r(28),h=r(20),u=r(18),f=r(44);class d extends u.AbstractScene{init(t){return this.renderingPipeline=new h.FlatShadingRenderingPipeline(t),this.renderingPipeline.setCullFace(a.CullFace.BACK),Promise.all([f.BlenderLoader.load(r(157)).then(t=>this.world=n.BoundingVolumeExpander.expand(t))])}render(t){const e=Date.now();this.drawBlenderScene(t,e-26e4)}drawBlenderScene(t,e,r){t.clearColorBuffer(-13617080),t.clearDepthBuffer();const n=[new o.CameraKeyFrame(new l.Vector3f(-5,3,10),new l.Vector3f(0,0,0)),new o.CameraKeyFrame(new l.Vector3f(5,10,10),new l.Vector3f(0,0,.1)),new o.CameraKeyFrame(new l.Vector3f(5,10,0),new l.Vector3f(1.5,-1,-.2)),new o.CameraKeyFrame(new l.Vector3f(5,3,-10),new l.Vector3f(2.5,0,-.09)),new o.CameraKeyFrame(new l.Vector3f(-5,7,-10),new l.Vector3f(3.5,0,1)),new o.CameraKeyFrame(new l.Vector3f(-5,3,10),new l.Vector3f(4,0,0)),new o.CameraKeyFrame(new l.Vector3f(5,3,-2),new l.Vector3f(3,-.2,0)),new o.CameraKeyFrame(new l.Vector3f(18,2,-0),new l.Vector3f(2,-.4,0)),new o.CameraKeyFrame(new l.Vector3f(15,4,-0),new l.Vector3f(2,-.5,0)),new o.CameraKeyFrame(new l.Vector3f(5,7,-10),new l.Vector3f(2.5,0,-.09))],a=new i.CameraAnimator;a.setKeyFrames(n);const h=a.getViewMatrix(e),u=new s.FrustumCuller;u.updateFrustum(h,a.pos);for(let e=0;e<this.world.length;e++){const r=this.world[e];if(u.isPotentiallyVisible(r[1])){this.renderingPipeline.draw(r[0],h);const e=-16711936;t.drawBoundingSphere(r[1],h,e)}else{const e=-16776961;t.drawBoundingSphere(r[1],h,e)}}if(r){const i=new Array,o=new c.default;o.setSeed(66);for(let t=0;t<640;t++){let t=30*o.getFloat()-15;t+=2*Math.sin(8e-4*e+t);let r=30*o.getFloat()-15;r+=2*Math.sin(9e-4*e+r);let n=30*o.getFloat()-15;n+=2*Math.sin(.0011*e+n),i.push(new l.Vector3f(t,r,n))}const n=new Array(i.length);i.forEach(e=>{const r=t.project(h.multiply(e));n.push(r)}),n.sort((t,e)=>t.z-e.z),n.forEach(e=>{const i=-595.2/e.z;t.drawSoftParticle(Math.round(e.x-.5*i),Math.round(e.y-.5*i),Math.round(i),Math.round(i),r,1/e.z,1)})}t.drawScreenBounds(t)}}e.FrustumCullingScene=d},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CameraAnimator=void 0;const i=r(92),o=r(1);function n(t,e,r){let i;return i=(1-Math.cos(r*Math.PI))/2,t*(1-i)+e*i}function s(t,e,r,i,o){let n,s,a,l,c;return c=o*o,n=i-r-t+e,s=t-e-n,a=r-t,l=e,n*o*c+s*c+a*o+l}e.CameraAnimator=class{setKeyFrames(t){this.keyFrames=t}getViewMatrix(t){const e=(t/5e3|0)%this.keyFrames.length,r=(e-1+this.keyFrames.length)%this.keyFrames.length,a=(e+1)%this.keyFrames.length,l=(e+2)%this.keyFrames.length,c=t/5e3%this.keyFrames.length-e,h=(1-Math.cos(c*Math.PI))/2;let u=new o.Vector3f(n(this.keyFrames[e].position.x,this.keyFrames[a].position.x,c),n(this.keyFrames[e].position.y,this.keyFrames[a].position.y,c),n(this.keyFrames[e].position.z,this.keyFrames[a].position.z,c));u=new o.Vector3f(s(this.keyFrames[r].position.x,this.keyFrames[e].position.x,this.keyFrames[a].position.x,this.keyFrames[l].position.x,c),s(this.keyFrames[r].position.y,this.keyFrames[e].position.y,this.keyFrames[a].position.y,this.keyFrames[l].position.y,c),s(this.keyFrames[r].position.z,this.keyFrames[e].position.z,this.keyFrames[a].position.z,this.keyFrames[l].position.z,c));let f=this.keyFrames[e].rotation.mul(1-h).add(this.keyFrames[a].rotation.mul(h));return f=new o.Vector3f(s(this.keyFrames[r].rotation.x,this.keyFrames[e].rotation.x,this.keyFrames[a].rotation.x,this.keyFrames[l].rotation.x,c),s(this.keyFrames[r].rotation.y,this.keyFrames[e].rotation.y,this.keyFrames[a].rotation.y,this.keyFrames[l].rotation.y,c),s(this.keyFrames[r].rotation.z,this.keyFrames[e].rotation.z,this.keyFrames[a].rotation.z,this.keyFrames[l].rotation.z,c)),this.pos=u,new i.BasicCamera(u,f.x,f.y,f.z).getViewMatrix()}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CameraKeyFrame=void 0;e.CameraKeyFrame=class{constructor(t,e){this.position=t,this.rotation=e}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BoundingVolumeExpander=void 0;const i=r(45);e.BoundingVolumeExpander=class{static expand(t){return t.map(t=>{const e=(new i.ComputationalGeometryUtils).computeBoundingSphere(t.points);return e.getCenter().w=1,[t,e]})}}},function(t,e,r){"use strict";r.r(e),e.default=r.p+"0af02e6a3e89d00a805a509ca9c6c16b.jsx"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Gears2Scene=void 0;const i=r(8),o=r(19),n=r(20),s=r(18),a=r(9),l=r(21),c=r(44);class h extends s.AbstractScene{constructor(){super(...arguments),this.accumulationBuffer=new Uint32Array(64e3)}init(t){return this.renderingPipeline=new n.FlatShadingRenderingPipeline(t),this.renderingPipeline.setCullFace(i.CullFace.FRONT),Promise.all([c.BlenderLoader.load(r(61)).then(t=>this.gearsMesh=t),l.TextureUtils.load(r(43),!1).then(t=>this.blurred=t),l.TextureUtils.generateProceduralNoise().then(t=>this.noise=t)])}render(t){const e=Date.now();t.fastFramebufferCopy(t.framebuffer,this.blurred.texture),this.drawBlenderScene4(t);const r=new a.Texture(this.accumulationBuffer,320,200);t.drawTexture(0,0,r,.75),t.fastFramebufferCopy(this.accumulationBuffer,t.framebuffer),t.noise(e,this.noise)}drawBlenderScene4(t){t.clearDepthBuffer();const e=o.Matrix4f.constructTranslationMatrix(0,0,-14).multiplyMatrix(o.Matrix4f.constructXRotationMatrix(7e-4*Date.now()).multiplyMatrix(o.Matrix4f.constructZRotationMatrix(7e-4*-Date.now()+2*Math.PI/360*13).multiplyMatrix(o.Matrix4f.constructXRotationMatrix(2*Math.PI/360*90)))),r=o.Matrix4f.constructTranslationMatrix(-4.8,0,-14).multiplyMatrix(o.Matrix4f.constructXRotationMatrix(7e-4*Date.now()).multiplyMatrix(o.Matrix4f.constructZRotationMatrix(7e-4*Date.now()).multiplyMatrix(o.Matrix4f.constructXRotationMatrix(2*Math.PI/360*90))));this.renderingPipeline.draw(this.gearsMesh[0],e),this.renderingPipeline.draw(this.gearsMesh[0],r)}}e.Gears2Scene=h},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GearsScene=void 0;const i=r(8),o=r(19),n=r(20),s=r(18),a=r(9),l=r(21),c=r(44);class h extends s.AbstractScene{constructor(){super(...arguments),this.accumulationBuffer=new Uint32Array(64e3)}init(t){return this.renderingPipeline=new n.FlatShadingRenderingPipeline(t),this.renderingPipeline.setCullFace(i.CullFace.FRONT),Promise.all([c.BlenderLoader.load(r(61)).then(t=>this.gearsMesh=t),l.TextureUtils.load(r(43),!1).then(t=>this.blurred=t),l.TextureUtils.generateProceduralNoise().then(t=>this.noise=t)])}render(t){const e=Date.now();t.fastFramebufferCopy(t.framebuffer,this.blurred.texture),this.drawBlenderScene4(t,e);const r=new a.Texture(this.accumulationBuffer,320,200);t.drawTexture(0,0,r,.75),t.fastFramebufferCopy(this.accumulationBuffer,t.framebuffer),t.noise(e,this.noise)}drawBlenderScene4(t,e){t.clearDepthBuffer();const r=o.Matrix4f.constructTranslationMatrix(0,0,-21).multiplyMatrix(o.Matrix4f.constructYRotationMatrix(2e-4*e).multiplyMatrix(o.Matrix4f.constructXRotationMatrix(2e-4*e)));let i=.1*2.1*2.1,n=2.1-.09-.09;const s=.5*Math.sin(1e-5*e)+.5;for(let t=1;t<6;t++){i*=n,n-=.09;const o=this.getModelViewMatrix(r,s,i,t,e);this.renderingPipeline.draw(this.gearsMesh[0],o)}}getModelViewMatrix(t,e,r,i,n){const s=o.Matrix4f.constructXRotationMatrix(6e-4*n+.7*e*(4-i)).multiplyMatrix(o.Matrix4f.constructYRotationMatrix(5e-4*n+.7*e*(4-i)).multiplyMatrix(o.Matrix4f.constructScaleMatrix(r,r,r)));return t.multiplyMatrix(s)}}e.GearsScene=h},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HoodlumScene=void 0;const i=r(8),o=r(0),n=r(28),s=r(18),a=r(42),l=r(44);class c extends s.AbstractScene{constructor(){super(...arguments),this.accumulationBuffer=new Uint32Array(64e3)}init(t){return Promise.all([a.TextureUtils.load(r(43),!1).then(t=>this.blurred=t),l.BlenderLoader.loadWithTexture(r(161)).then(t=>this.spaceLabMesh=t),l.BlenderLoader.load(r(162)).then(t=>this.hoodlumLogoMesh=t),a.TextureUtils.load(r(104),!1).then(t=>this.lab2=t),a.TextureUtils.generateProceduralNoise().then(t=>this.noise=t),this.createProceduralTexture3().then(t=>this.particleTexture2=t)])}render(t){const e=Date.now();t.fastFramebufferCopy(t.framebuffer,this.blurred.texture),t.setCullFace(i.CullFace.BACK),t.setTexture(this.lab2),this.drawBlenderScene9(t,e,this.particleTexture2);const r=new a.Texture(this.accumulationBuffer,320,200);t.drawTexture(0,0,r,.75),t.fastFramebufferCopy(this.accumulationBuffer,t.framebuffer),t.noise(e,this.noise)}drawBlenderScene9(t,e,r){t.clearDepthBuffer();const i=o.Matrix4f.constructTranslationMatrix(0,0,7*(.5*Math.sin(7e-5*e)+.5)-34).multiplyMatrix(o.Matrix4f.constructXRotationMatrix(.5*(.5*Math.sin(14e-5*e)+.5)-.2).multiplyMatrix(o.Matrix4f.constructYRotationMatrix(2e-4*-e).multiplyMatrix(o.Matrix4f.constructTranslationMatrix(0,1.9,0))));let n=i.multiplyMatrix(o.Matrix4f.constructScaleMatrix(13,13,13));t.texturedRenderingPipeline.setModelViewMatrix(n),t.texturedRenderingPipeline.drawMeshArray(this.spaceLabMesh),n=i.multiplyMatrix(o.Matrix4f.constructTranslationMatrix(0,-5.5,0).multiplyMatrix(o.Matrix4f.constructScaleMatrix(413,413,413).multiplyMatrix(o.Matrix4f.constructXRotationMatrix(.5*Math.PI))));const s=this.hoodlumLogoMesh[0];t.renderingPipeline.draw(s,n);const a=new Array;for(let r=0;r<10;r++)for(let i=0;i<6;i++){const n=(r+.001*e)%10*2.5-12,s=(1+4*t.interpolate(-10,10,n))*(.5*(.5*Math.sin(.0012*e+2*Math.PI/10*r*2)+.5)+.5),l=s*Math.sin(2*Math.PI/6*i+8e-4*e),c=s*Math.cos(2*Math.PI/6*i+8e-4*e);a.push(new o.Vector3f(l,n,c))}const l=i.multiplyMatrix(o.Matrix4f.constructTranslationMatrix(0,-0,0)),c=new Array(a.length);a.forEach(e=>{const r=t.project(l.multiply(e));c.push(r)}),c.sort((t,e)=>t.z-e.z),c.forEach(e=>{const i=-4.3*192/e.z;t.drawSoftParticle(Math.round(e.x-i/2),Math.round(e.y-i/2),Math.round(i),Math.round(i),r,1/e.z,.7)})}createProceduralTexture3(){return new Promise(t=>{const e=new a.Texture;e.texture=new Uint32Array(65536),(new n.default).setSeed(100);for(let t=0;t<256;t++)for(let r=0;r<256;r++){const i=127-r,o=127-t,n=Math.sqrt(i*i+o*o)/127;let s=1-n;s*=s*s,n>1&&(s=0),s=Math.min(1,2.9*s),e.texture[r+256*t]=15466475|255*s<<24}e.width=256,e.height=256,t(e)})}}e.HoodlumScene=c},function(t,e,r){"use strict";r.r(e),e.default=r.p+"8eb469a522c3ae4c7819174e340086dd.jsx"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"362cf30681aa40b46d218290191cab6d.jsx"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LedPlasmaScene=void 0;const i=r(1),o=r(18),n=r(21);class s extends o.AbstractScene{init(t){return Promise.all([n.TextureUtils.load(r(105),!1).then(t=>this.ledTexture=t)])}render(t){this.led(t,Date.now(),this.ledTexture)}led(t,e,r){const o=7e-4*e*1,n=new i.Vector3f(Math.sin(o),Math.cos(o),0),s=new i.Vector3f(20,17.5,0).add(new i.Vector3f(20*Math.sin(1.2*-o),17.5*Math.cos(1.2*-o),0)),a=new i.Vector3f(0,0,0);for(let e=0;e<25;e++)for(let i=0;i<40;i++){const l=.5*(Math.sin(.8*(i*n.x+e*n.y)+o)+1);a.x=i-s.x,a.y=e-s.y;const c=(15*(.5*(.5*(Math.cos(.7*a.length())+1)+l))|0)%16;t.drawTextureRectNoAlpha(8*i,8*e,0,8*c,8,8,r)}}}e.LedPlasmaScene=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LensScene=void 0;const i=r(18),o=r(42);class n extends i.AbstractScene{constructor(){super(...arguments),this.lensDiameter=100,this.lensRadius=this.lensDiameter/2,this.width=320,this.height=200,this.lensArrayA=[this.lensDiameter*this.lensDiameter],this.lensArrayB=[this.lensDiameter*this.lensDiameter],this.rightBorder=this.width-this.lensDiameter,this.ballBase=this.height-this.lensDiameter,this.ballX=0,this.ballY=0,this.ballXV=2,this.ballYV=0}init(t){return this.calculateTransformation(20),Promise.all([o.TextureUtils.load(r(48),!1).then(t=>this.textureBackground=t),o.TextureUtils.load(r(165),!0).then(t=>this.textureLens=t)])}render(t,e){t.fastFramebufferCopy(t.framebuffer,this.textureBackground.texture),this.moveWave(e),this.drawLensFast(t,this.textureBackground,this.textureLens)}drawLens(t,e,r){for(let r=-this.lensRadius;r<=this.lensRadius;r++)for(let i=-this.lensRadius;i<=this.lensRadius;i++)if(i*i+r*r<=this.lensRadius*this.lensRadius){const o=Math.round(i+this.ballX),n=Math.round(r+this.ballY),s=1+.03*Math.sqrt(this.lensRadius*this.lensRadius-i*i-r*r),a=Math.round(i/s+this.ballX),l=Math.round(r/s+this.ballY),c=e.texture[a+l*this.width];t.framebuffer[o+n*this.width]=c}t.drawTexture(Math.round(this.ballX-50),Math.round(this.ballY-50),r,1)}drawLensFast(t,e,r){let i=0;for(let r=0;r<this.lensDiameter;r++){const o=this.ballX+(r+this.ballY)*this.width;for(let r=0;r<this.lensDiameter;r++)t.framebuffer[r+o]=e.texture[this.ballX+this.lensArrayA[i]+(this.ballY+this.lensArrayB[i++])*this.width]}t.drawTexture(this.ballX,this.ballY,r,1)}calculateTransformation(t){let e,r;const i=this.lensRadius*this.lensRadius-t*t;for(let o=-this.lensRadius;o<this.lensRadius;o++)for(let n=-this.lensRadius;n<this.lensRadius;n++){if(n*n+o*o>=i)e=n,r=o;else{const i=Math.sqrt(this.lensRadius*this.lensRadius-n*n-o*o);e=Math.floor(n*t/i),r=Math.floor(o*t/i)}const s=(o+this.lensRadius)*this.lensDiameter+(n+this.lensRadius),a=(r+this.lensRadius)*this.lensDiameter+(e+this.lensRadius);this.lensArrayA[s]=Math.floor(a%this.lensDiameter),this.lensArrayB[s]=Math.floor(a/this.lensDiameter)}}moveWave(t){this.ballX=this.width/2+Math.cos(3*t*4e-4)*(this.width/2-this.lensRadius),this.ballY=this.height/2+Math.sin(2*t*4e-4)*(this.height/2-this.lensRadius),this.ballX=Math.floor(this.ballX-this.lensRadius),this.ballY=Math.floor(this.ballY-this.lensRadius)}moveBounce(t){this.ballX+=this.ballXV,(this.ballX<1||this.ballX>this.rightBorder)&&(this.ballXV=-this.ballXV),this.ballY+=this.ballYV,this.ballYV>0&&this.ballY>this.ballBase&&(this.ballY=this.ballBase-(this.ballY-this.ballBase),this.ballYV=-this.ballYV),this.ballYV++}}e.LensScene=n},function(t,e,r){"use strict";r.r(e),e.default=r.p+"de5b12ba36149b2b29c6ccb02c4fedf3.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Md2ModelScene=void 0;const i=r(7),o=r(8),n=r(18),s=r(21),a=r(58),l=r(53);let c=(()=>{class t extends n.AbstractScene{constructor(){super(...arguments),this.modelViewMatrix=new l.ModelViewMatrix,this.fpsStartTime=Date.now(),this.fpsCount=0,this.fps=0}init(t){return t.texturedRenderingPipeline.setCullFace(o.CullFace.FRONT),this.startTime=Date.now(),Promise.all([s.TextureUtils.load(r(106),!1).then(t=>this.ogroTexture=t),a.MD2Loader.load(r(167)).then(t=>this.md2=t),s.TextureUtils.load(r(49),!0).then(t=>this.texture4=t)])}render(e){const r=Date.now();r>this.fpsStartTime+1e3&&(this.fpsStartTime=r,this.fps=this.fpsCount,this.fpsCount=0),this.fpsCount++;const i=Date.now()-this.startTime;e.clearColorBuffer(t.CLEAR_COLOR),e.clearDepthBuffer(),this.computeCameraMovement(.6*i),e.setTexture(this.ogroTexture),e.texturedRenderingPipeline.setModelViewMatrix(this.modelViewMatrix.getMatrix()),e.texturedRenderingPipeline.draw(this.md2.getMesh()),e.drawText(8,8,"FPS: "+this.fps.toString(),this.texture4),e.drawText(8,16,"TRIANGELS: "+this.md2.header.numberOfTriangles,this.texture4)}computeCameraMovement(t){this.modelViewMatrix.setIdentity(),this.modelViewMatrix.trans(0,0,87*(.5*Math.sin(7e-4*t)+.5)-120),this.modelViewMatrix.yRotate(.006*-t),this.modelViewMatrix.xRotate(2*Math.PI/360*-90)}}return t.CLEAR_COLOR=i.Color.SLATE_GRAY.toPackedFormat(),t})();e.Md2ModelScene=c},function(t,e,r){"use strict";r.r(e),e.default=r.p+"b06319803327d678755e45514be6b869.md2"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MetaballsScene=void 0;const i=r(0),o=r(18);class n extends o.AbstractScene{render(t){this.drawMetaballs(t)}drawMetaballs(t){const e=[new i.Vector3f(100*Math.sin(.002*Date.now())+150,70*Math.cos(.0035*Date.now())+100,0),new i.Vector3f(100*Math.sin(.0015*Date.now())+150,70*Math.cos(.002*Date.now())+100,0),new i.Vector3f(100*Math.sin(.003*Date.now())+150,70*Math.cos(.0045*Date.now())+100,0)];let r=0;for(let i=0;i<200;i++)for(let o=0;o<320;o++){let n=0;for(let t=0;t<3;t++){const r=e[t].x-o,s=e[t].y-i;n+=5500/Math.sqrt(r*r+s*s)}t.framebuffer[r++]=255<<24|this.mapColor(n)}}interpolateColor(t,e,r,i,o){const n=this.interpolate(t,e,r);return(i>>0&255)*(1-n)+n*(o>>0&255)|(i>>8&255)*(1-n)+n*(o>>8&255)<<8|(i>>16&255)*(1-n)+n*(o>>16&255)<<16}interpolate(t,e,r){return r<=t?0:r>=e?1:(r-t)/(e-t)}mapColor(t){return t>=235?255:t>=230?this.interpolateColor(230,235,t,65535,255):t>=100?this.interpolateColor(100,230,t,65280,65535):65280}}e.MetaballsScene=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MetalHeadzScene=void 0;const i=r(8),o=r(0),n=r(18),s=r(89),a=r(42),l=r(44);class c extends n.AbstractScene{constructor(){super(...arguments),this.accumulationBuffer=new Uint32Array(64e3)}init(t){return t.setCullFace(i.CullFace.BACK),this.skyBox=new s.SkyBox,Promise.all([this.skyBox.init(),l.BlenderLoader.loadWithTexture(r(107)).then(t=>this.blenderObjMetal=t),a.TextureUtils.load(r(80),!1).then(t=>this.metalheadz=t),a.TextureUtils.load(r(108),!0).then(t=>this.texture11=t),a.TextureUtils.load(r(109),!0).then(t=>this.texture13=t),a.TextureUtils.generateProceduralNoise().then(t=>this.noise=t),a.TextureUtils.load(r(110),!0).then(t=>this.dirt=t)])}render(t,e){const r=.2*e;t.clearDepthBuffer();const i=this.computeCameraMovement(r),n=i.multiplyMatrix(o.Matrix4f.constructScaleMatrix(7,7,7));this.skyBox.draw(t,n),t.clearDepthBuffer(),t.setTexture(this.metalheadz);const s=t.texturedRenderingPipeline;s.setModelViewMatrix(n),s.drawMeshArray(this.blenderObjMetal);const l=t.project(i.getRotation().multiply(new o.Vector3f(22,40,-18)));t.drawLensFlare(l,1.2*r,[{tex:this.texture11,scale:2.3,alpha:.5},{tex:this.texture13,scale:1.6,alpha:.25},{tex:this.texture13,scale:.7,alpha:.22},{tex:this.texture13,scale:-.4,alpha:.22}],this.dirt);const c=new a.Texture(this.accumulationBuffer,320,200);t.drawTexture(0,0,c,.75),t.fastFramebufferCopy(this.accumulationBuffer,t.framebuffer),t.noise(e,this.noise)}computeCameraMovement(t){return o.Matrix4f.constructTranslationMatrix(0,0,17*(.5*Math.sin(7e-5*t)+.5)-134).multiplyMatrix(o.Matrix4f.constructXRotationMatrix(8e-4*t).multiplyMatrix(o.Matrix4f.constructYRotationMatrix(9e-4*-t).multiplyMatrix(o.Matrix4f.constructTranslationMatrix(0,0,0))))}}e.MetalHeadzScene=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Mode7Scene=void 0;const i=r(0),o=r(18),n=r(42),s=r(52),a=r(171),l=r(172),c=r(173),h=r(86),u=r(174),f=r(175),d=r(176),p=r(177);class m extends o.AbstractScene{constructor(){super(...arguments),this.kartPosition=new i.Vector3f(273.79803081006753,1541.4603116539379,0),this.startTime=Date.now(),this.keyboard=new h.Keyboard,this.marioTextures=new Array,this.joshiTextures=new Array,this.spriteRenderer=new p.SpriteRenderer,this.angleVel=0,this.velocity=new i.Vector3f(0,0,0),this.acceleration=0,this.npcTrack=f.NpcTrack.track,this.animator=new c.KartAnimator}onInit(){this.camera=new u.Camera,this.camera.height=80,this.camera.screenDistance=160,this.camera.angle=270,this.camera.position=new i.Vector2f(this.kartPosition.x-153.4*Math.cos(2*Math.PI/360*this.camera.angle),this.kartPosition.y-153.4*Math.sin(2*Math.PI/360*this.camera.angle)),this.mode7Renderer=new u.Mode7Renderer(this.map,this.grass),this.mode7Renderer.setCamera(this.camera),this.pipePositions=new Array;const t=[this.banana,this.bump,this.pipe,this.pipe2,this.flower,this.egg];for(let e=0;e<100;e++){const e=t[Math.floor(Math.random()*t.length)];this.pipePositions.push(new l.Pipe(new i.Vector2f(1024*Math.random(),1024*Math.random()),e,1,0,1.2,e===this.bump?-5:e===this.banana?-3:0))}}init(t){return this.animator.setKeyFrames(this.npcTrack),this.fontRenderer=new s.FontRenderer(t,8,14,"0123456789",r(178)),Promise.all([this.fontRenderer.init(),n.TextureUtils.load(r(179),!1).then(t=>this.map=t),n.TextureUtils.load(r(180),!0).then(t=>this.bump=t),n.TextureUtils.load(r(181),!0).then(t=>this.banana=t),n.TextureUtils.load(r(182),!0).then(t=>this.egg=t),n.TextureUtils.load(r(183),!0).then(t=>this.flower=t),n.TextureUtils.load(r(184),!0).then(t=>this.pipe2=t),n.TextureUtils.load(r(185),!0).then(t=>this.mapHud=t),n.TextureUtils.load(r(186),!1).then(t=>this.back=t),n.TextureUtils.load(r(187),!1).then(t=>this.grass=t),n.TextureUtils.load(r(188),!0).then(t=>this.pipe=t),n.TextureUtils.load(r(189),!0).then(t=>this.lap2Texture=t),n.TextureUtils.load(r(190),!0).then(t=>this.shadowTexture=t),n.TextureUtils.load(r(191),!0).then(t=>this.marioTextures[0]=t),n.TextureUtils.load(r(192),!0).then(t=>this.marioTextures[1]=t),n.TextureUtils.load(r(193),!0).then(t=>this.marioTextures[2]=t),n.TextureUtils.load(r(194),!0).then(t=>this.marioTextures[3]=t),n.TextureUtils.load(r(195),!0).then(t=>this.marioTextures[4]=t),n.TextureUtils.load(r(196),!0).then(t=>this.marioTextures[5]=t),n.TextureUtils.load(r(197),!0).then(t=>this.marioTextures[6]=t),n.TextureUtils.load(r(198),!0).then(t=>this.marioTextures[7]=t),n.TextureUtils.load(r(199),!0).then(t=>this.marioTextures[8]=t),n.TextureUtils.load(r(200),!0).then(t=>this.marioTextures[9]=t),n.TextureUtils.load(r(201),!0).then(t=>this.marioTextures[10]=t),n.TextureUtils.load(r(202),!0).then(t=>this.marioTextures[11]=t),n.TextureUtils.load(r(203),!0).then(t=>this.marioTextures[12]=t),n.TextureUtils.load(r(204),!0).then(t=>this.marioTextures[13]=t),n.TextureUtils.load(r(205),!0).then(t=>this.marioTextures[14]=t),n.TextureUtils.load(r(206),!0).then(t=>this.marioTextures[15]=t),n.TextureUtils.load(r(207),!0).then(t=>this.marioTextures[16]=t),n.TextureUtils.load(r(208),!0).then(t=>this.marioTextures[17]=t),n.TextureUtils.load(r(209),!0).then(t=>this.marioTextures[18]=t),n.TextureUtils.load(r(210),!0).then(t=>this.marioTextures[19]=t),n.TextureUtils.load(r(211),!0).then(t=>this.marioTextures[20]=t),n.TextureUtils.load(r(212),!0).then(t=>this.marioTextures[21]=t),n.TextureUtils.load(r(213),!0).then(t=>this.metrics=t),n.TextureUtils.load(r(214),!0).then(t=>this.joshiTextures[0]=t),n.TextureUtils.load(r(215),!0).then(t=>this.joshiTextures[1]=t),n.TextureUtils.load(r(216),!0).then(t=>this.joshiTextures[2]=t),n.TextureUtils.load(r(217),!0).then(t=>this.joshiTextures[3]=t),n.TextureUtils.load(r(218),!0).then(t=>this.joshiTextures[4]=t),n.TextureUtils.load(r(219),!0).then(t=>this.joshiTextures[5]=t),n.TextureUtils.load(r(220),!0).then(t=>this.joshiTextures[6]=t),n.TextureUtils.load(r(221),!0).then(t=>this.joshiTextures[7]=t),n.TextureUtils.load(r(222),!0).then(t=>this.joshiTextures[8]=t),n.TextureUtils.load(r(223),!0).then(t=>this.joshiTextures[9]=t),n.TextureUtils.load(r(224),!0).then(t=>this.joshiTextures[10]=t),n.TextureUtils.load(r(225),!0).then(t=>this.joshiTextures[11]=t),n.TextureUtils.load(r(226),!0).then(t=>this.joshiTextures[12]=t),n.TextureUtils.load(r(227),!0).then(t=>this.joshiTextures[13]=t),n.TextureUtils.load(r(228),!0).then(t=>this.joshiTextures[14]=t),n.TextureUtils.load(r(229),!0).then(t=>this.joshiTextures[15]=t),n.TextureUtils.load(r(230),!0).then(t=>this.joshiTextures[16]=t),n.TextureUtils.load(r(231),!0).then(t=>this.joshiTextures[17]=t),n.TextureUtils.load(r(232),!0).then(t=>this.joshiTextures[18]=t),n.TextureUtils.load(r(233),!0).then(t=>this.joshiTextures[19]=t),n.TextureUtils.load(r(234),!0).then(t=>this.joshiTextures[20]=t),n.TextureUtils.load(r(235),!0).then(t=>this.joshiTextures[21]=t),n.TextureUtils.load(r(236),!0).then(t=>this.pos=t),n.TextureUtils.load(r(237),!0).then(t=>this.posJoshi=t)])}render(t){this.handleInput(),this.mode7Renderer.render(t),this.drawBackground(t),this.drawMario();const e=this.getNPCs();this.drawMode7Entities(e),this.drawMode7Entities(this.pipePositions),this.spriteRenderer.render(t),this.drawHeadUpDisplay(t),this.drawLapCounter(t),this.drawMinimap(t,e)}drawLapCounter(t){const e=this.camera.getViewDirection().perp().mul(10*Math.sin(.001*(Date.now()-this.startTime))+25),r=new i.Vector2f(.3*this.kartPosition.x,.3*this.kartPosition.y).sub(e),o=new l.Pipe(r,this.lap2Texture);o.height=Math.abs(30*Math.sin(.001*(Date.now()-this.startTime)))+25+Math.abs(40*Math.sin(.002*(Date.now()-this.startTime))),this.drawMode7Entities([new l.Pipe(r,this.shadowTexture,1,1,1,-4)]),this.drawMode7Entities([o])}drawMario(){let t;t=this.keyboard.isDown(68)?this.marioTextures[1]:this.keyboard.isDown(65)?this.marioTextures[this.marioTextures.length-1]:this.marioTextures[0],this.drawMode7Entities([new l.Pipe(new i.Vector2f(.3*this.kartPosition.x,.3*this.kartPosition.y),this.shadowTexture,1,1,1,-4)]);const e=new l.Pipe(new i.Vector2f(.3*this.kartPosition.x,.3*this.kartPosition.y),t,1,0,1,-4);e.height=Math.abs(30*Math.sin(.003*(Date.now()-this.startTime))),this.drawMode7Entities([e])}drawMinimap(t,e){t.drawTexture(2,98,this.mapHud,.5),e.forEach(e=>{const r=Math.round(e.position.x/1024*100-8+2),i=Math.round(e.position.y/1024*100-8+100-2);t.drawTexture(r,i,this.posJoshi,.5)});const r=Math.round(this.kartPosition.x/1024*100*.3-8+2),i=Math.round(this.kartPosition.y/1024*100*.3-8+100-2);t.drawTexture(r,i,this.pos,1)}getNPCs(){const t=Date.now()-this.startTime,e=new Array;for(let r=0;r<10;r++){const i=2200,o=this.animator.getPos(t+r*i),n=this.animator.getPos(t+10+r*i).mul(1/.3).sub(o.mul(1/.3)).normalize(),s=new a.NpcEntity(o,this.joshiTextures);s.setDirection(n),s.height=Math.abs(30*Math.sin(.003*(Date.now()-this.startTime))),e.push(s),e.push(new l.Pipe(o,this.shadowTexture,1,1))}return e}drawMode7Entities(t){const e=this.camera.getViewDirection(),r=e.perp();for(let i=0;i<t.length;i++){const o=t[i].position.mul(1/.3),n=o.sub(this.camera.position).dot(e);if(n>0){const e=this.camera.screenDistance/n,s=t[i].getTexture(this.camera);if(Math.round(e*s.height)<=0)continue;const a=o.sub(this.camera.position).dot(r),l=this.camera.height*e,c=t[i].scale,h=t[i].offset;this.spriteRenderer.addSprite(new d.Sprite(Math.round(160+a*e-s.width*e*c/2),Math.round(20+l-((s.height+h)*c+t[i].height)*e),Math.round(s.width*e*c),Math.round(s.height*e*c),s,t[i].getAlpha(),n,t[i].getPriority()))}}}drawBackground(t){for(let e=0;e<320;e++)for(let r=0;r<this.back.height;r++)t.drawPixel(e,r,this.back.getPixel2(this.back,(Math.floor(e+2*this.camera.angle)%this.back.width+this.back.width)%this.back.width,r))}drawHeadUpDisplay(t){t.drawTexture(320-this.metrics.width-16,2,this.metrics,1);const e=Date.now()-this.startTime,r=Math.floor(e/10)%100,i=Math.floor(e/1e3),o=Math.floor(e/6e4),n=i%60;this.fontRenderer.drawText2(241,4,this.pad(o,2)),this.fontRenderer.drawText2(265,4,this.pad(n,2)),this.fontRenderer.drawText2(289,4,this.pad(r,2))}pad(t,e){const r="0"+t;return r.substr(r.length-e)}handleInput(){this.keyboard.isDown(h.Keyboard.KEY_L)&&(this.acceleration=.57),this.keyboard.isDown(h.Keyboard.KEY_A)?this.angleVel=Math.max(-1,this.angleVel-.2):this.keyboard.isDown(h.Keyboard.KEY_D)?this.angleVel=Math.min(1,this.angleVel+.2):this.angleVel=0,this.camera.angle=this.camera.angle+this.angleVel,this.velocity.x+=Math.cos(2*Math.PI/360*this.camera.angle)*this.acceleration,this.velocity.y+=Math.sin(2*Math.PI/360*this.camera.angle)*this.acceleration,this.velocity.length()>7.4&&(this.velocity=this.velocity.mul(1/this.velocity.length()*7.4)),this.kartPosition=this.kartPosition.add(this.velocity),this.velocity=this.velocity.mul(.91),this.acceleration=.89*this.acceleration,this.velocity.length()<.5&&(this.velocity=this.velocity.mul(0));this.camera.position=new i.Vector2f(this.kartPosition.x-159*Math.cos(2*Math.PI/360*this.camera.angle),this.kartPosition.y-159*Math.sin(2*Math.PI/360*this.camera.angle))}}e.Mode7Scene=m},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NpcEntity=void 0;const i=r(111);class o extends i.Mode7Entity{constructor(t,e){super(t),this.textures=e}setDirection(t){this.direction=t}getTexture(t){const e=this.position.mul(1/.3).sub(t.position);let r=-Math.atan2(e.y,e.x)+Math.atan2(this.direction.y,this.direction.x);return r=(r/(2*Math.PI)*360%360+360)%360,this.textures[Math.floor(r/360*this.textures.length)%this.textures.length]}getAlpha(){return 1}}e.NpcEntity=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Pipe=void 0;const i=r(111);class o extends i.Mode7Entity{constructor(t,e,r=1,i=0,o=1,n=0){super(t,0,i,o,n),this.texture=e,this.alpha=r}getTexture(){return this.texture}getAlpha(){return this.alpha}}e.Pipe=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.KartAnimator=void 0;const i=r(26);e.KartAnimator=class{setKeyFrames(t){this.keyFrames=t}getPos(t){const e=(t/700|0)%this.keyFrames.length,r=(e-1+this.keyFrames.length)%this.keyFrames.length,o=(e+1)%this.keyFrames.length,n=(e+2)%this.keyFrames.length,s=t/700%this.keyFrames.length-e;return new i.Vector2f(this.CubicInterpolate(this.keyFrames[r].x,this.keyFrames[e].x,this.keyFrames[o].x,this.keyFrames[n].x,s),this.CubicInterpolate(this.keyFrames[r].y,this.keyFrames[e].y,this.keyFrames[o].y,this.keyFrames[n].y,s))}CubicInterpolate(t,e,r,i,o){let n,s,a,l,c;return c=o*o,n=-.5*t+1.5*e-1.5*r+.5*i,s=t-2.5*e+2*r-.5*i,a=-.5*t+.5*r,l=e,n*o*c+s*c+a*o+l}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Mode7Renderer=e.Camera=void 0;const i=r(0);e.Camera=class{getViewDirection(){return new i.Vector2f(Math.cos(2*Math.PI/360*this.angle),Math.sin(2*Math.PI/360*this.angle))}};e.Mode7Renderer=class{constructor(t,e){this.map=t,this.grass=e}setCamera(t){this.camera=t}render(t){let e=6720;const r=this.camera.getViewDirection(),i=r.perp();for(let o=21;o<200;o++){const n=this.camera.screenDistance*this.camera.height/(o-20),s=n/this.camera.screenDistance,a=r.x*n+this.camera.position.x,l=r.y*n+this.camera.position.y,c=i.x*s,h=i.y*s;let u,f=a-160*c,d=l-160*h;f*=.3,d*=.3;const p=.3*c,m=.3*h;for(let r=0;r<320;r++)u=f>=0&&f<=1023&&d>=0&&d<=1023?this.map.getPixel2(this.map,Math.round(f)%1024,Math.round(d)%1024):this.grass.getPixel2(this.grass,(Math.round(f)%8+8)%8,7-(Math.round(d)%8+8)%8),t.framebuffer[e++]=u,f+=p,d+=m}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NpcTrack=void 0;const i=r(0);let o=(()=>{class t{constructor(){}}return t.track=[new i.Vector2f(920,580),new i.Vector2f(940,476),new i.Vector2f(922,415),new i.Vector2f(850,370),new i.Vector2f(766,323),new i.Vector2f(684,277),new i.Vector2f(615,250),new i.Vector2f(524,209),new i.Vector2f(449,165),new i.Vector2f(371,123),new i.Vector2f(295,91),new i.Vector2f(229,70),new i.Vector2f(165,68),new i.Vector2f(119,89),new i.Vector2f(85,133),new i.Vector2f(64,190),new i.Vector2f(56,247),new i.Vector2f(72,293),new i.Vector2f(87,348),new i.Vector2f(81,408),new i.Vector2f(71,477),new i.Vector2f(64,572),new i.Vector2f(67,637),new i.Vector2f(78,718),new i.Vector2f(134,750),new i.Vector2f(226,727),new i.Vector2f(286,669),new i.Vector2f(344,629),new i.Vector2f(447,586),new i.Vector2f(535,588),new i.Vector2f(583,645),new i.Vector2f(612,712),new i.Vector2f(641,786),new i.Vector2f(681,849),new i.Vector2f(744,895),new i.Vector2f(820,912),new i.Vector2f(880,915),new i.Vector2f(930,880),new i.Vector2f(955,804),new i.Vector2f(944,717),new i.Vector2f(921,643)],t})();e.NpcTrack=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sprite=void 0;e.Sprite=class{constructor(t,e,r,i,o,n,s,a){this.xp=t,this.yp=e,this.width=r,this.height=i,this.texture=o,this.alphaBlend=n,this.z=s,this.priority=a}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpriteRenderer=void 0;e.SpriteRenderer=class{constructor(){this.sprites=new Array}addSprite(t){this.sprites.push(t)}render(t){this.sprites.sort((t,e)=>e.priority===t.priority?e.z-t.z:e.priority-t.priority),this.sprites.forEach(e=>{t.scaleClipBlitter.drawScaledTextureClip(e.xp,e.yp,e.width,e.height,e.texture,e.alphaBlend)}),this.sprites.length=0}}},function(t,e,r){"use strict";r.r(e),e.default=r.p+"fd1b74fa78497865112022df799527aa.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"324a9935e72af9780758fe9c4e278f05.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"c037dbbca4e55dcffddb98b905261fa1.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"aaad9bdd443df0585112a3af7ebb47b3.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"53a5a09f3199556bd4399d272ef7f9d8.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"74eb2f6fe45b4684ac07397345d78573.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"d3b93d34e4e938e2700747ae9891230c.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"e7fbfa238a2b61c24df4375a395b2f1a.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"72f6fbdfaee48bd82c0405a6d0bdb1a4.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"07288ef746dbda9d1812b23f7510b13a.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"1a1fde739ee9cf356d062e2ec76786be.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"ed67cb9a9c48b2848ec317ae2f833968.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"486b3020ebb03a2f60d4e62e720917ca.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"4313b62a9c17da4ec1f0dd346a0fcde5.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"dbeb177bc3a9a16848b078fb0aeef21e.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"7f9c339618db9db76be59817d4bc5664.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"c057afb080907faea7c42e50558da4c6.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"4ab9390a795f7fbdcc0a96b185d5d30f.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"e2b48f76ceac2f36e1be0fd0dbe98741.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"e55b22afa361d19fe9150f44e49465e8.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"437151f044d0390a632f607aeac71e4e.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"a438f50cd8218bf0f2a6bb41c3265e7b.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"45caee74596b766d3646f21f3c1f309c.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"b4591289184aa2ea47198e5a12c2cb41.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"fd2d99fa2ad6e986db401f47f3a8d4ae.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"2ca93442c4b232b4d2a8862c304fc6b5.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"2ad6854d49224bef61e0ac8d9dfdcbae.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"c3b2a35710dcb9ca5bba9157d3cf327e.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"9396c43046238b1077d769463f888cea.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"633762009df7e860b55178258f96abf1.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"ba291c9ec5a9bb99345752f6d52036a0.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"4e26ee31b981bd598c073f73753d4b01.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"bf401467f9318180ce2a7427d2f1d718.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"f4d7e208afd8c9a7db7f3b7fdedcc71d.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"271e583da7ae987621c8907fab6e75ec.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"cf1a15fc36674478de11dbc4c25acb41.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"7ba50cfe43b87a60177c9b26bf2c2a5b.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"0de78a98e070d9a50f1ae08f5a5a3005.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"c8923e0c9d7a9a5f40a913cfbbd799a2.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"c3934d77c58ef15f84e881df608b17c2.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"704d93be51c6c438b380d8fef8fed0c8.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"cbbe36154554289abbcb207ec4a80e86.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"e7bb0f8843652ebce2fc057d3895ef69.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"925b74eccfd8bd40e23d55ea2fdb7a46.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"4c15eb9fcd3cc20042bb8d44068f710d.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"078a0279ad733ad1bcec61a4c9402cd3.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"f6744aa95aace9b2b7c568ec2587c2b2.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"95aeac15a0e46421ae8124532c2e5aac.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"4c6d0866e7bb94c18f3b089154a045a1.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"1290a0d0a2687e5ef692dee4ea8f7830.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"37318f25829bdf40818d05b426b1ec51.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"de558f075f3114d6a2c052350657ba42.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"f3c202ca4e4288057621371df5630659.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"0cbdf22056e471aad7d3a9b06d5642be.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"8f211f8b7c0b05af7b9031e59ba3f73f.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"5a72916091e049aa91487f05b439349a.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"afc6310d7e15fa1d77e6fc59439ee91d.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"2bf6b0957735884290cbfbb6767e7472.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"f924a4394c1791be22bae809b5e0b749.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"f2b2405ff28424d1bbf0f1276022c7de.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MovingTorusScene=void 0;const i=r(8),o=r(25),n=r(0),s=r(18),a=r(42);class l extends s.AbstractScene{constructor(){super(...arguments),this.torus=new o.Torus}init(t){return t.setCullFace(i.CullFace.BACK),Promise.all([a.TextureUtils.load(r(48),!0).then(t=>this.background=t)])}render(t){const e=Date.now();t.fastFramebufferCopy(t.framebuffer,this.background.texture),this.shadingTorus2(t,.02*e)}shadingTorus2(t,e){t.clearDepthBuffer();let r=n.Matrix4f.constructYRotationMatrix(.09*e);r=r.multiplyMatrix(n.Matrix4f.constructXRotationMatrix(.08*e)),r=n.Matrix4f.constructTranslationMatrix(25*Math.sin(.04*e),9*Math.sin(.05*e),-24).multiplyMatrix(r),t.renderingPipeline.draw(this.torus.getMesh(),r)}}e.MovingTorusScene=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ParticleStreamsScene=void 0;const i=r(18),o=r(0),n=r(9),s=r(42);class a extends i.AbstractScene{constructor(){super(...arguments),this.accumulationBuffer=new Uint32Array(64e3)}init(t){return Promise.all([s.TextureUtils.load(r(43),!1).then(t=>this.blurred=t),s.TextureUtils.generateProceduralParticleTexture().then(t=>this.particleTexture2=t),s.TextureUtils.generateProceduralNoise().then(t=>this.noise=t)])}render(t){const e=Date.now();t.fastFramebufferCopy(t.framebuffer,this.blurred.texture),this.drawParticleStreams(t,e,this.particleTexture2,!0);const r=new n.Texture(this.accumulationBuffer,320,200);t.drawTexture(0,0,r,.55),t.fastFramebufferCopy(this.accumulationBuffer,t.framebuffer),t.noise(e,this.noise)}drawParticleStreams(t,e,r,i=!1){const n=new Array;for(let t=0;t<50;t++){const r=2.8,i=2.9+3*Math.sin(2*Math.PI*t/50-.002*e);for(let s=0;s<10;s++){const a=(2.1*(t-25)-.008*e)%105+52.5,l=Math.cos(2*Math.PI/10*s+.02*t+5e-4*e)*r+8+i,c=Math.sin(2*Math.PI/10*s+.02*t+5e-4*e)*r;n.push(o.Matrix3f.constructXRotationMatrix(2*Math.PI*t/50-Math.sin(3e-4*e+2*Math.PI*t/50)).multiply(new o.Vector3f(a,l,c)))}}for(let i=0;i<3;i++){const s=o.Matrix4f.constructTranslationMatrix(0,-0,-49).multiplyMatrix(o.Matrix4f.constructZRotationMatrix(.17*Math.PI).multiplyMatrix(o.Matrix4f.constructYRotationMatrix(15e-5*e).multiplyMatrix(o.Matrix4f.constructXRotationMatrix(2*Math.PI/3*i+6e-4*e)))),a=new Array(n.length);n.forEach(e=>{const r=t.project(s.multiply(e));a.push(r)}),a.sort((t,e)=>t.z-e.z),a.forEach(e=>{const i=-1.3*192/e.z;e.z<-4&&t.drawParticleNoDepth(Math.round(e.x-i/2),Math.round(e.y-i/2),Math.round(i),Math.round(i),r,t.interpolate(-90,-55,e.z))})}}}e.ParticleStreamsScene=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ParticleSystemScene=void 0;const i=r(19),o=r(18),n=r(9),s=r(21),a=r(241);class l extends o.AbstractScene{constructor(){super(...arguments),this.accumulationBuffer=new Uint32Array(64e3)}init(t){return this.particleSystem=new a.ParticleSystem(.8*Date.now()),Promise.all([s.TextureUtils.load(r(43),!1).then(t=>this.blurred=t),s.TextureUtils.generateProceduralParticleTexture().then(t=>this.particleTexture2=t),s.TextureUtils.generateProceduralNoise().then(t=>this.noise=t)])}render(t){const e=.8*Date.now();t.fastFramebufferCopy(t.framebuffer,this.blurred.texture),t.clearDepthBuffer();const r=this.getMV(3*e);this.particleSystem.drawParticleStreams(t,e,this.particleTexture2,r);const i=new n.Texture(this.accumulationBuffer,320,200);t.drawTexture(0,0,i,.55),t.fastFramebufferCopy(this.accumulationBuffer,t.framebuffer),t.noise(e,this.noise)}getMV(t){return i.Matrix4f.constructTranslationMatrix(0,0,2*(.5*Math.sin(7e-5*t)+.5)-24).multiplyMatrix(i.Matrix4f.constructXRotationMatrix(35e-5*t).multiplyMatrix(i.Matrix4f.constructYRotationMatrix(3e-4*-t))).multiplyMatrix(i.Matrix4f.constructScaleMatrix(3,3,3))}}e.ParticleSystemScene=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ParticleSystem=void 0;const i=r(242);e.ParticleSystem=class{constructor(t){this.lastTime=0,this.particles=Array(600).fill(null).map(()=>new i.Particle(t))}drawParticleStreams(t,e,r,i){const o=e-this.lastTime;this.lastTime=e;for(let r=0;r<this.particles.length;r++){const n=this.particles[r];n.dead&&n.init(e),n.update(e,o),n.transformedPosition=t.project(i.multiply(n.position))}this.particles.sort((t,e)=>t.transformedPosition.z-e.transformedPosition.z);for(let e=0;e<this.particles.length;e++)this.drawParticle(this.particles[e],t,r)}drawParticle(t,e,r){const i=-192*t.size/t.transformedPosition.z;!t.dead&&t.transformedPosition.z<-4&&e.drawSoftParticle(Math.round(t.transformedPosition.x-i/2),Math.round(t.transformedPosition.y-i/2),Math.round(i),Math.round(i),r,1/t.transformedPosition.z,t.alpha)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Particle=void 0;const i=r(0);e.Particle=class{constructor(t){this.init(t)}init(t){this.position=new i.Vector3f(2.3*Math.sin(1*t*.002),2.3*Math.cos(2*t*.002),2.3*+Math.sin(2*t*.002));this.velocity=new i.Vector3f(1.3*(Math.random()-.5),1.3*(Math.random()-.5),1.3*(Math.random()-.5)).mul(Math.random()),this.alpha=Math.random(),this.size=1.8*(Math.random()+.5),this.start=t,this.lifespan=900*Math.random()+500,this.dead=!1}update(t,e){this.position=this.position.add(this.velocity.mul(e/1e3)),this.alpha=1-(t-this.start)/this.lifespan,this.start+this.lifespan<t&&(this.dead=!0)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ParticleTorusScene=void 0;const i=r(19),o=r(1),n=r(18),s=r(9),a=r(21);class l extends n.AbstractScene{constructor(){super(...arguments),this.accumulationBuffer=new Uint32Array(64e3)}init(t){return this.start=Date.now(),Promise.all([a.TextureUtils.load(r(43),!1).then(t=>this.blurred=t),a.TextureUtils.generateProceduralParticleTexture().then(t=>this.particleTexture2=t),a.TextureUtils.generateProceduralNoise().then(t=>this.noise=t)])}render(t){const e=Date.now();t.fastFramebufferCopy(t.framebuffer,this.blurred.texture),this.drawParticleTorus(t,e,this.particleTexture2,!0);const r=new Uint32Array(64e3);t.fastFramebufferCopy(r,t.framebuffer);const i=new s.Texture;i.texture=r,i.width=320,i.height=200;const o=(Date.now()-this.start)%(6e4/140*2),n=35*(t.cosineInterpolate(0,20,o)-t.cosineInterpolate(20,300,o)),a=Math.round(320+320*n/100),l=Math.round(200+200*n/100);t.drawScaledTextureClipBi(Math.round(160-a/2),Math.round(100-l/2),a,l,i,1);const c=new s.Texture(this.accumulationBuffer,320,200);t.drawTexture(0,0,c,.85),t.fastFramebufferCopy(this.accumulationBuffer,t.framebuffer),t.noise(e,this.noise)}drawParticleTorus(t,e,r,n=!1){n||t.clearColorBuffer(-13617080),t.clearDepthBuffer();const s=new Array;for(let t=0;t<300;t++){const r=3.4*(2+Math.sin(t*Math.PI/150*2+4e-4*e)),i=.0015*e,n=r*Math.cos((i+t)*Math.PI/150*7),a=r*Math.cos((i+t)*Math.PI/150*4),l=r*Math.sin((i+t)*Math.PI/150*7);s.push(new o.Vector3f(n,a,l))}const a=i.Matrix4f.constructTranslationMatrix(0,0,-20).multiplyMatrix(i.Matrix4f.constructYRotationMatrix(3e-4*e).multiplyMatrix(i.Matrix4f.constructXRotationMatrix(3e-4*e))),l=new Array(s.length);s.forEach(e=>{const r=t.project(a.multiply(e));l.push(r)}),l.sort((t,e)=>t.z-e.z),l.forEach(e=>{const i=-2.2*192/e.z;t.drawParticle(Math.round(e.x)-Math.round(i/2),Math.round(e.y)-Math.round(i/2),Math.round(i),Math.round(i),r,1/e.z,1)})}}e.ParticleTorusScene=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PixelEffectScene=void 0;const i=r(18),o=r(21),n=r(23),s=r(52),a=r(245),l=r(0);class c extends i.AbstractScene{constructor(){super(...arguments),this.startTime=Date.now(),this.pixels=new Array}init(t){this.scaleClipBlitter=new n.ScaleClipBlitter(t);return this.fontRenderer2=new s.FontRenderer(t,32,32," !\"    '    ,-. 0123456789:; = ? ABCDEFGHIJKLMNOPQRSTUVWXYZ ",r(60)),Promise.all([o.TextureUtils.load(r(90),!1).then(t=>this.heightmap=t),o.TextureUtils.load(r(91),!0).then(t=>this.hoodlumLogo=t),this.fontRenderer2.init()])}onInit(){let t=0;for(let e=0;e<this.hoodlumLogo.width;e++)for(let r=0;r<this.hoodlumLogo.height;r++){const i=this.hoodlumLogo.getPixel2(this.hoodlumLogo,e,r);255==(i>>24&255)&&(this.pixels.push(new a.PixelInterpolator(new l.Vector2f(Math.round(150*Math.sin(4*t*4e-4*Math.PI*2)+160),Math.round(90*Math.cos(3*t*4e-4*Math.PI*2)+100)),new l.Vector2f(e,r+67),i,3*t)),t++)}}render(t){this.drawPlanedeformationTunnel(t,Date.now(),this.heightmap,this.heightmap),this.fontRenderer2.drawText(0,152,"              WELCOME TO A NEW RELEASE FROM YOUR FRIENDS IN CRIME! HOW DO YOU LIKE THIS INTRO?",.8*(Date.now()-this.startTime),!1);for(let e=0;e<this.pixels.length;e++){const r=this.pixels[e].getPos(2e-4*(Date.now()-this.startTime-this.pixels[e].startTime),e);if(r.x<0||r.x>319||r.y<0||r.y>199)continue;const i=Math.max(0,Math.min(1,.001*(Date.now()-this.startTime-this.pixels[e].startTime)));t.drawPixel4(r.x,r.y,this.pixels[e].pixel,i)}}drawPlanedeformationTunnel(t,e,r,i){let o=0;for(let r=0;r<200;r++){const n=r-100,s=((1/Math.abs(n/100*.02)+.069*e)%256+256)%256,a=1-Math.min(1,1/Math.abs(n/10));for(let e=0;e<320;e++){const r=((e-160)/160/Math.abs(n/100*.02)%256+256)%256,l=i.texture[(0|r)+256*(0|s)],c=(l>>0&255)*a|0,h=(l>>8&255)*a|0,u=(l>>16&255)*a|0;t.framebuffer[o++]=c|h<<8|u<<16|255<<24}}}}e.PixelEffectScene=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PixelInterpolator=void 0;const i=r(0);function o(t,e,r){let i;return i=(1-Math.cos(r*Math.PI))/2,t*(1-i)+e*i}e.PixelInterpolator=class{constructor(t,e,r,i=0){this.start=t,this.end=e,this.pixel=r,this.startTime=i}getPos(t,e){return t<=0?this.start:t>=1?this.end:new i.Vector2f(Math.round(o(this.start.x,this.end.x,t)+40*Math.sin(55*t+.15*e)*(1-t)),Math.round(o(this.start.y,this.end.y,t)+40*Math.cos(55*t+.15*e)*(1-t)))}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlaneDeformationAbstractScene=void 0;const i=r(18),o=r(42),n=r(23),s=r(52);class a extends i.AbstractScene{constructor(){super(...arguments),this.startTime=Date.now()}init(t){this.scaleClipBlitter=new n.ScaleClipBlitter(t);return this.fontRenderer2=new s.FontRenderer(t,32,32," !\"    '    ,-. 0123456789:; = ? ABCDEFGHIJKLMNOPQRSTUVWXYZ ",r(60)),Promise.all([o.TextureUtils.load(r(247),!1).then(t=>this.heightmap=t),o.TextureUtils.load(r(51),!0).then(t=>this.hoodlumLogo=t),this.fontRenderer2.init()])}render(t){this.drawPlanedeformationTunnel(t,Date.now(),this.heightmap,this.heightmap),t.drawTexture(160-this.hoodlumLogo.width/2|0,100-this.hoodlumLogo.height/2|0,this.hoodlumLogo,1)}drawPlanedeformationTunnel(t,e,r,i){let o=0;for(let e=0;e<200;e++)for(let r=0;r<320;r++){const n=(r-160)/160,s=(e-100)/100,a=1,l=Math.atan2(s,n)+4e-4*Date.now(),c=128*(3*l/Math.PI+4e-4*Date.now())%256,h=(1/(Math.sqrt(n*n+s*s)+.5+.5*Math.sin(5*l))*32+.03*Date.now())%256,u=i.texture[(0|h)+256*(0|c)],f=(u>>0&255)*a|0,d=(u>>8&255)*a|0,p=(u>>16&255)*a|0;t.framebuffer[o++]=f|d<<8|p<<16|255<<24}}}e.PlaneDeformationAbstractScene=a},function(t,e,r){"use strict";r.r(e),e.default=r.p+"dde80f7d8d6c1038a9b029af6509cf8f.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlanedeformationTunnelScene=void 0;const i=r(18),o=r(42),n=r(23);class s extends i.AbstractScene{init(t){return this.scaleClipBlitter=new n.ScaleClipBlitter(t),Promise.all([o.TextureUtils.load(r(56),!1).then(t=>this.heightmap=t),o.TextureUtils.load(r(112),!1).then(t=>this.metall=t),o.TextureUtils.load(r(51),!0).then(t=>this.hoodlumLogo=t)])}render(t){this.drawPlanedeformationTunnel(t,Date.now(),this.heightmap,this.metall);const e=Date.now()%(6e4/140*2),r=35*(t.cosineInterpolate(0,15,e)-t.cosineInterpolate(15,200,e)+.4*t.cosineInterpolate(200,300,e)-.4*t.cosineInterpolate(300,400,e));this.scaleClipBlitter.drawScaledTextureClip(160-(this.hoodlumLogo.width+r)/2|0,100-(this.hoodlumLogo.height-r)/2|0,this.hoodlumLogo.width+r,this.hoodlumLogo.height-r|0,this.hoodlumLogo,1)}drawPlanedeformationTunnel(t,e,r,i){let o=0;for(let n=0;n<200;n++)for(let s=0;s<320;s++){const a=s-160,l=n-100;let c=5120/Math.max(1,Math.sqrt(a*a+l*l)),h=c;c+=.02*e,h+=.039*e;const u=128*(Math.atan2(a,l)/Math.PI+1)+.0069*e,f=r.texture[(255&h)+255*(255&u)],d=i.texture[(255&c)+255*(255&u)],p=.4,m=1-p,x=(f>>0&255)*m+(d>>0&255)*p|0,M=(f>>8&255)*m+(d>>8&255)*p|0,w=(f>>16&255)*m+(d>>16&255)*p|0;t.framebuffer[o++]=x|M<<8|w<<16|255<<24}}}e.PlanedeformationTunnelScene=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlasmaScene=void 0;const i=r(18),o=r(0);class n extends i.AbstractScene{render(t){this.drawOldSchoolPlasma(t,Date.now())}drawOldSchoolPlasma(t,e){const r=7e-4*e*1,i=new o.Vector3f(Math.sin(r),Math.cos(r),0),n=new o.Vector3f(235,115,0).add(new o.Vector3f(235*Math.sin(-r),115*Math.cos(-r),0)),s=new o.Vector3f(0,0,0);let a=0;for(let e=0;e<200;e++)for(let o=0;o<320;o++){const l=.5*Math.sin(.02*(o*i.x+e*i.y)+r+1);s.x=o-n.x,s.y=e-n.y;const c=.5*(.5*(Math.cos(.03*s.length())+1)+l),h=.5*(Math.cos(Math.PI*c/.5+r)+1)*255,u=.5*(Math.sin(Math.PI*c/.5+r)+1)*255,f=.5*(Math.sin(r)+1)*255;t.framebuffer[a++]=255<<24|f<<16|u<<8|h}}}e.PlasmaScene=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlatonianScene=void 0;const i=r(8),o=r(0),n=r(18),s=r(42),a=r(44);class l extends n.AbstractScene{constructor(){super(...arguments),this.accumulationBuffer=new Uint32Array(64e3)}init(t){return t.setCullFace(i.CullFace.BACK),Promise.all([a.BlenderLoader.loadWithTexture(r(251)).then(t=>this.platonianMesh=t),s.TextureUtils.load(r(43),!1).then(t=>this.blurred=t),s.TextureUtils.load(r(113),!1).then(t=>this.platonian=t),s.TextureUtils.generateProceduralNoise().then(t=>this.noise=t)])}render(t){const e=Date.now();t.fastFramebufferCopy(t.framebuffer,this.blurred.texture),this.drawBlenderScene8(t,e);const r=new s.Texture(this.accumulationBuffer,320,200);t.drawTexture(0,0,r,.75),t.fastFramebufferCopy(this.accumulationBuffer,t.framebuffer),t.noise(e,this.noise)}drawBlenderScene8(t,e){t.clearDepthBuffer();const r=o.Matrix4f.constructTranslationMatrix(0,0,17*(.5*Math.sin(7e-5*e)+.5)-64).multiplyMatrix(o.Matrix4f.constructXRotationMatrix(35e-5*e).multiplyMatrix(o.Matrix4f.constructYRotationMatrix(3e-4*-e))).multiplyMatrix(o.Matrix4f.constructScaleMatrix(13,13,13));t.setTexture(this.platonian),t.texturedRenderingPipeline.setModelViewMatrix(r),t.texturedRenderingPipeline.drawMeshArray(this.platonianMesh)}}e.PlatonianScene=l},function(t,e,r){"use strict";r.r(e),e.default=r.p+"221eeedd3ebbf56676272dab5daf9c06.jsx"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PolarVoxelsScene=void 0;const i=r(18),o=r(42);class n extends i.AbstractScene{init(t){return Promise.all([o.TextureUtils.load(r(56),!1).then(t=>this.heightmap=t),o.TextureUtils.generateProceduralNoise().then(t=>this.noise=t)])}render(t){const e=3*Date.now();this.drawVoxelLandscape4(t,this.heightmap,e);const r=new o.Texture;r.texture=new Uint32Array(65536);for(let e=0;e<256;e++)for(let i=0;i<256;i++){const o=199-Math.round(.78125*i),n=Math.round(1.25*e);r.texture[i+256*e]=t.framebuffer[n+320*o]}t.drawPolarDistotion2(e,r),t.noise(e,this.noise)}drawVoxelLandscape4(t,e,r){t.clearColorBuffer(255<<24);const i=.02*r;for(let o=0;o<320;o++){let n,s;n=1.99*Math.cos(1e-4*r+2*Math.PI/320*o),s=1.99*Math.sin(1e-4*r+2*Math.PI/320*o);let a=0,l=i+14*n,c=0+14*s;for(let r=14;r<80;r++){const i=(255&e.texture[(255&l)+256*(255&c)])*Math.sin(Math.abs(.5*(r-14)/66))*3.5,h=Math.round(29.7*(i-10)/r+90)-50,u=(200*Math.round(i)/255+55)*Math.min(1,1-(r-14)/66),f=255<<24|.7*u<<16|u<<8|.8*u;if(h>a){let e=o+320*(199-a);const r=Math.min(h,200);for(let i=a;i<r;i++)t.framebuffer[e]=f,e-=320;if(200===r)break;a=h}l+=n,c+=s}}}}e.PolarVoxelsScene=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PortalScene=void 0;const i=r(92),o=r(93),n=r(7),s=r(8),a=r(0),l=r(254),c=r(18);let h=(()=>{class t extends c.AbstractScene{init(t){return t.setCullFace(s.CullFace.BACK),this.controllableCamera=new i.ControllableCamera(new a.Vector3f(14.84,0,-19.25),-3.54,0,0),this.area=this.generateAreaPortalNetwork(),this.frustumCuller=new o.FrustumCuller,this.portalRenderer=new l.PortalRenderer,document.addEventListener("keydown",t=>{38===t.which&&this.controllableCamera.moveForward(.2,1),40===t.which&&this.controllableCamera.moveBackward(.2,1),37===t.which&&this.controllableCamera.turnLeft(.05,1),39===t.which&&this.controllableCamera.turnRight(.05,1)}),Promise.all([])}render(e){e.clearColorBuffer(t.BACKGROUND_COLOR),e.clearDepthBuffer();const r=this.controllableCamera.getViewMatrix();this.frustumCuller.updateFrustum(r,this.controllableCamera.getPosition()),this.drawScreenBounds(e),this.portalRenderer.renderVisibleAreas(e,r,this.area,this.frustumCuller.getPlanes(),this.controllableCamera)}generateAreaPortalNetwork(){const t=new l.Polygon;t.vertices=[new a.Vector4f(0,3,3),new a.Vector4f(10,3,3),new a.Vector4f(10,-7,3)];const e=new l.Portal;e.geometry=t,e.intoArea=new l.Area;const r=new l.Area;r.portals=[e];const i=new l.Polygon;i.vertices=[new a.Vector4f(0,5,0),new a.Vector4f(10,5,0),new a.Vector4f(10,-5,0)];const o=new l.Portal;o.geometry=i,o.intoArea=r;const s=new l.Area;return s.mesh=null,s.portals=[o],s.portalColor=n.Color.RED,s}drawScreenBounds(t){const e=n.Color.WHITE.toPackedFormat();t.drawLineDDANoZ(new a.Vector3f(80,50,0),new a.Vector3f(240,50,-100),e),t.drawLineDDANoZ(new a.Vector3f(80,50,0),new a.Vector3f(80,150,-100),e),t.drawLineDDANoZ(new a.Vector3f(240,50,0),new a.Vector3f(240,150,-100),e),t.drawLineDDANoZ(new a.Vector3f(80,150,0),new a.Vector3f(240,150,-100),e)}}return t.BACKGROUND_COLOR=n.Color.SLATE_GRAY.toPackedFormat(),t})();e.PortalScene=h},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(255);Object.defineProperty(e,"Area",{enumerable:!0,get:function(){return i.Area}});var o=r(114);Object.defineProperty(e,"Polygon",{enumerable:!0,get:function(){return o.Polygon}});var n=r(256);Object.defineProperty(e,"Portal",{enumerable:!0,get:function(){return n.Portal}});var s=r(257);Object.defineProperty(e,"PortalRenderer",{enumerable:!0,get:function(){return s.PortalRenderer}});var a=r(115);Object.defineProperty(e,"SutherlandHodgmanClipper",{enumerable:!0,get:function(){return a.SutherlandHodgmanClipper}})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Area=void 0;e.Area=class{draw(){}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Portal=void 0;e.Portal=class{}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PortalRenderer=void 0;const i=r(0),o=r(115),n=r(7);e.PortalRenderer=class{renderVisibleAreas(t,e,r,i,s){if(r.draw(),void 0!==r.portals&&0!==r.portals.length)for(let a=0;a<r.portals.length;a++){const l=r.portals[a],c=o.SutherlandHodgmanClipper.clip(l.geometry,i);c.isVisible()&&(this.drawPolygon(t,0,c,e,r.portalColor?r.portalColor:n.Color.CYAN),this.renderVisibleAreas(t,e,l.intoArea,c.getPlanes(s.getPosition()),s))}}drawPolygon(t,e,r,o,n){t.clearDepthBuffer();const s=r.vertices,a=o,l=new Array;s.forEach(t=>{const e=a.multiplyHom(t),r=e.x,o=e.y,n=e.z;l.push(new i.Vector3f(r,o,n))});for(let e=0;e<l.length;e++)t.nearPlaneClipping(l[e],l[(e+1)%l.length],n.toPackedFormat())}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RazorScene=void 0;const i=r(8),o=r(54),n=r(259),s=r(260),a=r(261),l=r(0),c=r(18),h=r(42),u=r(7);class f extends c.AbstractScene{constructor(){super(...arguments),this.accumulationBuffer=new Uint32Array(64e3)}init(t){return t.setCullFace(i.CullFace.BACK),this.cube=new o.Cube,this.dodecahedron=new n.Dodecahedron,this.pyramid=new s.Pyramid,this.icosahedron=new a.Sphere(6,10),Promise.all([h.TextureUtils.load(r(262),!0).then(t=>this.texture10=t),h.TextureUtils.load(r(263),!0).then(t=>this.texture11=t),h.TextureUtils.load(r(264),!0).then(t=>this.texture13=t),h.TextureUtils.load(r(265),!0).then(t=>this.dirt=t),h.TextureUtils.generateProceduralNoise().then(t=>this.noise=t)])}render(t){const e=Date.now();this.reproduceRazorScene(t,.0025*e,[{tex:this.texture10,scale:0,alpha:1},{tex:this.texture11,scale:2.3,alpha:.5},{tex:this.texture13,scale:1.6,alpha:.25},{tex:this.texture13,scale:.7,alpha:.22},{tex:this.texture13,scale:-.4,alpha:.22}],this.dirt);const r=new h.Texture(this.accumulationBuffer,320,200);t.drawTexture(0,0,r,.75),t.fastFramebufferCopy(this.accumulationBuffer,t.framebuffer),t.noise(e,this.noise,.04)}reproduceRazorScene(t,e,r,i){let o;t.clearColorBuffer(-13617080),t.clearDepthBuffer();const n=l.Matrix4f.constructTranslationMatrix(0,0,-6.4-5*(.5*Math.sin(.06*e)+.5)).multiplyMatrix(l.Matrix4f.constructXRotationMatrix(.5*(.5*Math.sin(.08*e)+.5)).multiplyMatrix(l.Matrix4f.constructYRotationMatrix(.1*e)));let s=2;o=l.Matrix4f.constructYRotationMatrix(.2*e).multiplyMatrix(l.Matrix4f.constructScaleMatrix(s,s,s)),o=l.Matrix4f.constructTranslationMatrix(0,1,0).multiplyMatrix(o.multiplyMatrix(l.Matrix4f.constructXRotationMatrix(.2*-e))),o=n.multiplyMatrix(o);let a=this.dodecahedron.getMesh();t.renderingPipeline.draw(a,o);s=1,o=l.Matrix4f.constructScaleMatrix(s,s,s),o=l.Matrix4f.constructTranslationMatrix(2.8,-.5,2.8).multiplyMatrix(o),o=n.multiplyMatrix(o),a=this.icosahedron.getMesh(),t.renderingPipeline.draw(a,o),s=1,o=l.Matrix4f.constructScaleMatrix(.5*s,2*s,.5*s),o=l.Matrix4f.constructTranslationMatrix(-2.8,-.5,2.8).multiplyMatrix(o),o=n.multiplyMatrix(o),a=this.cube.getMesh(),t.renderingPipeline.draw(a,o),s=1,o=l.Matrix4f.constructScaleMatrix(s,s,s),o=l.Matrix4f.constructTranslationMatrix(2.8,-1,-2.8).multiplyMatrix(o),o=n.multiplyMatrix(o),a=this.cube.getMesh(),t.renderingPipeline.draw(a,o),s=1,o=l.Matrix4f.constructScaleMatrix(s,s,s),o=l.Matrix4f.constructTranslationMatrix(-2.8,-1,-2.8).multiplyMatrix(o),o=n.multiplyMatrix(o),a=this.pyramid.getMesh(),t.renderingPipeline.draw(a,o),t.renderingPipeline.enableLighting(!1),t.renderingPipeline.setColor(u.Color.DARK_GRAY),s=2,o=l.Matrix4f.constructYRotationMatrix(.2*e).multiplyMatrix(l.Matrix4f.constructScaleMatrix(s,s,s)),o=l.Matrix4f.constructTranslationMatrix(0,1,0).multiplyMatrix(o.multiplyMatrix(l.Matrix4f.constructXRotationMatrix(.2*-e))),o=n.multiplyMatrix(l.Matrix4f.constructShadowMatrix(o).multiplyMatrix(o)),t.renderingPipeline.draw(this.dodecahedron.getMesh(),o),s=1,o=l.Matrix4f.constructScaleMatrix(s,s,s),o=l.Matrix4f.constructTranslationMatrix(-2.8,-1,-2.8).multiplyMatrix(o),o=n.multiplyMatrix(l.Matrix4f.constructShadowMatrix(o).multiplyMatrix(o)),t.renderingPipeline.draw(this.pyramid.getMesh(),o),s=1,o=l.Matrix4f.constructScaleMatrix(s,s,s),o=l.Matrix4f.constructTranslationMatrix(2.8,-1,-2.8).multiplyMatrix(o),o=n.multiplyMatrix(l.Matrix4f.constructShadowMatrix(o).multiplyMatrix(o)),t.renderingPipeline.draw(this.cube.getMesh(),o),s=1,o=l.Matrix4f.constructScaleMatrix(.5*s,2*s,.5*s),o=l.Matrix4f.constructTranslationMatrix(-2.8,-.5,2.8).multiplyMatrix(o),o=n.multiplyMatrix(l.Matrix4f.constructShadowMatrix(o).multiplyMatrix(o)),t.renderingPipeline.draw(this.cube.getMesh(),o),s=1,o=l.Matrix4f.constructScaleMatrix(s,s,s),o=l.Matrix4f.constructTranslationMatrix(2.8,-.5,2.8).multiplyMatrix(o),o=n.multiplyMatrix(l.Matrix4f.constructShadowMatrix(o).multiplyMatrix(o)),t.renderingPipeline.draw(this.icosahedron.getMesh(),o),t.renderingPipeline.enableLighting(!0);const c=t.project(n.multiply(new l.Vector3f(12,4,0)));t.drawLensFlare(c,100*e,r,i)}}e.RazorScene=f},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Dodecahedron=void 0;const i=r(22),o=r(4);class n extends i.AbstractGeometricObject{constructor(){super();const t=.5*(1+Math.sqrt(5)),e=1/t,r=2-t,i=[new o.Vector4f(r,0,1),new o.Vector4f(-r,0,1),new o.Vector4f(-e,e,e),new o.Vector4f(0,1,r),new o.Vector4f(e,e,e),new o.Vector4f(e,-e,e),new o.Vector4f(0,-1,r),new o.Vector4f(-e,-e,e),new o.Vector4f(r,0,-1),new o.Vector4f(-r,0,-1),new o.Vector4f(-e,-e,-e),new o.Vector4f(0,-1,-r),new o.Vector4f(e,-e,-e),new o.Vector4f(e,e,-e),new o.Vector4f(0,1,-r),new o.Vector4f(-e,e,-e),new o.Vector4f(1,r,0),new o.Vector4f(-1,r,0),new o.Vector4f(-1,-r,0),new o.Vector4f(1,-r,0)];this.buildMesh(i,[0,4,1,1,3,2,1,4,3,1,7,0,0,6,5,0,7,6,8,12,9,9,11,10,9,12,11,9,15,8,8,14,13,8,15,14,14,3,13,13,4,16,13,3,4,3,14,2,2,15,17,2,14,15,11,6,10,10,7,18,10,6,7,6,11,5,5,12,19,5,11,12,16,4,19,19,0,5,19,4,0,19,12,16,16,8,13,16,12,8,17,15,18,18,9,10,18,15,9,18,7,17,17,1,2,17,7,1])}}e.Dodecahedron=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Pyramid=void 0;const i=r(4),o=r(22);class n extends o.AbstractGeometricObject{constructor(){super();const t=.5,e=(Math.sqrt(5),[new i.Vector4f(0,t,0),new i.Vector4f(t,-t,-t),new i.Vector4f(-t,-t,-t),new i.Vector4f(t,-t,t),new i.Vector4f(-t,-t,t)]);this.buildMesh(e,[0,1,2,0,3,1,0,4,3,0,2,4])}}e.Pyramid=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sphere=void 0;const i=r(4),o=r(22);class n extends o.AbstractGeometricObject{constructor(t=16,e=16){super();const r=[],i=t,o=e;for(let t=0;t<=i;t++)for(let e=0;e<o;e++)r.push(this.sphereFunction(-t*Math.PI/i-Math.PI/2,2*-e*Math.PI/o));const n=[];for(let t=0;t<i;t++)for(let e=0;e<o;e++)n.push(o*t+(1+e)%o),n.push(o*t+(0+e)%o),n.push(o*t+o+(1+e)%o),n.push(o*t+o+(0+e)%o),n.push(o*t+o+(1+e)%o),n.push(o*t+(0+e)%o);this.buildMesh(r,n)}sphereFunction(t,e){return new i.Vector4f(Math.cos(t)*Math.cos(e),Math.cos(t)*Math.sin(e),Math.sin(t),1)}}e.Sphere=n},function(t,e,r){"use strict";r.r(e),e.default=r.p+"64c8d0e56a947ade8a449a3ecda79d4b.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"76ae06b027ad8d3a84d87f9801f62db9.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"8a09527b06eeee9b52984520552f3610.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"59b860b8c26e2787d9a2d2c486ccb637.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RotatingGearsScene=void 0;const i=r(8),o=r(0),n=r(20),s=r(18),a=r(42),l=r(44);class c extends s.AbstractScene{constructor(){super(...arguments),this.accumulationBuffer=new Uint32Array(64e3)}init(t){return this.renderingPipeline=new n.FlatShadingRenderingPipeline(t),this.renderingPipeline.setCullFace(i.CullFace.FRONT),Promise.all([l.BlenderLoader.load(r(61)).then(t=>this.gearsMesh=t),a.TextureUtils.load(r(43),!1).then(t=>this.blurred=t),a.TextureUtils.generateProceduralNoise().then(t=>this.noise=t),a.TextureUtils.load(r(51),!0).then(t=>this.hoodlumLogo=t)])}render(t){const e=Date.now();t.fastFramebufferCopy(t.framebuffer,this.blurred.texture),this.drawBlenderScene3(t,e),t.drawTexture(0,75,this.hoodlumLogo,.6);const r=new a.Texture(this.accumulationBuffer,320,200);t.drawTexture(0,0,r,.75),t.fastFramebufferCopy(this.accumulationBuffer,t.framebuffer),t.noise(e,this.noise)}drawBlenderScene3(t,e){t.clearDepthBuffer();const r=o.Matrix4f.constructTranslationMatrix(0,0,-5).multiplyMatrix(o.Matrix4f.constructYRotationMatrix(2e-4*e).multiplyMatrix(o.Matrix4f.constructXRotationMatrix(2e-4*e)));for(let t=0;t<10;t++){const i=.2*Math.sin(2*Math.PI/10*t+.002*e)+.2+.3,n=r.multiplyMatrix(o.Matrix4f.constructTranslationMatrix(0,(t+8e-4*e)%10-5,0).multiplyMatrix(o.Matrix4f.constructYRotationMatrix(.36*t+.0016*e).multiplyMatrix(o.Matrix4f.constructScaleMatrix(i,1,i))));this.renderingPipeline.draw(this.gearsMesh[0],n)}}}e.RotatingGearsScene=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RotoZoomerScene=void 0;const i=r(18),o=r(42);class n extends i.AbstractScene{init(t){return Promise.all([o.TextureUtils.load(r(63),!1).then(t=>this.logoTexture=t)])}render(t){this.drawRotoZoomer(t,this.logoTexture)}drawRotoZoomer(t,e){const r=Math.sin(5e-4*Date.now())+1.1,i=Math.sin(3e-4*Date.now())*r,o=Math.cos(3e-4*Date.now())*r,n=o,s=-i;let a=512*Math.sin(2e-4*Date.now()),l=512*Math.cos(2e-4*Date.now()),c=0,h=0,u=0;for(let r=0;r<200;r++){h=l,c=a;for(let r=0;r<320;r++)t.framebuffer[u++]=e.texture[(63&h)+64*(255&c)],h+=n,c+=s;l+=i,a+=o}}}e.RotoZoomerScene=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ScrollingBackgroundScene=void 0;const i=r(18),o=r(21);class n extends i.AbstractScene{constructor(){super(...arguments),this.startTime=Date.now()}init(t){return Promise.all([o.TextureUtils.load(r(116),!1).then(t=>this.logoTexture=t)])}render(t){const e=Date.now()-this.startTime;this.scrollingBackground(t,this.logoTexture,e)}scrollingBackground(t,e,r){const i=Math.round(-(1-t.interpolate(250,10250,.25*r))*(e.height-200));t.fastFramebufferCopyOffset(t.framebuffer,e.texture,i)}}e.ScrollingBackgroundScene=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SineScrollerScene=void 0;const i=r(7),o=r(26),n=r(28),s=r(18),a=r(21),l=r(52);class c extends s.AbstractScene{init(t){this.startTime=Date.now();this.fontRenderer=new l.FontRenderer(t,32,34,"ABCDEFGHIJKLMNOPQRSTUVWXYZ@+# 0123456789!'()?-/.,",r(270));return this.fontRenderer2=new l.FontRenderer(t,16,18,"ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789*:?!-(),'.+~<>>#// ",r(271)),Promise.all([a.TextureUtils.load(r(51),!0).then(t=>this.texture2=t),this.fontRenderer.init(),this.fontRenderer2.init()])}render(t,e){this.drawStarField(t,e),t.drawTexture(0,0,this.texture2,1),this.fontRenderer.drawText(0,102," # TEAM GENESIS # IS BACK IN 2018 WITH A NEW PC FIRST! 'STAR WARS - EMPIRE AT WAR' DO YOU LIKE THIS?    ",e),this.fontRenderer2.drawText(0,180,"   * WE REALLY LOVE SCROLLERS * HOW ABOUT YOU? THIS PRODUCTION IS FROM HOODLUM~< LETS GO ON WITH THE GENERAL BLAH BLAH      ",1.6*e,!1);for(let r=0;r<20;r++){const i=.003*e,o=r/20*.6,n=.5*(Math.cos(Math.PI*o/.5+i)+1)*255,s=.5*(Math.sin(Math.PI*o/.5+i)+1)*255,a=255<<24|.5*(Math.sin(i)+1)*255<<16|s<<8|n;t.drawRect(16*r,68,16,a),t.drawRect(16*(19-r),168,16,a)}}drawStarField(t,e){const r=new n.default;r.setSeed(666);const s=new Array,a=new Array;for(let t=0;t<100;t++)s.push(new o.Vector2f(320*r.getFloat(),Math.round(100*r.getFloat()+68)));for(let t=0;t<60;t++)a.push(new o.Vector2f(320*r.getFloat(),Math.round(100*r.getFloat()+68)));t.clearColorBuffer(-16777216),t.drawRect2(0,68,320,100,i.Color.DARK_BLUE.toPackedFormat());for(let r=0;r<100;r++)t.drawPixel((s[r].x+.02*e|0)%320,s[r].y,-8355712);for(let r=0;r<60;r++)t.drawPixel((a[r].x+.04*e|0)%320,a[r].y,-1)}}e.SineScrollerScene=c},function(t,e,r){"use strict";r.r(e),e.default=r.p+"1c9a3c7bf86ce3ec74b515b10b9f5f17.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"660539e872dc7488532f602c4b1b9c9b.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StarfieldScene=void 0;const i=r(0),o=r(28),n=r(18);class s extends n.AbstractScene{render(t){this.drawStarField(t,Date.now())}drawStarField(t,e){const r=new o.default;r.setSeed(666);const n=new Array,s=new Array;for(let t=0;t<100;t++)n.push(new i.Vector3f(320*r.getFloat(),Math.round(200*r.getFloat()),0));for(let t=0;t<60;t++)s.push(new i.Vector3f(320*r.getFloat(),Math.round(200*r.getFloat()),0));t.clearColorBuffer(-11059665);for(let r=0;r<100;r++)t.drawPixel((n[r].x+.02*e|0)%320,n[r].y,-8355712);for(let r=0;r<60;r++)t.drawPixel((s[r].x+.04*e|0)%320,s[r].y,-1)}}e.StarfieldScene=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TexturedTorusScene=void 0;const i=r(8),o=r(0),n=r(18),s=r(42),a=r(3);class l extends n.AbstractScene{init(t){return t.setCullFace(i.CullFace.BACK),this.torusMesh=this.computeTexturedTorusMesh(),Promise.all([s.TextureUtils.load(r(49),!0).then(t=>this.texture4=t),s.TextureUtils.load(r(64),!1).then(t=>this.abstract=t),s.TextureUtils.load(r(48),!1).then(t=>this.texture5=t)])}render(t){const e=Date.now();t.setTexture(this.abstract),t.fastFramebufferCopy(t.framebuffer,this.texture5.texture),this.shadingTorus4(t,.001*e),this.cinematicScroller(t,this.texture4,e)}shadingTorus4(t,e){t.clearDepthBuffer();let r=o.Matrix4f.constructScaleMatrix(2.1,2.1,2.1).multiplyMatrix(o.Matrix4f.constructYRotationMatrix(.25*e));r=r.multiplyMatrix(o.Matrix4f.constructXRotationMatrix(.3*e)),r=o.Matrix4f.constructTranslationMatrix(26*Math.sin(.3*e),10*Math.sin(.2*e),-45).multiplyMatrix(r),t.texturedRenderingPipeline.setModelViewMatrix(r),t.texturedRenderingPipeline.draw(this.torusMesh)}torusFunction(t){return new o.Vector3f(10*Math.sin(t),0,10*Math.cos(t))}computeTexturedTorusMesh(){const t=[],e=[];for(let r=0;r<16;r++){const i=this.torusFunction(2*r*Math.PI/15),n=this.torusFunction(2*r*Math.PI/15+.1),s=new o.Vector3f(0,4,0),l=n.sub(i).cross(s);for(let n=0;n<9;n++){const c=s.mul(Math.sin(2*n*Math.PI/8)).add(l.mul(Math.cos(2*n*Math.PI/8))).add(i);t.push(new o.Vector4f(c.x,c.y,c.z));const h=new a.TextureCoordinate;h.u=1/8*n,h.v=1/15*r,e.push(h)}}const r=[];for(let t=0;t<15;t++)for(let e=0;e<8;e++)r.push({uv:[9*t+(1+e),9*t+(0+e),9*t+9+(1+e)],vertices:[9*t+(1+e),9*t+(0+e),9*t+9+(1+e)]}),r.push({uv:[9*t+9+(0+e),9*t+9+(1+e),9*t+(0+e)],vertices:[9*t+9+(0+e),9*t+9+(1+e),9*t+(0+e)]});return{points:t,points2:t.map(()=>new o.Vector4f(0,0,0)),uv:e,faces:r}}cinematicScroller(t,e,r){const i=["","","","","","","","","","","","","","","","","","","","","","","","","","YOU HAVE BEEN WATCHING","","D A R K   M A T T E R","","A JAVASCRIPT DEMO MADE FOR","NORDLICHT 2018","","CREDITS","","CODE BY","TRIGGER","","GRAFICS BY","PREMIUM","","MUSIC BY","VIRGILL"];r*=.6;const o=Math.round(8*t.interpolate(0,250,255&r));for(let n=1;n<25;n++){const s=i[Math.floor(n+r/256)%i.length],a=160-8*s.length/2|0,l=8*n-o;t.drawText(a,l,s,e)}}}e.TexturedTorusScene=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TitanEffectScene=void 0;const i=r(18),o=r(9),n=r(21);class s extends i.AbstractScene{constructor(){super(...arguments),this.accumulationBuffer=new Uint32Array(64e3)}init(t){return this.startTime=Date.now(),Promise.all([n.TextureUtils.load(r(48),!1).then(t=>this.atlantisBackground=t),n.TextureUtils.load(r(51),!0).then(t=>this.hoodlumLogo=t)])}render(t){const e=.004*(Date.now()-this.startTime);t.fastFramebufferCopy(t.framebuffer,this.atlantisBackground.texture);for(let r=0;r<this.hoodlumLogo.width;r++)this.drawVerticalSpan(t,this.hoodlumLogo,r,Math.round(60*Math.sin(.009*r+.9*e+2*Math.PI/4)+100),Math.round(60*Math.sin(.009*r+.9*e+2*Math.PI/4*2)+100),.85*Math.max(0,Math.sin(.009*r+.9*e+2*Math.PI/4*2.5))+.15);const r=new o.Texture(this.accumulationBuffer,320,200);t.drawTexture(0,0,r,.65),t.fastFramebufferCopy(this.accumulationBuffer,t.framebuffer)}drawVerticalSpan(t,e,r,i,o,n=1){const s=Math.abs(o-i),a=e.height/s;let l=0;const c=o>i?320:-320;let h=r+320*i;const u=Math.pow(n,20);for(let i=0;i<s;i++){const i=e.texture[r+Math.round(l)*e.width];let o=(i>>24&255)/255;const s=1-o;o*=n;const f=t.framebuffer[h],d=(f>>0&255)*s+Math.min(255,(i>>0&255)+180*u)*o|0,p=(f>>8&255)*s+Math.min(255,(i>>8&255)+100*u)*o|0,m=(f>>16&255)*s+Math.min(255,(i>>16&255)+100*u)*o|0;t.framebuffer[h]=d|p<<8|m<<16|255<<24,l+=a,h+=c}}}e.TitanEffectScene=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TorusKnotScene=void 0;const i=r(8),o=r(94),n=r(0),s=r(19),a=r(28),l=r(18),c=r(95),h=r(9),u=r(21);class f extends l.AbstractScene{constructor(){super(...arguments),this.torus=new o.TorusKnot}init(t){return t.renderingPipeline.setCullFace(i.CullFace.BACK),t.renderingPipeline.setFog(new c.LinearFog(-160,-380,new n.Vector4f(0,0,0,1))),this.startTime=Date.now(),Promise.all([u.TextureUtils.load(r(118),!1).then(t=>this.rave=t),u.TextureUtils.load(r(119),!1).then(t=>this.micro=t),u.TextureUtils.generateProceduralNoise().then(t=>this.noise=t)])}render(t){const e=Date.now()-this.startTime;this.raveMoview(t,5*e,this.rave),this.glitchScreen(t,e,this.noise),t.drawScaledTextureClipAdd(320-(.13*e|0)%(2*this.micro.width+320),80,2*this.micro.width,2*this.micro.height,this.micro,.5),t.drawScaledTextureClipAdd((.1*e|0)%(this.micro.width+320)-320,40,this.micro.width,this.micro.height,this.micro,.5),t.setCullFace(i.CullFace.BACK),this.shadingTorus5(t,.03*Date.now())}raveMoview(t,e,r){t.fastFramebufferCopyOffset(t.framebuffer,r.texture,-Math.round(e/200)%11*200)}glitchScreen(t,e,r,i=!0){const o=.5*Math.sin(3e-4*e)+.5,n=new a.default;n.setSeed(e/250|0);const s=new h.Texture;s.height=200,s.width=320,s.texture=t.framebuffer;for(let e=0;e<16;e++)for(let r=0;r<10;r++)n.getFloat()>.25||t.drawTextureRect(20*(16-e),20*(16*n.getFloat()|0),20*e,20*r,20,20,s,.1+.35*o);if(i)for(let i=0;i<16;i++)for(let n=0;n<10;n++)t.drawTextureRect(20*i,20*n,Math.round(e/100+i+n)%12*20,0,20,20,r,.1+.3*o);t.fastFramebufferCopy(t.tmpGlitch,t.framebuffer);const l=new a.default;for(let r=0;r<8;r++){let r=Math.round(180*n.getFloat());const i=3+Math.round(20*n.getFloat());l.setSeed(e/250|0);const s=l.getFloat()*o,a=n.getFloat()*o;for(let o=0;o<i;o++){const i=Math.abs(Math.round(25*a)+Math.round(3*l.getFloat())+Math.round(Math.cos(.01*o+.002*e+a)*s*5));let n=320*r,c=320*r+320-i;for(let e=0;e<Math.max(0,i);e++)t.framebuffer[n++]=t.tmpGlitch[c++];c=320*r;const h=320-i;for(let e=0;e<h;e++)t.framebuffer[n++]=t.tmpGlitch[c++];r++}}}shadingTorus5(t,e){t.clearDepthBuffer();let r=s.Matrix4f.constructScaleMatrix(1,1,1).multiplyMatrix(s.Matrix4f.constructYRotationMatrix(.035*e));r=r.multiplyMatrix(s.Matrix4f.constructXRotationMatrix(.04*e));const i=10*e%(6e4/65),o=12*(t.cosineInterpolate(0,15,i)-t.cosineInterpolate(15,200,i)+.4*t.cosineInterpolate(200,300,i)-.4*t.cosineInterpolate(300,400,i));r=s.Matrix4f.constructTranslationMatrix(20*Math.sin(.04*e),8*Math.sin(.05*e)-5*o,-278).multiplyMatrix(r),t.renderingPipeline.draw(this.torus.getMesh(),r)}}e.TorusKnotScene=f},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TorusKnotTunnelScene=void 0;const i=r(8),o=r(94),n=r(19),s=r(4),a=r(18),l=r(95),c=r(9),h=r(21),u=r(28);class f extends a.AbstractScene{constructor(){super(...arguments),this.torusKnot=new o.TorusKnot(!0),this.fog=new l.LinearFog(-50,-240,new s.Vector4f(.67,.4,.5,1))}init(t){return t.renderingPipeline.setCullFace(i.CullFace.FRONT),t.renderingPipeline.setFog(this.fog),Promise.all([h.TextureUtils.generateProceduralNoise().then(t=>this.noise=t),h.TextureUtils.load(r(277),!1).then(t=>this.cocoon=t),h.TextureUtils.generateProceduralParticleTexture2().then(t=>this.particleTexture=t)])}render(t){const e=Date.now();this.torusTunnel(t,.019*e,this.particleTexture),t.drawScaledTextureClipAdd(160-this.cocoon.width/2,100-this.cocoon.height/2,this.cocoon.width,this.cocoon.height,this.cocoon,.67),this.glitchScreen(t,5*e,this.noise)}glitchScreen(t,e,r,i=!0){const o=.9*Math.sin(2e-5*e)+.1,n=new u.default;n.setSeed(e/250|0);const s=new c.Texture;s.height=200,s.width=320,s.texture=t.framebuffer;for(let e=0;e<16;e++)for(let r=0;r<10;r++)n.getFloat()>.25||t.drawTextureRect(20*(16-e),20*(16*n.getFloat()|0),20*e,20*r,20,20,s,.03+.35*o);if(i)for(let i=0;i<16;i++)for(let n=0;n<10;n++)t.drawTextureRect(20*i,20*n,Math.round(e/100+i+n)%12*20,0,20,20,r,.1+.3*o);t.fastFramebufferCopy(t.tmpGlitch,t.framebuffer);const a=new u.default;for(let r=0;r<8;r++){let r=Math.round(180*n.getFloat());const i=3+Math.round(20*n.getFloat());a.setSeed(e/250|0);const s=a.getFloat()*o,l=n.getFloat()*o;for(let o=0;o<i;o++){const i=Math.abs(Math.round(25*l)+Math.round(3*a.getFloat())+Math.round(Math.cos(.01*o+.002*e+l)*s*5));let n=320*r,c=320*r+320-i;for(let e=0;e<Math.max(0,i);e++)t.framebuffer[n++]=t.tmpGlitch[c++];c=320*r;const h=320-i;for(let e=0;e<h;e++)t.framebuffer[n++]=t.tmpGlitch[c++];r++}}}torusTunnel(t,e,r){t.clearDepthBuffer();const i=this.torusFunction3(.02*e),o=this.torusFunction3(.02*e+.4),s=o.sub(i).normalize();let a=i.add(o).normalize();const l=s.cross(a).normalize();a=l.cross(s).normalize();const c=n.Matrix4f.constructIdentityMatrix();c.m14=-i.x,c.m24=-i.y,c.m34=-i.z;const h=n.Matrix4f.constructIdentityMatrix();h.m11=l.x,h.m21=l.y,h.m31=l.z,h.m12=a.x,h.m22=a.y,h.m32=a.z,h.m13=-s.x,h.m23=-s.y,h.m33=-s.z;const u=h.transpose().multiplyMatrix(c);let f=n.Matrix4f.constructScaleMatrix(1,1,1).multiplyMatrix(n.Matrix4f.constructYRotationMatrix(.035*e));f=n.Matrix4f.constructTranslationMatrix(0,0,-10).multiplyMatrix(f.multiplyMatrix(n.Matrix4f.constructXRotationMatrix(.04*e))),f=n.Matrix4f.constructZRotationMatrix(.01*e).multiplyMatrix(u),t.renderingPipeline.draw(this.torusKnot.getMesh(),f)}torusFunction3(t){const e=.5*(2+Math.sin(3*t));return new s.Vector4f(e*Math.cos(2*t),e*Math.cos(3*t),e*Math.sin(2*t)).mul(70)}}e.TorusKnotTunnelScene=f},function(t,e,r){"use strict";r.r(e),e.default=r.p+"7fe555ee73184c72e031821a22f0d544.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TorusScene=void 0;const i=r(8),o=r(25),n=r(19),s=r(18),a=r(21);class l extends s.AbstractScene{constructor(){super(...arguments),this.torus=new o.Torus}init(t){return t.setCullFace(i.CullFace.BACK),Promise.all([a.TextureUtils.load(r(279),!0).then(t=>this.razorLogo=t)])}render(t){const e=.02*Date.now();this.drawTitanEffect(t),this.shadingTorus(t,e),t.drawTexture(32,1,this.razorLogo,1)}shadingTorus(t,e){t.clearDepthBuffer();let r=n.Matrix4f.constructYRotationMatrix(.05*e);r=r.multiplyMatrix(n.Matrix4f.constructXRotationMatrix(.08*e)),r=n.Matrix4f.constructTranslationMatrix(0,0,-24).multiplyMatrix(r),t.renderingPipeline.draw(this.torus.getMesh(),r)}drawTitanEffect(t){t.clear();for(let e=0;e<16;e++)for(let r=0;r<10;r++){const i=(Math.sin(.004*Date.now()+.7*e+.4*r)+1)/2,o=2*Math.round(8*i+1),n=10-o/2|0,s=255<<24|85*i<<16|55*i<<8|55*i;t.drawBox2(20*e+n,20*r+n,o,o,s)}}}e.TorusScene=l},function(t,e,r){"use strict";r.r(e),e.default=r.p+"d3132c4de2ae05ba66ad9637600796c5.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ToxicDotsScene=void 0;const i=r(2),o=r(0),n=r(18);class s extends n.AbstractScene{constructor(){super(...arguments),this.tmp=new Uint32Array(64e3),this.tmp2=new Uint32Array(64e3)}render(t){const e=Date.now();this.blur(t),this.shadingTorus3(t,.003*e)}shadingTorus3(t,e){const r=[];for(let e=0;e<30;e++){const i=t.torusFunction(2*e*Math.PI/30),n=t.torusFunction(2*e*Math.PI/30+.1),s=new o.Vector3f(0,4,0),a=n.sub(i).cross(s);for(let t=0;t<24;t++){const e=s.mul(Math.sin(2*t*Math.PI/24)).add(a.mul(Math.cos(2*t*Math.PI/24))).add(i);r.push(e)}}let n=o.Matrix4f.constructScaleMatrix(1.2,1.2,1.2).multiplyMatrix(o.Matrix4f.constructYRotationMatrix(.09*e));n=n.multiplyMatrix(o.Matrix4f.constructXRotationMatrix(.08*e));const s=new Array;n=o.Matrix4f.constructTranslationMatrix(25*Math.sin(.04*e),9*Math.sin(.05*e),-34).multiplyMatrix(n);for(let t=0;t<r.length;t++){const e=n.multiply(r[t]),i=e.x,a=e.y,l=e.z,c=160+i/(.0078*-l),h=100+a/(.0078*-l);s.push(new o.Vector3f(Math.round(c),Math.round(h),l))}for(let e=0;e<s.length;e++){const r=s[e],o=4290510779;r.x>i.Framebuffer.minWindow.x&&r.x<i.Framebuffer.maxWindow.x&&r.y>i.Framebuffer.minWindow.y&&r.y<i.Framebuffer.maxWindow.y&&t.drawPixel(r.x,r.y,o)}}blur(t){let e,r=0,i=0,o=0,n=321,s=320;for(let a=0;a<198;a++){for(let a=0;a<318;a++)e=t.framebuffer[s],r=255&e,i=e>>8&255,o=e>>16&255,s++,e=t.framebuffer[s],r+=255&e,i+=e>>8&255,o+=e>>16&255,s++,e=t.framebuffer[s],r+=255&e,i+=e>>8&255,o+=e>>16&255,s++,s-=2,r*=1/3.1,i*=1/3.1,o*=1/3.1,this.tmp[n]=r|i<<8|o<<16|255<<24,n++;s+=2,n+=2}n=321,s=1;for(let t=1;t<319;t++){s=t;for(let t=0;t<198;t++)e=this.tmp[s],r=255&e,i=e>>8&255,o=e>>16&255,s+=320,e=this.tmp[s],r+=255&e,i+=e>>8&255,o+=e>>16&255,s+=320,e=this.tmp[s],r+=255&e,i+=e>>8&255,o+=e>>16&255,s+=320,s-=640,r*=1/3.1,i*=1/3.1,o*=1/3.1,this.tmp2[n]=r|i<<8|o<<16|255<<24,n+=320;n+=-63359}t.fastFramebufferCopy(t.framebuffer,this.tmp2)}}e.ToxicDotsScene=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TwisterScene=void 0;const i=r(18),o=r(21);class n extends i.AbstractScene{init(t){return Promise.all([o.TextureUtils.load(r(48),!1).then(t=>this.backgroundTexture=t),o.TextureUtils.load(r(63),!1).then(t=>this.logoTexture=t)])}render(t){const e=Date.now();t.fastFramebufferCopy(t.framebuffer,this.backgroundTexture.texture),this.draw(t,this.logoTexture,e)}draw(t,e,r){const i=.001*r;for(let r=10;r<190;r++){const o=50*Math.sin(i+.01*r)|0,n=Math.sin(.4*i+.0021*r)*Math.PI*2;let s=32;const a=Math.sin(n)*s|0,l=Math.sin(2*Math.PI/4+n)*s|0,c=Math.sin(2*Math.PI/4*2+n)*s|0,h=Math.sin(2*Math.PI/4*3+n)*s|0;if(l>a){s=Math.max(0,Math.sin(2*Math.PI/4*1.5+n));const i=l-a,c=a+120+o;this.drawSpan(t,i,c,r,s,e)}if(c>l){s=Math.max(0,Math.sin(2*Math.PI/4*2.5+n));const i=c-l,a=l+120+o;this.drawSpan(t,i,a,r,s,e)}if(h>c){s=Math.max(0,Math.sin(2*Math.PI/4*3.5+n));const i=h-c,a=c+120+o;this.drawSpan(t,i,a,r,s,e)}if(a>h){s=Math.max(0,Math.sin(2*Math.PI/4*4.5+n));const i=a-h,l=h+120+o;this.drawSpan(t,i,l,r,s,e)}}}drawSpan(t,e,r,i,o,n){let s=r+320*i,a=(255&(i-.029*Date.now()|0))*n.width;const l=n.width/e,c=115*Math.pow(o,11);for(let r=0;r<e;r++){const e=n.texture[0|a],r=Math.min((e>>0&255)*o+c,255),i=Math.min((e>>8&255)*o+c,255),h=Math.min((e>>16&255)*o+c,255);t.framebuffer[s]=r|i<<8|h<<16|255<<24,s++,a+=l}}}e.TwisterScene=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VoxelBallsScene=void 0;const i=r(7),o=r(8),n=r(54),s=r(0),a=r(20),l=r(18),c=r(42);let h=(()=>{class t extends l.AbstractScene{constructor(){super(...arguments),this.cubeMesh=new n.Cube,this.accumulationBuffer=new Uint32Array(64e3)}init(t){return t.setCullFace(o.CullFace.BACK),this.renderingPipeline=new a.FlatShadingRenderingPipeline(t),Promise.all([c.TextureUtils.load(r(43),!1).then(t=>this.blurred=t)])}render(t){t.fastFramebufferCopy(t.framebuffer,this.blurred.texture);Date.now();t.clearDepthBuffer();for(let t=0;t<5;t++)for(let e=0;e<5;e++)for(let r=0;r<5;r++){let i=.5*(Math.sin(.3*t+9e-4*Date.now())+1)*(Math.sin(.4*e+.002*Date.now())+1)*.5*(Math.sin(.3*r+.001*Date.now())+1)*.5;i=.8;const o=s.Matrix4f.constructTranslationMatrix(0,0,-11).multiplyMatrix(s.Matrix4f.constructYRotationMatrix(3e-4*Date.now()).multiplyMatrix(s.Matrix4f.constructXRotationMatrix(5e-4*Date.now()).multiplyMatrix(s.Matrix4f.constructZRotationMatrix(4e-4*Date.now()).multiplyMatrix(s.Matrix4f.constructTranslationMatrix(t-2.5+.5,e-2.5+.5,r-2.5+.5).multiplyMatrix(s.Matrix4f.constructScaleMatrix(i,i,i))))));this.renderingPipeline.draw(this.cubeMesh.getMesh(),o)}const e=new c.Texture(this.accumulationBuffer,320,200);t.drawTextureFullscreen(e,.75),t.fastFramebufferCopy(this.accumulationBuffer,t.framebuffer)}}return t.BACKGROUND_COLOR=i.Color.YELLOW.toPackedFormat(),t})();e.VoxelBallsScene=h},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VoxelLandScapeFadeScene=void 0;const i=r(18),o=r(42);class n extends i.AbstractScene{constructor(){super(...arguments),this.MAP_BIT_SIZE=8,this.RENDERWIDTH=320,this.RENDERHEIGHT=200,this.RENDERLENGTH=this.RENDERWIDTH*this.RENDERHEIGHT,this.MAPWIDTH=1<<this.MAP_BIT_SIZE,this.MAPWIDTH_MIN_1=this.MAPWIDTH-1,this.MAPSIZE=this.MAPWIDTH*this.MAPWIDTH,this.sinTable=[3600],this.cosTable=[3600],this.heightMap=new Uint32Array(this.MAPSIZE),this.texelMap=new Uint32Array(this.RENDERLENGTH),this.colorLut=new Uint32Array(65536),this.playerX=20,this.playerY=0,this.playerZ=2048e3,this.playerDistance=567296,this.playerSpeed=1,this.playerAngle=0,this.angleSpeed=0,this.viewportHeight=0}init(t){return Promise.all([o.TextureUtils.load(r(284),!1).then(t=>this.voxelmap=t),o.TextureUtils.load(r(285),!0).then(t=>this.colormap=t)])}onInit(){this.setup()}render(t){this.playerAngle+=this.angleSpeed,this.playerAngle<0?this.playerAngle+=3600:this.playerAngle>=3600&&(this.playerAngle-=3600),this.playerX+=3600,this.playerY+=0,this.renderVoxel(this.playerX,this.playerY,this.playerZ,this.playerAngle,this.playerDistance,t)}setup(){this.texelMap=this.colormap.texture;let t=0;do{const e=255&this.voxelmap.texture[t];this.heightMap[t]=e<<12}while(++t<this.MAPSIZE);for(let t=0;t<3600;t++)this.sinTable[t]=this.toFP(Math.sin(2*Math.PI*t/3600)),this.cosTable[t]=this.toFP(Math.cos(2*Math.PI*t/3600));for(let t=0;t<256;t++)for(let e=0;e<256;e++){const r=(t<<8)+e,i=t*e/256;this.colorLut[r]=Math.round(i)}}toFP(t){const e=Math.abs(t),r=Math.round(e);let i=(r<<12)+(Math.round(1e4*(e-r))<<12)/1e4;return t<0&&(i*=-1),i}renderVoxel(t,e,r,i,o,n){n.clearColorBuffer(0);let s=i-(this.RENDERWIDTH>>1);s<0&&(s+=3600);let a=0;const l=r-this.viewportHeight,c=o/20008;do{const i=this.RENDERLENGTH-this.RENDERWIDTH+a,h=this.cosTable[s],u=this.sinTable[s],f=r,d=t,p=e,m=0,x=l/o<<12;this.iterate(p,d,f,x,u,h,m,c,i,256,n),++s>=3600&&(s=0)}while(++a<this.RENDERWIDTH)}iterate(t,e,r,i,o,n,s,a,l,c,h){for(let u=0;u<c;u++){t+=o,r-=i,s+=a;const c=(e+=n)>>11&this.MAPWIDTH_MIN_1,f=((t>>11&this.MAPWIDTH_MIN_1)<<this.MAP_BIT_SIZE)+c,d=this.heightMap[f]>>2;let p;for(p=this.blend(this.texelMap[f],4278190080,u);d>r;)h.framebuffer[l]=p,l-=this.RENDERWIDTH,i-=a,r+=s;if(l<0)break}}blend(t,e,r){if(0===r)return t;if(255===r)return e;const i=255-r;return 4278190080|((16711680&e)>>16)*r+((16711680&t)>>16)*i>>8<<16|((65280&e)>>8)*r+((65280&t)>>8)*i>>8<<8|(255&e)*r+(255&t)*i>>8}blend32(t,e,r){const i=(16711680&t)>>16,o=(16711680&e)>>16,n=(65280&t)>>8,s=(65280&e)>>8,a=255&t,l=255&e;return 4278190080+(this.colorLut[255-r+(i<<8)]+this.colorLut[(o<<8)+r]<<16)+(this.colorLut[255-r+(n<<8)]+this.colorLut[(s<<8)+r]<<8)+(this.colorLut[255-r+(a<<8)]+this.colorLut[(l<<8)+r])}}e.VoxelLandScapeFadeScene=n},function(t,e,r){"use strict";r.r(e),e.default=r.p+"dd3a76db78db155762215467687f3cf7.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"8bcbbc698090a5deaafb4f7e39b0a999.png"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VoxelLandscapeScene=void 0;const i=r(18),o=r(21);class n extends i.AbstractScene{init(t){return Promise.all([o.TextureUtils.load(r(120),!0).then(t=>this.texture2=t),o.TextureUtils.load(r(56),!1).then(t=>this.heightmap=t),o.TextureUtils.load(r(64),!1).then(t=>this.abstract=t)])}render(t){const e=Date.now();this.drawVoxelLandscape3(t,this.heightmap,e),t.drawTexture(32,1,this.texture2,1)}drawVoxelLandscape2(t,e,r){t.clearColorBuffer(255<<24);const i=.008*r;for(let o=0;o<320;o++){const n=.4*Math.cos(5e-4*r+.005*o),s=.4*Math.sin(5e-4*r+.005*o);let a=0,l=i+45*n,c=0+45*s;for(let r=45;r<200;r++){const i=e.getBilinearFilteredPixel(l,c),h=Math.round(125.7*(i-260)/r+300),u=Math.round(i)*Math.min(1,10*(1-(r-45)/155)),f=255<<24|u+10<<16|u+20<<8|u+13;if(h>a){let e=o+320*(199-a);const r=Math.min(h,200);for(let i=a;i<r;i++)t.framebuffer[e]=f,e-=320;if(200===r)break;a=h}l+=n,c+=s}}}drawVoxelLandscape3(t,e,r){t.clearColorBuffer(255<<24);const i=.008*r;for(let o=0;o<320;o++){const n=.4*Math.cos(5e-4*r+.0018*o),s=.4*Math.sin(5e-4*r+.0018*o);let a=0,l=i+35*n,c=0+35*s;for(let r=35;r<300;r++){const i=255&e.getPixel(e,l,c),h=Math.round(45*(i-480)/r+300),u=e.getPixel(this.abstract,l,c)|255<<24;if(h>a){let e=o+320*(199-a);const r=Math.min(h,200);for(let i=a;i<r;i++)t.framebuffer[e]=u,e-=320;if(200===r)break;a=h}l+=n,c+=s}}}}e.VoxelLandscapeScene=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WavefrontScene=void 0;const i=r(7),o=r(8),n=r(0),s=r(65),a=r(18),l=r(24),c=r(21),h=r(53);let u=(()=>{class t extends a.AbstractScene{constructor(){super(...arguments),this.modelViewMatrix=new h.ModelViewMatrix,this.fpsStartTime=Date.now(),this.fpsCount=0,this.fps=0}init(t){t.renderingPipeline.setCullFace(o.CullFace.BACK);const e=new l.PointLight;e.ambientIntensity=new n.Vector4f(1,1,1,1),e.diffuseIntensity=new n.Vector4f(1,.5,1,1),e.specularIntensity=new n.Vector4f(.5,.5,.7,1),e.position=new n.Vector4f(0,-10,-1,1);const i=new l.PointLight;return i.ambientIntensity=new n.Vector4f(0,0,1,1),i.diffuseIntensity=new n.Vector4f(0,.6,0,1),i.specularIntensity=new n.Vector4f(.8,.8,.8,1),i.position=new n.Vector4f(3,0,-2,1),t.renderingPipeline.setLights([e,i]),this.startTime=Date.now(),Promise.all([s.WavefrontLoader.load(r(121)).then(t=>this.meshes=t),c.TextureUtils.load(r(49),!0).then(t=>this.texture4=t)])}render(e){const r=Date.now();r>this.fpsStartTime+1e3&&(this.fpsStartTime=r,this.fps=this.fpsCount,this.fpsCount=0),this.fpsCount++;const i=Date.now()-this.startTime;e.clearColorBuffer(t.CLEAR_COLOR),e.clearDepthBuffer(),this.computeCameraMovement(.6*i),e.renderingPipeline.draw(this.meshes[0],this.modelViewMatrix.getMatrix()),e.drawText(8,8,"FPS: "+this.fps.toString(),this.texture4),e.drawText(8,16,"FACES: "+this.meshes[0].faces.length,this.texture4)}computeCameraMovement(t){this.modelViewMatrix.setIdentity(),this.modelViewMatrix.trans(0,0,-5),this.modelViewMatrix.yRotate(.002*-t),this.modelViewMatrix.xRotate(.002*-t)}}return t.CLEAR_COLOR=i.Color.SLATE_GRAY.toPackedFormat(),t})();e.WavefrontScene=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WaveFrontTextureScene=void 0;const i=r(7),o=r(8),n=r(0),s=r(65),a=r(18),l=r(42);class c extends a.AbstractScene{init(t){return t.setCullFace(o.CullFace.FRONT),Promise.all([l.TextureUtils.load(r(289),!1).then(t=>this.platonian=t),s.WavefrontLoader.loadWithTexture(r(290)).then(t=>this.platonianMesh=t)])}render(t){const e=Date.now();t.clearColorBuffer(i.Color.BLACK.toPackedFormat()),t.clearDepthBuffer(),t.setTexture(this.platonian),t.texturedRenderingPipeline.setModelViewMatrix(this.getModelViewMatrix(e)),t.texturedRenderingPipeline.drawMeshArray(this.platonianMesh)}getModelViewMatrix(t){return n.Matrix4f.constructTranslationMatrix(18,2,-74).multiplyMatrix(n.Matrix4f.constructYRotationMatrix(6e-4*-t)).multiplyMatrix(n.Matrix4f.constructScaleMatrix(8,8,8))}}e.WaveFrontTextureScene=c},function(t,e,r){"use strict";r.r(e),e.default=r.p+"589319aa5c4a30e56fa6249cf9168e9a.png"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"a753b7dc724e5821b114e35828c23655.obj"},,,,,,,,,,,function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(30),o=r(302);(class{static main(){const t=new i.Canvas(320,200,new o.DemoScene);t.appendTo(document.getElementById("aisa")),t.init()}}).main()},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DemoScene=void 0;const i=r(18),o=r(42),n=r(303),s=r(133),a=r(135),l=r(137),c=r(138),h=r(139),u=r(142),f=r(144),d=r(146),p=r(145),m=r(147),x=r(148),M=r(149),w=r(151),b=r(152),g=r(153),y=r(158),T=r(159),v=r(160),P=r(163),S=r(164),C=r(166),_=r(168),R=r(169),F=r(170),I=r(238),V=r(239),A=r(240),j=r(243),z=r(244),D=r(246),B=r(248),O=r(249),E=r(250),k=r(252),L=r(253),U=r(258),N=r(266),W=r(267),G=r(268),K=r(269),H=r(272),Y=r(273),X=r(122),Z=r(274),q=r(275),J=r(276),Q=r(278),$=r(280),tt=r(281),et=r(282),rt=r(283),it=r(286),ot=r(287),nt=r(288),st=r(307);class at extends i.AbstractScene{constructor(){super(...arguments),this.BPM=120,this.ROWS_PER_BEAT=8,this.ROW_RATE=this.BPM/60*this.ROWS_PER_BEAT,this._demoMode=!0,this.FOV=50,this._row=0,this.tickerPointer=document.getElementById("ticker_pointer")}init(t){this.sm=new n.SoundManager,this.statsMEM=new st,this.statsMEM.showPanel(0),this.statsMEM.dom.style.cssText="position:absolute;top:0px;left:640px;",document.body.appendChild(this.statsMEM.dom),this.statsFPS=new st,this.statsFPS.showPanel(2),this.statsFPS.dom.style.cssText="position:absolute;top:50px;left:640px;",document.body.appendChild(this.statsFPS.dom);const e=document.getElementById("ticker"),i=document.getElementById("ticker_play"),at=document.getElementById("ticker_pause");return i.addEventListener("click",()=>{this.onPlay()}),at.addEventListener("click",()=>{this.onPause()}),e.addEventListener("click",t=>{const r=t.offsetX*this.sm._audio.duration/e.getBoundingClientRect().width;this.sm._audio.currentTime=r,this._demoMode||this.sm._syncDevice.update(this.sm._audio.currentTime*this.ROW_RATE)}),this.abscractCubeScene=new s.AbstractCube,this.BakedLighting=new a.BakedLighting,this.BlockFade=new l.BlockFade,this.Bobs=new c.Bobs,this.BumpMap=new h.BumpMap,this.BunnyScene=new u.BunnyScene,this.CinematicScroller=new f.CinematicScroller,this.CubeScene=new d.CubeScene,this.CubeTunnelScene=new p.CubeTunnelScene,this.DifferentMd2ModelScene=new m.DifferentMd2ModelScene,this.DistortedSphereScene=new x.DistortedSphereScene,this.DofBallsScene=new M.DofBallsScene,this.FloodFillScene=new w.FloodFillScene,this.FloorScene=new b.FloorScene,this.FrustumCullingScene=new g.FrustumCullingScene,this.Gears2Scene=new y.Gears2Scene,this.GearsScene=new T.GearsScene,this.HoodlumScene=new v.HoodlumScene,this.LedPlasmaScene=new P.LedPlasmaScene,this.lensScene=new S.LensScene,this.Md2ModelScene=new C.Md2ModelScene,this.MetaballsScene=new _.MetaballsScene,this.metalHeadzScene=new R.MetalHeadzScene,this.Mode7Scene=new F.Mode7Scene,this.MovingTorusScene=new I.MovingTorusScene,this.ParticleStreamsScene=new V.ParticleStreamsScene,this.ParticleSystemScene=new A.ParticleSystemScene,this.ParticleTorusScene=new j.ParticleTorusScene,this.PixelEffectScene=new z.PixelEffectScene,this.PlaneDeformationAbstractScene=new D.PlaneDeformationAbstractScene,this.PlanedeformationTunnelScene=new B.PlanedeformationTunnelScene,this.PlanedeformationTunnelScene=new B.PlanedeformationTunnelScene,this.PlasmaScene=new O.PlasmaScene,this.PlatonianScene=new E.PlatonianScene,this.PolarVoxelsScene=new k.PolarVoxelsScene,this.PortalScene=new L.PortalScene,this.RazorScene=new U.RazorScene,this.RotatingGearsScene=new N.RotatingGearsScene,this.RotoZoomerScene=new W.RotoZoomerScene,this.ScrollingBackgroundScene=new G.ScrollingBackgroundScene,this.sineScrollerScene=new K.SineScrollerScene,this.StarfieldScene=new H.StarfieldScene,this.TexturedTorusScene=new Y.TexturedTorusScene,this.ThirdPersonCameraScene=new X.ThirdPersonCameraScene,this.TitanEffectScene=new Z.TitanEffectScene,this.TorusKnotScene=new q.TorusKnotScene,this.TorusKnotTunnelScene=new J.TorusKnotTunnelScene,this.TorusScene=new Q.TorusScene,this.ToxicDotsScene=new $.ToxicDotsScene,this.TwisterScene=new tt.TwisterScene,this.VoxelBallsScene=new et.VoxelBallsScene,this.VoxelLandScapeFadeScene=new rt.VoxelLandScapeFadeScene,this.VoxelLandscapeScene=new it.VoxelLandscapeScene,this.WavefrontScene=new ot.WavefrontScene,this.WaveFrontTextureScene=new nt.WaveFrontTextureScene,Promise.all([this.sm.loadOgg(r(308).default),this.prepareSync(),this.abscractCubeScene.init(t),this.lensScene.init(t),this.sineScrollerScene.init(t),this.metalHeadzScene.init(t),this.ScrollingBackgroundScene.init(t),this.BumpMap.init(t),this.BakedLighting.init(t),this.BlockFade.init(t),this.Bobs.init(t),this.BunnyScene.init(t),this.CinematicScroller.init(t),this.CubeScene.init(t),this.CubeTunnelScene.init(t),this.ThirdPersonCameraScene.init(t),this.DistortedSphereScene.init(t),this.DofBallsScene.init(t),this.FloodFillScene.init(t),this.FloorScene.init(t),this.FrustumCullingScene.init(t),this.GearsScene.init(t),this.Gears2Scene.init(t),this.HoodlumScene.init(t),this.LedPlasmaScene.init(t),this.MetaballsScene.init(t),this.Mode7Scene.init(t),this.MovingTorusScene.init(t),this.ParticleStreamsScene.init(t),this.ParticleSystemScene.init(t),this.ParticleTorusScene.init(t),this.PixelEffectScene.init(t),this.PlaneDeformationAbstractScene.init(t),this.PlanedeformationTunnelScene.init(t),this.PlasmaScene.init(t),this.PlatonianScene.init(t),this.PolarVoxelsScene.init(t),this.PortalScene.init(t),this.RazorScene.init(t),this.RotatingGearsScene.init(t),this.RotoZoomerScene.init(t),this.ScrollingBackgroundScene.init(t),this.StarfieldScene.init(t),this.TexturedTorusScene.init(t),this.TitanEffectScene.init(t),this.TorusScene.init(t),this.TorusKnotScene.init(t),this.TorusKnotTunnelScene.init(t),this.ToxicDotsScene.init(t),this.PlanedeformationTunnelScene.init(t),this.TwisterScene.init(t),this.VoxelBallsScene.init(t),this.VoxelLandscapeScene.init(t),this.VoxelLandScapeFadeScene.init(t),this.WavefrontScene.init(t),this.WaveFrontTextureScene.init(t),o.TextureUtils.load(r(49),!0).then(t=>this.bmpFont=t)]).then(()=>{})}render(t){if(!this.sm._syncDevice.connected&&!this._demoMode)return void t.drawText(8,18,"Rocket not connected".toUpperCase(),this.bmpFont);const e=this.sm._audio.currentTime,r=1e3*e;switch(this._row=e*this.ROW_RATE,this._currentEffect=this._effect.getValue(this._row).toFixed(1),!1===this.sm._audio.paused&&this.sm._syncDevice.update(this._row),this.tickerPointer.style.left=100*e/this.sm._audio.duration+"%",t.clearColorBuffer(0),Number(this._currentEffect)){case 1:this.metalHeadzScene.render(t,r);break;case 1.5:this.BlockFade.render(t);case 2:this.abscractCubeScene.render(t,r);break;case 3:this.sineScrollerScene.render(t,r),t.fastFramebufferCopy(this.lensScene.textureBackground.texture,t.framebuffer),this.lensScene.render(t,r);break;case 4:this.DofBallsScene.render(t);break;case 5:this.ScrollingBackgroundScene.render(t);break;case 6:this.BakedLighting.render(t);break;case 7:this.BlockFade.render(t);break;case 8:this.Bobs.render(t);break;case 9:this.BunnyScene.render(t);break;case 10:this.CubeScene.render(t);break;case 11:this.CubeTunnelScene.render(t);break;case 12:this.FloodFillScene.render(t);break;case 13:this.CinematicScroller.render(t);break;case 14:this.FloorScene.render(t);break;case 15:this.FrustumCullingScene.render(t);break;case 16:this.GearsScene.render(t);break;case 17:this.Gears2Scene.render(t);break;case 18:this.HoodlumScene.render(t);break;case 19:this.LedPlasmaScene.render(t);break;case 20:this.MetaballsScene.render(t);break;case 21:this.MovingTorusScene.render(t);break;case 22:this.ParticleStreamsScene.render(t);break;case 23:this.ParticleSystemScene.render(t);break;case 24:this.ParticleTorusScene.render(t);break;case 25:this.PixelEffectScene.render(t);break;case 26:this.PlaneDeformationAbstractScene.render(t);break;case 27:this.PlanedeformationTunnelScene.render(t);break;case 28:this.PlasmaScene.render(t);break;case 29:this.PlatonianScene.render(t);break;case 30:this.PolarVoxelsScene.render(t);break;case 31:this.RazorScene.render(t);break;case 32:this.RotatingGearsScene.render(t);break;case 33:this.RotoZoomerScene.render(t);break;case 34:this.StarfieldScene.render(t);break;case 35:this.TexturedTorusScene.render(t);break;case 36:this.TitanEffectScene.render(t);break;case 37:this.TorusScene.render(t);break;case 38:this.TorusKnotScene.render(t);break;case 39:this.TorusKnotTunnelScene.render(t);break;case 40:this.TwisterScene.render(t);break;case 41:this.VoxelBallsScene.render(t);break;case 42:this.VoxelLandscapeScene.render(t);break;case 43:this.sineScrollerScene.render(t,r);break;default:this.sineScrollerScene.render(t,r)}}drawStats(t){t.drawText(8,18,"ROCKET TIME: "+this.sm._audio.currentTime.toFixed(2),this.bmpFont),t.drawText(8,36,"ROTATION: "+this._cameraRotation.getValue(this._row).toFixed(0),this.bmpFont),t.drawText(8,54,"EFFECT: "+this._currentEffect,this.bmpFont),this.statsFPS.update(),this.statsMEM.update()}prepareSync(){console.info("this._syncDevice",this.sm._syncDevice),this._demoMode?(this.sm._syncDevice.setConfig({rocketXML:r(309).default}),this.sm._syncDevice.init("demo")):this.sm._syncDevice.init(),this.sm._syncDevice.on("ready",()=>this.onSyncReady()),this.sm._syncDevice.on("update",t=>this.onSyncUpdate(t)),this.sm._syncDevice.on("play",()=>this.onPlay()),this.sm._syncDevice.on("pause",()=>this.onPause())}onSyncReady(){console.info("onSyncReady",this.sm._syncDevice),this.sm._syncDevice.connected=!0,this._effect=this.sm._syncDevice.getTrack("effect"),this._snare=this.sm._syncDevice.getTrack("snare"),this._bass=this.sm._syncDevice.getTrack("bass"),this._cameraRotation=this.sm._syncDevice.getTrack("rotation"),this._cameraDistance=this.sm._syncDevice.getTrack("distance"),this._fov=this.sm._syncDevice.getTrack("FOV")}onSyncUpdate(t){isNaN(t)||(this._row=t),this.sm._audio.currentTime=t/this.ROW_RATE}onPlay(){this.sm._audio.currentTime=this._row/this.ROW_RATE,this.sm._audio.play(),console.log("[onPlay] time in seconds",this.sm._audio.currentTime)}onPause(){console.info("[onPause]"),this._row=this.sm._audio.currentTime*this.ROW_RATE,this.sm._audio.pause()}}e.DemoScene=at},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SoundManager=void 0,r(304),r(305),r(306);e.SoundManager=class{constructor(){this._syncDevice=new JSRocket.SyncDevice,this._audio=new Audio,XMPlayer.init(),this.audioContext=XMPlayer.audioctx,this._syncDevice=new JSRocket.SyncDevice,this._syncDevice.connected=!1}playExtendedModule(t){return fetch(t).then(t=>t.arrayBuffer()).then(e=>{e?(XMPlayer.load(e),XMPlayer.play()):console.log("unable to load",t)})}playOgg(t){return fetch(t).then(t=>t.arrayBuffer()).then(e=>{e?this.audioContext.decodeAudioData(e,t=>{const e=this.audioContext.createBufferSource();console.info("ogg create buffer"),e.buffer=t,e.connect(this.audioContext.destination),console.info("ogg connect"),e.loop=!0,e.start(this.audioContext.currentTime),console.info("ogg ready")}):console.log("unable to load",t)})}loadOgg(t){return fetch(t).then(e=>{this._audio.src=t,this._audio.load(),this._audio.preload="true",this._audio.loop=!0})}}},function(t,e){!function(t){t.XMPlayer||(t.XMPlayer={});var e=t.XMPlayer;t.XMView||(t.XMView={});var r=t.XMView;e.periodForNote=f,e.prettify_effect=l,e.init=T,e.load=function(t){var r=new DataView(t);e.xm={},e.xm.songname=h(r,17,20);var i=r.getUint32(60,!0)+60,o=r.getUint16(64,!0);e.xm.song_looppos=r.getUint16(66,!0),e.xm.nchan=r.getUint16(68,!0);var n,s,l,c=r.getUint16(70,!0),u=r.getUint16(72,!0);for(e.xm.flags=r.getUint16(74,!0),e.xm.tempo=r.getUint16(76,!0),e.xm.bpm=r.getUint16(78,!0),e.xm.channelinfo=[],e.xm.global_volume=e.max_global_volume,n=0;n<e.xm.nchan;n++)e.xm.channelinfo.push({number:n,filterstate:new Float32Array(3),vol:0,pan:128,period:1152,vL:0,vR:0,vLprev:0,vRprev:0,mute:0,volE:0,panE:0,retrig:0,vibratopos:0,vibratodepth:1,vibratospeed:1,vibratotype:0});for(console.log("header len "+i),console.log("songlen %d, %d channels, %d patterns, %d instruments",o,e.xm.nchan,c,u),console.log("loop @%d",e.xm.song_looppos),console.log("flags=%d tempo %d bpm %d",e.xm.flags,e.xm.tempo,e.xm.bpm),e.xm.songpats=[],n=0;n<o;n++)e.xm.songpats.push(r.getUint8(80+n));console.log("song patterns: ",e.xm.songpats);var f=i;for(e.xm.patterns=[],n=0;n<c;n++){var d=[],m=(r.getUint32(f,!0),r.getUint16(f+5,!0)),x=r.getUint16(f+7,!0);for(console.log("pattern %d: %d bytes, %d rows",n,x,m),f+=9,s=0;x>0&&s<m;s++){for(row=[],l=0;l<e.xm.nchan;l++){var M=r.getUint8(f);f++;var w=-1,b=-1,T=-1,v=0,P=0;128&M?(1&M&&(w=r.getUint8(f)-1,f++),2&M&&(b=r.getUint8(f),f++),4&M&&(T=r.getUint8(f),f++),8&M&&(v=r.getUint8(f),f++),16&M&&(P=r.getUint8(f),f++)):(w=M-1,b=r.getUint8(f),f++,T=r.getUint8(f),f++,v=r.getUint8(f),f++,P=r.getUint8(f),f++);var S=[w,b,T,v,P];row.push(S)}d.push(row)}e.xm.patterns.push(d)}for(e.xm.instruments=[],n=0;n<u;n++){var C=r.getUint32(f,!0),_=h(r,f+4,22),R=r.getUint16(f+27,!0);b={name:_,number:n};if(R>0){var F=new Uint8Array(t,f+33,96),I=r.getUint8(f+225),V=r.getUint8(f+233),A=r.getUint8(f+227),j=r.getUint8(f+228),z=r.getUint8(f+229),D=r.getUint8(f+226),B=r.getUint8(f+234),O=r.getUint8(f+230),E=r.getUint8(f+231),k=r.getUint8(f+232),L=r.getUint16(f+239,!0),U=[];for(s=0;s<2*I;s++)U.push(r.getUint16(f+129+2*s,!0));var N=[];for(s=0;s<2*D;s++)N.push(r.getUint16(f+177+2*s,!0));var W=r.getUint32(f+29,!0);console.log("hdrsiz %d; instrument %s: '%s' %d samples, samphdrsiz %d",C,(n+1).toString(16),_,R,W),f+=C;var G=0,K=[];for(s=0;s<R;s++){var H=r.getUint32(f,!0),Y=r.getUint32(f+4,!0),X=r.getUint32(f+8,!0),Z=r.getUint8(f+12),q=r.getInt8(f+13),J=r.getUint8(f+14),Q=r.getUint8(f+15),$=r.getInt8(f+16),tt=h(r,f+18,22),et=G;0===X&&(J&=-4),console.log("sample %d: len %d name '%s' loop %d/%d vol %d offset %s",s,H,tt,Y,X,Z,et.toString(16)),console.log("           type %d note %s(%d) finetune %d pan %d",J,a($+48),$,q,Q),console.log("           vol env",U,A,j,z,"type",V,"fadeout",L),console.log("           pan env",N,O,E,k,"type",B);var rt={len:H,loop:Y,looplen:X,note:$,fine:q,pan:Q,type:J,vol:Z,fileoffset:et};K.push(rt),f+=W,G+=H}for(s=0;s<R;s++){(rt=K[s]).sampledata=g(new Uint8Array(t,f+rt.fileoffset,rt.len),16&rt.type),16&rt.type&&(rt.len/=2,rt.loop/=2,rt.looplen/=2),3&rt.type&&(rt.looplen<2048||2&rt.type)&&y(rt)}if(f+=G,b.samplemap=F,b.samples=K,V){var it=U[U.length-2];if(2&V||(A=U.length/2),L>0){var ot=65536/L;U.push(it+ot),U.push(0)}b.env_vol=new p(U,V,A,j,z)}else b.env_vol=new p([0,64,1,0],2,0,0,0);B?(2&B||(O=N.length/2),b.env_pan=new p(N,B,O,E,k)):b.env_pan=new p([0,32],0,0,0,0)}else f+=C,console.log("empty instrument",n,C,f);e.xm.instruments.push(b)}return console.log('loaded "'+e.xm.songname+'"'),!0},e.play=function(){if(!e.playing){r.resume&&r.resume(),i.connect(o);var t=e.audioctx.createOscillator();t.connect(e.audioctx.destination),t.start?t.start(0):t.noteOn(0),t.stop?t.stop(0):t.noteOff(0),t.disconnect()}e.playing=!0},e.pause=function(){e.playing&&(i.disconnect(o),r.pause&&r.pause());e.playing=!1},e.stop=function(){e.playing&&(i.disconnect(o),e.playing=!1);e.cur_pat=-1,e.cur_row=64,e.cur_songpos=-1,e.cur_ticksamp=0,e.xm.global_volume=e.max_global_volume,r.stop&&r.stop();T()},e.cur_songpos=-1,e.cur_pat=-1,e.cur_row=64,e.cur_ticksamp=0,e.cur_tick=6,e.xm={},e.xm.global_volume=e.max_global_volume=128,e.nextTick=x,e.nextRow=d,e.Envelope=p;var i,o,n=["C-","C#","D-","D#","E-","F-","F#","G-","G#","A-","A#","B-"],s=44100;function a(t){return t<0?"---":96==t?"^^^":n[t%12]+~~(t/12)}function l(t,e){return t>=10&&(t=String.fromCharCode(55+t)),t+(e=e<16?"0"+e.toString(16):e.toString(16))}function c(t){return a(t[0])+" "+((-1==(e=t[1])?"--":e<10?"0"+e:e)+" ")+function(t){return t<16?"--":t.toString(16)}(t[2])+" "+l(t[3],t[4]);var e}function h(t,e,r){for(var i=[],o=e;o<e+r;o++){var n=t.getUint8(o);if(0===n)break;i.push(String.fromCharCode(n))}return i.join("")}function u(t,e){var r=8363*Math.pow(2,(1152-e)/192);isNaN(r)?console.log("invalid period!",e):(t.doff=r/s,t.filter=function(t){t>.5&&(t=.5);var e=Math.sqrt(2)*Math.PI*t,r=Math.exp(-e),i=r*Math.cos(e);return[(1-2*i+r*r)/2,2*i,-r*r]}(t.doff/2))}function f(t,e){return 1920-16*(e+t.samp.note)-t.fine/8}function d(){void 0===e.next_row&&(e.next_row=e.cur_row+1),e.cur_row=e.next_row,e.next_row++,(-1==e.cur_pat||e.cur_row>=e.xm.patterns[e.cur_pat].length)&&(e.cur_row=0,e.next_row=1,e.cur_songpos++,e.cur_songpos>=e.xm.songpats.length&&(e.cur_songpos=e.xm.song_looppos),function(){for(var t=e.xm.songpats[e.cur_songpos];t>=e.xm.patterns.length;)e.cur_songpos+1<e.xm.songpats.length?e.cur_songpos++:e.cur_songpos===e.xm.song_looppos&&0!==e.cur_songpos||e.xm.song_looppos>=e.xm.songpats.length?e.cur_songpos=0:e.cur_songpos=e.xm.song_looppos,t=e.xm.songpats[e.cur_songpos];e.cur_pat=t}());for(var t=e.xm.patterns[e.cur_pat][e.cur_row],r=0;r<t.length;r++){var i=e.xm.channelinfo[r],o=i.inst,n=!1;if(-1!=t[r][1]&&(o=e.xm.instruments[t[r][1]-1])&&o.samplemap&&(i.inst=o,n=!0,i.note&&o.samplemap&&(i.samp=o.samples[o.samplemap[i.note]],i.vol=i.samp.vol,i.pan=i.samp.pan,i.fine=i.samp.fine)),-1!=t[r][0])if(96==t[r][0])i.release=1,n=!1;else if(o&&o.samplemap){var s=t[r][0];i.note=s,i.samp=o.samples[o.samplemap[i.note]],n&&(i.pan=i.samp.pan,i.vol=i.samp.vol,i.fine=i.samp.fine),n=!0}if(i.voleffectfn=void 0,-1!=t[r][2]){var a=t[r][2];i.voleffectdata=15&a,a<16?console.log("channel",r,"invalid volume",a.toString(16)):a<=80?i.vol=a-16:a>=96&&a<112?i.voleffectfn=function(t){t.vol=Math.max(0,t.vol-t.voleffectdata)}:a>=112&&a<128?i.voleffectfn=function(t){t.vol=Math.min(64,t.vol+t.voleffectdata)}:a>=128&&a<144?i.vol=Math.max(0,i.vol-(15&a)):a>=144&&a<160?i.vol=Math.min(64,i.vol+(15&a)):a>=160&&a<176?i.vibratospeed=15&a:a>=176&&a<192?(i.vibratodepth=15&a,i.voleffectfn=e.effects_t1[4],e.effects_t1[4](i)):a>=192&&a<208?i.pan=17*(15&a):a>=240&&a<=255?(15&a&&(i.portaspeed=(15&a)<<4),i.voleffectfn=e.effects_t1[3]):console.log("channel",r,"volume effect",a.toString(16))}if(i.effect=t[r][3],i.effectdata=t[r][4],i.effect<36){i.effectfn=e.effects_t1[i.effect];var l=e.effects_t0[i.effect];l&&l(i,i.effectdata)&&(n=!1)}else console.log("channel",r,"effect > 36",i.effect);(3==i.effect||5==i.effect||t[r][2]>=240)&&(-1!=t[r][0]&&(i.periodtarget=f(i,i.note)),n=!1,o&&o.samplemap&&(null==i.env_vol?n=!0:i.release&&(i.envtick=0,i.release=0,i.env_vol=new m(o.env_vol),i.env_pan=new m(o.env_pan)))),n&&(9!=i.effect&&(i.off=0),i.release=0,i.envtick=0,i.env_vol=new m(o.env_vol),i.env_pan=new m(o.env_pan),i.note&&(i.period=f(i,i.note)),i.vibratotype<4&&(i.vibratopos=0))}}function p(t,e,r,i,o){this.points=t,this.type=e,this.sustain=r,this.loopstart=t[2*i],this.loopend=t[2*o]}function m(t){this.env=t,this.tick=0}function x(){var t,r;for(e.cur_tick++,t=0;t<e.xm.nchan;t++)(r=e.xm.channelinfo[t]).periodoffset=0;for(e.cur_tick>=e.xm.tempo&&(e.cur_tick=0,d()),t=0;t<e.xm.nchan;t++){var i=(r=e.xm.channelinfo[t]).inst;0!==e.cur_tick&&(r.voleffectfn&&r.voleffectfn(r),r.effectfn&&r.effectfn(r)),isNaN(r.period)&&console.log(c(e.xm.patterns[e.cur_pat][e.cur_row][t]),"set channel",t,"period to NaN"),void 0!==i&&(void 0!==r.env_vol?(r.volE=r.env_vol.Tick(r.release),r.panE=r.env_pan.Tick(r.release),u(r,r.period+r.periodoffset)):console.log(c(e.xm.patterns[e.cur_pat][e.cur_row][t]),"set channel",t,"env_vol to undefined, but note is playing"))}}function M(t,e,r,i,o){var n=t.filterstate[1];if(isNaN(n))console.log("NaN filterstate?",t.filterstate,t.filter);else{for(var s=e;s<r;s++){if(Math.abs(n)<1526e-8){n=0;break}i[s]+=n*t.vL,o[s]+=n*t.vR,n*=.9837}if(t.filterstate[1]=n,t.filterstate[2]=n,!isNaN(n))return 0;console.log("NaN filterstate after adding silence?",t.filterstate,t.filter,s)}}function w(t,r,i,o,n){var s=t.inst,a=t.samp,l=!1,c=0,h=0;if(null==a||null==s||t.mute)return M(t,r,i,o,n);var u=a.sampledata,f=a.len;1==(3&a.type)&&a.looplen>0&&(l=!0,f=(h=a.loop)+(c=a.looplen));a.len;var d=t.volE/64,p=4*(t.panE-32),m=p+t.pan-128,x=e.xm.global_volume*d*(128-m)*t.vol/1048576,w=e.xm.global_volume*d*(128+m)*t.vol/1048576;if(x<0&&(x=0),w<0&&(w=0),0!==w||0!==x){if(!isNaN(w)&&!isNaN(x)){var b=t.off,g=t.doff,y=0,T=t.filter[0],v=t.filter[1],P=t.filter[2],S=t.filterstate[0],C=t.filterstate[1],_=t.filterstate[2],R=.9837*t.vL+(1-.9837)*(x+t.vLprev)*.5,F=.9837*t.vR+(1-.9837)*(w+t.vRprev)*.5,I=Math.pow(.9837,8);t.vLprev=x,t.vRprev=w;for(var V=r,A=100;V<i;){if(0==A--){console.log("failsafe in mixing loop! channel",t.number,b,f,h,c,g);break}if(b>=f){if(!l)return t.inst=void 0,y+M(t,V,i,o,n);b=h+(b-h)%c}for(var j,z,D=Math.max(1,Math.min(i,V+(f-b)/g));V+7<D;V+=8)z=T*((j=u[0|b])+S)+v*C+P*_,_=C,C=z,S=j,b+=g,o[V]+=R*z,n[V]+=F*z,y+=(R+F)*z*z,z=T*((j=u[0|b])+S)+v*C+P*_,_=C,C=z,S=j,b+=g,o[V+1]+=R*z,n[V+1]+=F*z,y+=(R+F)*z*z,z=T*((j=u[0|b])+S)+v*C+P*_,_=C,C=z,S=j,b+=g,o[V+2]+=R*z,n[V+2]+=F*z,y+=(R+F)*z*z,z=T*((j=u[0|b])+S)+v*C+P*_,_=C,C=z,S=j,b+=g,o[V+3]+=R*z,n[V+3]+=F*z,y+=(R+F)*z*z,z=T*((j=u[0|b])+S)+v*C+P*_,_=C,C=z,S=j,b+=g,o[V+4]+=R*z,n[V+4]+=F*z,y+=(R+F)*z*z,z=T*((j=u[0|b])+S)+v*C+P*_,_=C,C=z,S=j,b+=g,o[V+5]+=R*z,n[V+5]+=F*z,y+=(R+F)*z*z,z=T*((j=u[0|b])+S)+v*C+P*_,_=C,C=z,S=j,b+=g,o[V+6]+=R*z,n[V+6]+=F*z,y+=(R+F)*z*z,z=T*((j=u[0|b])+S)+v*C+P*_,_=C,C=z,S=j,b+=g,o[V+7]+=R*z,n[V+7]+=F*z,y+=(R+F)*z*z,R=I*R+(1-I)*x,F=I*F+(1-I)*w;for(;V<D;V++)z=T*((j=u[0|b])+S)+v*C+P*_,_=C,C=z,S=j,o[V]+=R*z,n[V]+=F*z,y+=(R+F)*z*z,b+=g}return t.off=b,t.filterstate[0]=S,t.filterstate[1]=C,t.filterstate[2]=_,t.vL=R,t.vR=F,.5*y}console.log("NaN volume!?",t.number,x,w,d,p,t.vol)}}function b(t){s=e.audioctx.sampleRate;var i,o,n,a=t.outputBuffer.length,l=t.outputBuffer.getChannelData(0),c=t.outputBuffer.getChannelData(1);for(i=0;i<a;i++)l[i]=0,c[i]=0;for(var h=0,u=0|2.5*s/e.xm.bpm,f=r.scope_width;a>0;){(-1==e.cur_pat||e.cur_ticksamp>=u)&&(x(),e.cur_ticksamp-=u);var d=Math.min(a,u-e.cur_ticksamp),p=new Float32Array(e.xm.nchan),m=void 0;for(o=0;o<e.xm.nchan;o++){var M;if(d>=4*f)for(M=new Float32Array(f),n=0;n<f;n++)M[n]=-l[h+4*n]-c[h+4*n];if(p[o]=w(e.xm.channelinfo[o],h,h+d,l,c)/d,d>=4*f){for(n=0;n<f;n++)M[n]+=l[h+4*n]+c[h+4*n];void 0===m&&(m=[]),m.push(M)}}r.pushEvent&&r.pushEvent({t:t.playbackTime+(0+h)/s,vu:p,scopes:m,songpos:e.cur_songpos,pat:e.cur_pat,row:e.cur_row}),h+=d,e.cur_ticksamp+=d,a-=d}}function g(t,e){var r,i,o,n=t.length,s=0;if(0===e){for(r=new Float32Array(n),o=0;o<n;o++)128&(i=255&(s+=t[o]))&&(i-=256),r[o]=i/128;return r}for(n/=2,r=new Float32Array(n),o=0;o<n;o++)32768&(i=t[2*o]+(t[2*o+1]<<8))&&(i-=65536),s=Math.max(-1,Math.min(1,s+i/32768)),r[o]=s;return r}function y(t){var e=(2048+t.looplen-1)/t.looplen|0,r=2&t.type;r&&(e=e+1&-2);for(var i=t.loop+e*t.looplen,o=new Float32Array(i),n=0;n<t.loop;n++)o[n]=t.sampledata[n];for(var s=0;s<e;s++){var a;if(1&s&&r)for(a=t.looplen-1;a>=0;a--)o[n++]=t.sampledata[t.loop+a];else for(a=0;a<t.looplen;a++)o[n++]=t.sampledata[t.loop+a]}console.log("unrolled sample loop; looplen",t.looplen,"x",e," = ",i),t.sampledata=o,t.looplen=e*t.looplen,t.type=1}function T(){if(!e.audioctx){var r=t.AudioContext||t.webkitAudioContext;e.audioctx=new r,(o=e.audioctx.createGain()).gain.value=.1}(i=void 0===e.audioctx.createScriptProcessor?e.audioctx.createJavaScriptNode(16384,0,2):e.audioctx.createScriptProcessor(16384,0,2)).onaudioprocess=b,o.connect(e.audioctx.destination)}p.prototype.Get=function(t){for(var e,r=this.points,i=0;i<r.length;i+=2)if(e=r[i+1],t<r[i]){var o=r[i-2];e=r[i-1];var n=r[i]-o;return e+(t-o)*(r[i+1]-e)/n}return e},m.prototype.Tick=function(t){var e=this.env.Get(this.tick);return!t&&this.tick>=this.env.points[2*this.env.sustain]?this.env.points[2*this.env.sustain+1]:(this.tick++,4&this.env.type&&!t&&this.tick>=this.env.loopend&&(this.tick-=this.env.loopend-this.env.loopstart),e)},e.playing=!1}(window)},function(t,e){!function(t){t.XMPlayer||(t.XMPlayer={});var e=t.XMPlayer;function r(t){if(0!==t.effectdata&&void 0!==t.inst){var r=[0,t.effectdata>>4,15&t.effectdata],i=t.note+r[e.cur_tick%3];t.period=e.periodForNote(t,i)}}function i(t){void 0!==t.periodtarget&&void 0!==t.portaspeed&&(t.period>t.periodtarget?t.period=Math.max(t.periodtarget,t.period-t.portaspeed):t.period=Math.min(t.periodtarget,t.period+t.portaspeed))}function o(t){t.periodoffset=function(t,e){var r=0;switch(3&t){case 1:r=(1+2*e/64)%2-1;break;case 2:case 3:r=e<32?1:-1;break;case 0:default:r=Math.sin(e*Math.PI/32)}return r}(t.vibratotype,t.vibratopos)*t.vibratodepth,isNaN(t.periodoffset)&&(console.log("vibrato periodoffset NaN?",t.vibratopos,t.vibratospeed,t.vibratodepth),t.periodoffset=0),e.cur_tick>0&&(t.vibratopos+=t.vibratospeed,t.vibratopos&=63)}function n(t,e){e&&(t.volumeslide=(e>>4)-(15&e))}function s(t){void 0!==t.volumeslide&&(t.vol=Math.max(0,Math.min(64,t.vol+t.volumeslide)))}function a(){}function l(t,r){console.log("unimplemented effect",e.prettify_effect(t.effect,r))}e.effects_t0=[r,function(t,e){0!==e&&(t.slideupspeed=e)},function(t,e){0!==e&&(t.slidedownspeed=e)},function(t,e){0!==e&&(t.portaspeed=e)},function(t,e){15&e&&(t.vibratodepth=2*(15&e)),e>>4&&(t.vibratospeed=e>>4),o(t)},n,n,l,function(t,e){t.pan=e},function(t,e){t.off=256*e},n,function(t,r){r<e.xm.songpats.length&&(e.cur_songpos=r-1,e.cur_pat=-1,e.cur_row=-1)},function(t,e){t.vol=Math.min(64,e)},function(t,r){e.cur_songpos++,e.cur_songpos>=e.xm.songpats.length&&(e.cur_songpos=e.xm.song_looppos),e.cur_pat=e.xm.songpats[e.cur_songpos],e.next_row=10*(r>>4)+(15&r)},function(t,r){var i=r>>4;switch(r&=15,i){case 1:t.period-=r;break;case 2:t.period+=r;break;case 4:t.vibratotype=7&r;break;case 5:t.fine=(r<<4)+r-128;break;case 6:0==r?t.loopstart=e.cur_row:(void 0===t.loopend&&(t.loopend=e.cur_row,t.loopremaining=r),0!==t.loopremaining?(t.loopremaining--,e.next_row=t.loopstart||0):(delete t.loopend,delete t.loopstart));break;case 8:t.pan=17*r;break;case 10:0===r&&void 0!==t.finevolup&&(r=t.finevolup),t.vol=Math.min(64,t.vol+r),t.finevolup=r;break;case 11:0===r&&void 0!==t.finevoldown&&(r=t.finevoldown),t.vol=Math.max(0,t.vol-r),t.finevoldown=r;break;case 12:break;default:console.log("unimplemented extended effect E",t.effectdata.toString(16))}},function(t,r){0!==r?r<32?e.xm.tempo=r:e.xm.bpm=r:console.log("tempo 0?")},function(t,r){e.xm.global_volume=r<=64?Math.max(0,2*r):e.max_global_volume},function(t,r){r&&(e.xm.global_volumeslide=2*((r>>4)-(15&r)))},l,l,l,l,l,l,l,l,l,function(t,e){switch(15&e&&(t.retrig=(240&t.retrig)+(15&e)),240&e&&(t.retrig=(15&t.retrig)+(240&e)),t.retrig>>4){case 1:t.vol-=1;break;case 2:t.vol-=2;break;case 3:t.vol-=4;break;case 4:t.vol-=8;break;case 5:t.vol-=16;break;case 6:t.vol*=2,t.vol/=3;break;case 7:t.vol/=2;break;case 9:t.vol+=1;break;case 10:t.vol+=2;break;case 11:t.vol+=4;break;case 12:t.vol+=8;break;case 13:t.vol+=16;break;case 14:t.vol*=3,t.vol/=2;break;case 15:t.vol*=2}t.vol=Math.min(64,Math.max(0,t.vol))},l,l,l,l,l,l,l,l],e.effects_t1=[r,function(t){void 0!==t.slideupspeed&&(t.period-=t.slideupspeed)},function(t){void 0!==t.slidedownspeed&&(t.period=Math.min(1728,t.period+t.slidedownspeed))},i,o,function(t){s(t),i(t)},function(t){s(t),o(t)},a,null,null,s,null,null,null,function(t){switch(t.effectdata>>4){case 12:e.cur_tick==(15&t.effectdata)&&(t.vol=0)}},null,null,function(t){void 0!==e.xm.global_volumeslide&&(e.xm.global_volume=Math.max(0,Math.min(e.max_global_volume,e.xm.global_volume+e.xm.global_volumeslide)))},a,a,a,a,a,a,a,a,a,function(t){e.cur_tick%(15&t.retrig)==0&&(t.off=0)},a,a,a,a,a,a,a,a]}(window)},function(t,e){!function(t){t.JSRocket||(t.JSRocket={}),JSRocket.SyncData=function(){"use strict";var t=[];return{getTrack:function(e){return t[e]},getIndexForName:function(e){for(var r=0;r<t.length;r++)if(t[r].name===e)return r;return-1},getTrackLength:function(){return t.length},createIndex:function(e){var r=new JSRocket.Track;r.name=e,t.push(r)}}},JSRocket.Track=function(){"use strict";var t=[];return{getValue:function(e){var r=Object.keys(t);if(!r.length)return 0;var i=function(t,e){for(var r=0,i=t.length;r<i;){var o=(i+r)/2|0;if(t[o]<e)r=o+1;else{if(!(t[o]>e))return o;i=o}}return r-1}(r,Math.floor(e));if(i<0)return t[r[0]].value;if(i>r.length-2)return t[r[r.length-1]].value;var o=r[i],n=r[i+1],s=t[o].value,a=t[n].value,l=(e-o)/(n-o);switch(t[o].interpolation){case 0:return s;case 1:return s+(a-s)*l;case 2:return s+(a-s)*l*l*(3-2*l);case 3:return s+(a-s)*Math.pow(l,2)}},add:function(e,r,i){t[e]={value:r,interpolation:i}},remove:function(e){delete t[e]}}},JSRocket.SyncDevicePlayer=function(t){"use strict";var e,r=new JSRocket.SyncData,i={ready:function(){},error:function(){}};function o(t){null!==(e=new XMLHttpRequest)?(e.open("GET",t,!0),e.onreadystatechange=n,e.send()):i.error()}function n(){4===e.readyState&&(e.status<300?function(t){var e,r,o,n=0,a=0,l=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("tracks")[0].getElementsByTagName("track");for(r=l.length;n<r;n++){var c=s(l[n].getAttribute("name")),h=l[n].getElementsByTagName("key");for(a=0,o=h.length;a<o;a++)e=h[a],c.add(parseInt(e.getAttribute("row"),10),parseFloat(e.getAttribute("value")),parseInt(e.getAttribute("interpolation"),10))}i.ready()}(e.responseText):i.error())}function s(t){var e=r.getIndexForName(t);return e>-1?r.getTrack(e):(r.createIndex(t),r.getTrack(r.getTrackLength()-1))}if(""===t.rocketXML||void 0===t.rocketXML||void 0===t.rocketXML)throw"[jsRocket] rocketXML is not set, try _syncDevice.setConfig({'rocketXML':'url/To/RocketXML.rocket'})";return o(t.rocketXML),{load:o,getTrack:s,update:function(){},on:function(t,e){i[t]=e}}},JSRocket.SyncDeviceClient=function(t){"use strict";var e=new WebSocket(t.socketURL),r=new JSRocket.SyncData,i={ready:function(){},update:function(){},play:function(){},pause:function(){},save:function(){}};function o(t){for(var e=0,r=new DataView(new ArrayBuffer(t.length));e<t.length;e++)r.setUint8(e,t[e]);return 1===r.byteLength?r.getInt8(0):r.getInt32(0)}return e.onopen=function(){e.binaryType="arraybuffer",e.send("hello, synctracker!")},e.onmessage=function(t){var e,n,s,a,l,c,h=new Uint8Array(t.data),u=h[0];104===u?i.ready():4===u?1===h[1]?i.pause():i.play():3===u?(n=o(h.subarray(1,5)),i.update(n)):0===u?(e=o(h.subarray(1,5)),n=o(h.subarray(5,9)),l=h.subarray(9,13),(c=new DataView(new ArrayBuffer(4))).setUint8(0,l[0]),c.setUint8(1,l[1]),c.setUint8(2,l[2]),c.setUint8(3,l[3]),s=c.getFloat32(0),a=o(h.subarray(13,14)),r.getTrack(e).add(n,s,a)):1===u?(e=o(h.subarray(1,5)),n=o(h.subarray(5,9)),r.getTrack(e).remove(n)):5===u&&i.save()},e.onclose=function(t){console.warn(">> connection closed",t)},e.onerror=function(t){console.error(">> connection error'd",t)},{getTrack:function(t){var i=r.getIndexForName(t);if(i>-1)return r.getTrack(i);for(var o=encodeURIComponent(t).replace(/%([\dA-F]{2})/g,(function(t,e){return String.fromCharCode("0x"+e)})),n=[2,o.length>>24&255,o.length>>16&255,o.length>>8&255,255&o.length],s=0;s<o.length;s++)n.push(o.charCodeAt(s));return e.send(new Uint8Array(n).buffer),r.createIndex(t),r.getTrack(r.getTrackLength()-1)},update:function(t){var r=[t>>24&255,t>>16&255,t>>8&255,255&t];e.send(new Uint8Array([3,r[0],r[1],r[2],r[3]]).buffer)},on:function(t,e){i[t]=e}}},JSRocket.SyncDevice=function(){"use strict";var t,e,r=!1,i={socketURL:"ws://localhost:1339",rocketXML:""},o={ready:function(){},update:function(){},play:function(){},pause:function(){}};function n(){r=!0,o.ready()}function s(t){o.update(t)}function a(){o.play()}function l(){o.pause()}return{init:function(e){(t="demo"===e?new JSRocket.SyncDevicePlayer(i):new JSRocket.SyncDeviceClient(i)).on("ready",n),t.on("update",s),t.on("play",a),t.on("pause",l)},setConfig:function(t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return i},getConfig:function(){return i},getTrack:function(e){return r?t.getTrack(e):null},update:function(r){Math.floor(r)!==e&&(e=Math.floor(r),t.update(e))},on:function(t,e){o[t]=e}}}}(window)},function(t,e,r){var i;t.exports=((i=function(){function t(t){return o.appendChild(t.dom),t}function e(t){for(var e=0;e<o.children.length;e++)o.children[e].style.display=e===t?"block":"none";r=t}var r=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",(function(t){t.preventDefault(),e(++r%o.children.length)}),!1);var n=(performance||Date).now(),s=n,a=0,l=t(new i.Panel("FPS","#0ff","#002")),c=t(new i.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var h=t(new i.Panel("MB","#f08","#201"));return e(0),{REVISION:16,dom:o,addPanel:t,showPanel:e,begin:function(){n=(performance||Date).now()},end:function(){a++;var t=(performance||Date).now();if(c.update(t-n,200),t>s+1e3&&(l.update(1e3*a/(t-s),100),s=t,a=0,h)){var e=performance.memory;h.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){n=this.end()},domElement:o,setMode:e}}).Panel=function(t,e,r){var i=1/0,o=0,n=Math.round,s=n(window.devicePixelRatio||1),a=80*s,l=48*s,c=3*s,h=2*s,u=3*s,f=15*s,d=74*s,p=30*s,m=document.createElement("canvas");m.width=a,m.height=l,m.style.cssText="width:80px;height:48px";var x=m.getContext("2d");return x.font="bold "+9*s+"px Helvetica,Arial,sans-serif",x.textBaseline="top",x.fillStyle=r,x.fillRect(0,0,a,l),x.fillStyle=e,x.fillText(t,c,h),x.fillRect(u,f,d,p),x.fillStyle=r,x.globalAlpha=.9,x.fillRect(u,f,d,p),{dom:m,update:function(l,M){i=Math.min(i,l),o=Math.max(o,l),x.fillStyle=r,x.globalAlpha=1,x.fillRect(0,0,a,f),x.fillStyle=e,x.fillText(n(l)+" "+t+" ("+n(i)+"-"+n(o)+")",c,h),x.drawImage(m,u+s,f,d-s,p,u,f,d-s,p),x.fillRect(u+d-s,f,s,p),x.fillStyle=r,x.globalAlpha=.9,x.fillRect(u+d-s,f,s,n((1-l/M)*p))}}},i)},function(t,e,r){"use strict";r.r(e),e.default=r.p+"772facb88c077a564e1c3093e23840dc.ogg"},function(t,e,r){"use strict";r.r(e),e.default=r.p+"932ebf346f7495729e1caeadfb39660e.rocket"}]);